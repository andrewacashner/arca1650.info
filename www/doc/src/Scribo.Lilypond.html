<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Scribo.Lilypond
Description : Write output of the ark to Lilypond music-notation language
Copyright   : (c) Andrew A. Cashner 2020
Maintainer  : Andrew Cashner, &lt;andrew.cashner@rochester.edu&gt;
Stability   : Experimental

This module is our implementation of Kircher's /palimpsest phonotacticum/, his
system for writing out the music created using the ark.  Certain elements that
Kircher used notation to calculate (like determining vocal ranges by clef
combinations and the size of the staff) we actually do in the @Cogito@ module.
This module is purely focused on output of complete music information to a
music-notation language.

This module outputs to Lilypond, which could then be processed by that program
to PDF, MIDI, or other formats. 

This is a stub of what used to be a full Lilypond writing module (now archived in test/). We just use this for testing.
-}</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Scribo.Lilypond</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Aedifico.html"><span class="hs-identifier">Aedifico</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Aedifico.html#Pnum"><span class="hs-identifier hs-type">Pnum</span></a><span>       </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Accid"><span class="hs-identifier hs-type">Accid</span></a><span>      </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span>        </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span>      </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Cogito.Musarithmetic.html"><span class="hs-identifier">Cogito.Musarithmetic</span></a><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Cogito.Musarithmetic.html#isRest"><span class="hs-identifier hs-var">isRest</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- * Write individual data types to Lilypond strings</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">-- | Write pitch as Lilypond music note.</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- Look up needed string values for letter name, accidental, octave tick marks,</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- and duration in lists based on data in given 'Pitch'.</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- If it is a 'Aedifico.Pnum.Rest', just print the rest rhythm string.</span><span>
</span><a name="line-40"></a><span class="hs-comment">--</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- Most of these just require using an enum value as index to a list of</span><span>
</span><a name="line-42"></a><span class="hs-comment">-- strings or characters. The octave requires us to calculate the number of</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- commas or apostrophes to add (relative to Helmholtz octave 3 = @c@).</span><span>
</span><a name="line-44"></a><span class="hs-identifier">pitch2ly</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-45"></a><a name="pitch2ly"><a href="Scribo.Lilypond.html#pitch2ly"><span class="hs-identifier">pitch2ly</span></a></a><span> </span><a name="local-6989586621679124314"><a href="#local-6989586621679124314"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="Cogito.Musarithmetic.html#isRest"><span class="hs-identifier hs-var">isRest</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">dur</span><span> </span><a href="#local-6989586621679124314"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-47"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679124315"><span class="hs-identifier hs-var">duration</span></a><span>
</span><a name="line-48"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">accid</span><span> </span><a href="#local-6989586621679124314"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Aedifico.html#Na"><span class="hs-identifier hs-var">Na</span></a><span>
</span><a name="line-49"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;\\ficta &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679124316"><span class="hs-identifier hs-var">pitchLetter</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679124317"><span class="hs-identifier hs-var">accidental</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679124318"><span class="hs-identifier hs-var">octaveTicks</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679124315"><span class="hs-identifier hs-var">duration</span></a><span>
</span><a name="line-50"></a><span>            </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679124316"><span class="hs-identifier hs-var">pitchLetter</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679124318"><span class="hs-identifier hs-var">octaveTicks</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679124315"><span class="hs-identifier hs-var">duration</span></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-52"></a><span>        </span><a name="local-6989586621679124315"><a href="#local-6989586621679124315"><span class="hs-identifier">duration</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dur</span><span> </span><a href="#local-6989586621679124314"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-53"></a><span>            </span><a href="Aedifico.html#Br"><span class="hs-identifier hs-var">Br</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;\\breve&quot;</span><span>
</span><a name="line-54"></a><span>            </span><a href="Aedifico.html#Sb"><span class="hs-identifier hs-var">Sb</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-55"></a><span>            </span><a href="Aedifico.html#Mn"><span class="hs-identifier hs-var">Mn</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-56"></a><span>            </span><a href="Aedifico.html#Sm"><span class="hs-identifier hs-var">Sm</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;4&quot;</span><span>
</span><a name="line-57"></a><span>            </span><a href="Aedifico.html#Fs"><span class="hs-identifier hs-var">Fs</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;8&quot;</span><span>
</span><a name="line-58"></a><span>            </span><a href="Aedifico.html#BrD"><span class="hs-identifier hs-var">BrD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;\\breve.&quot;</span><span>
</span><a name="line-59"></a><span>            </span><a href="Aedifico.html#SbD"><span class="hs-identifier hs-var">SbD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;1.&quot;</span><span>
</span><a name="line-60"></a><span>            </span><a href="Aedifico.html#MnD"><span class="hs-identifier hs-var">MnD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;2.&quot;</span><span>
</span><a name="line-61"></a><span>            </span><a href="Aedifico.html#SmD"><span class="hs-identifier hs-var">SmD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;4.&quot;</span><span>
</span><a name="line-62"></a><span>            </span><a href="Aedifico.html#FsD"><span class="hs-identifier hs-var">FsD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;8.&quot;</span><span>
</span><a name="line-63"></a><span>            </span><a href="Aedifico.html#LgR"><span class="hs-identifier hs-var">LgR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;r\\longa&quot;</span><span>
</span><a name="line-64"></a><span>            </span><a href="Aedifico.html#BrR"><span class="hs-identifier hs-var">BrR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;r\\breve&quot;</span><span>
</span><a name="line-65"></a><span>            </span><a href="Aedifico.html#SbR"><span class="hs-identifier hs-var">SbR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;r1&quot;</span><span>
</span><a name="line-66"></a><span>            </span><a href="Aedifico.html#MnR"><span class="hs-identifier hs-var">MnR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;r2&quot;</span><span>
</span><a name="line-67"></a><span>            </span><a href="Aedifico.html#SmR"><span class="hs-identifier hs-var">SmR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;r4&quot;</span><span>
</span><a name="line-68"></a><span>            </span><a href="Aedifico.html#FsR"><span class="hs-identifier hs-var">FsR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;r8&quot;</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span>        </span><a name="local-6989586621679124316"><a href="#local-6989586621679124316"><span class="hs-identifier">pitchLetter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pnum</span><span> </span><a href="#local-6989586621679124314"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-71"></a><span>            </span><a href="Aedifico.html#PCc"><span class="hs-identifier hs-var">PCc</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;c&quot;</span><span>
</span><a name="line-72"></a><span>            </span><a href="Aedifico.html#PCd"><span class="hs-identifier hs-var">PCd</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;d&quot;</span><span>
</span><a name="line-73"></a><span>            </span><a href="Aedifico.html#PCe"><span class="hs-identifier hs-var">PCe</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;e&quot;</span><span>
</span><a name="line-74"></a><span>            </span><a href="Aedifico.html#PCf"><span class="hs-identifier hs-var">PCf</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;f&quot;</span><span>
</span><a name="line-75"></a><span>            </span><a href="Aedifico.html#PCg"><span class="hs-identifier hs-var">PCg</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;g&quot;</span><span>
</span><a name="line-76"></a><span>            </span><a href="Aedifico.html#PCa"><span class="hs-identifier hs-var">PCa</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;a&quot;</span><span>
</span><a name="line-77"></a><span>            </span><a href="Aedifico.html#PCb"><span class="hs-identifier hs-var">PCb</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;b&quot;</span><span>
</span><a name="line-78"></a><span>            </span><a href="Aedifico.html#PCc8"><span class="hs-identifier hs-var">PCc8</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;c&quot;</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>        </span><a name="local-6989586621679124317"><a href="#local-6989586621679124317"><span class="hs-identifier">accidental</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">accid</span><span> </span><a href="#local-6989586621679124314"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-81"></a><span>            </span><a href="Aedifico.html#Fl"><span class="hs-identifier hs-var">Fl</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;es&quot;</span><span>
</span><a name="line-82"></a><span>            </span><a href="Aedifico.html#Na"><span class="hs-identifier hs-var">Na</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-83"></a><span>            </span><a href="Aedifico.html#Sh"><span class="hs-identifier hs-var">Sh</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;is&quot;</span><span>
</span><a name="line-84"></a><span>            </span><a href="Aedifico.html#AccidNil"><span class="hs-identifier hs-var">AccidNil</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span>        </span><a name="local-6989586621679124318"><a href="#local-6989586621679124318"><span class="hs-identifier">octaveTicks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679124319"><span class="hs-identifier hs-var">oct2str</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">oct</span><span> </span><a href="#local-6989586621679124314"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>        </span><span class="hs-identifier">oct2str</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-89"></a><span>        </span><a name="local-6989586621679124319"><a href="#local-6989586621679124319"><span class="hs-identifier">oct2str</span></a></a><span> </span><a name="local-6989586621679124320"><a href="#local-6989586621679124320"><span class="hs-identifier">oct</span></a></a><span>
</span><a name="line-90"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679124320"><span class="hs-identifier hs-var">oct</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">3</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679124323"><span class="hs-identifier hs-var">degree</span></a><span> </span><a href="#local-6989586621679124321"><span class="hs-identifier hs-var">low</span></a><span>
</span><a name="line-91"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679124320"><span class="hs-identifier hs-var">oct</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">3</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679124323"><span class="hs-identifier hs-var">degree</span></a><span> </span><a href="#local-6989586621679124322"><span class="hs-identifier hs-var">high</span></a><span>
</span><a name="line-92"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-93"></a><span>            </span><span class="hs-keyword">where</span><span>
</span><a name="line-94"></a><span>                </span><a name="local-6989586621679124321"><a href="#local-6989586621679124321"><span class="hs-identifier">low</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">','</span><span>
</span><a name="line-95"></a><span>                </span><a name="local-6989586621679124322"><a href="#local-6989586621679124322"><span class="hs-identifier">high</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\''</span><span>
</span><a name="line-96"></a><span>                </span><a name="local-6989586621679124323"><a href="#local-6989586621679124323"><span class="hs-identifier">degree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679124320"><span class="hs-identifier hs-var">oct</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a></pre></body></html>