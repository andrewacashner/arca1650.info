<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Scribo.MEI
Description : Write output of the ark in MEI-XML music encoding
Copyright   : (c) 2021
Stability   : Experimental

This module is our implementation of Kircher's /palimpsest phonotacticum/, his
system for writing out the music created using the ark.  Certain elements that
Kircher used notation to calculate (like determining vocal ranges by clef
combinations and the size of the staff) we actually do in the @Cogito@ module.
This module is purely focused on output of complete music information to a
music-notation language.

This module outputs in the XML format of the Music Encoding Initiative (MEI).

This means that the whole arca program is transforming an input XML document
with the text and parameters into and output XML document with the text
matched to music.
-}</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Scribo.MEI</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">transpose</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Aedifico.html"><span class="hs-identifier">Aedifico</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="Lectio.html"><span class="hs-identifier">Lectio</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="Cogito.html"><span class="hs-identifier">Cogito</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="Cogito.Musarithmetic.html"><span class="hs-identifier">Cogito.Musarithmetic</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-comment">-- * Write XML </span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- ** Utilities</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">-- | Put a string between two other strings</span><span>
</span><a name="line-37"></a><span class="hs-identifier">enbrace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ start</span><span>
</span><a name="line-38"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ end</span><span>
</span><a name="line-39"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ contents to go in between</span><span>
</span><a name="line-40"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-41"></a><a name="enbrace"><a href="Scribo.MEI.html#enbrace"><span class="hs-identifier">enbrace</span></a></a><span> </span><a name="local-6989586621679126966"><a href="#local-6989586621679126966"><span class="hs-identifier">start</span></a></a><span> </span><a name="local-6989586621679126967"><a href="#local-6989586621679126967"><span class="hs-identifier">end</span></a></a><span> </span><a name="local-6989586621679126968"><a href="#local-6989586621679126968"><span class="hs-identifier">contents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126966"><span class="hs-identifier hs-var">start</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679126968"><span class="hs-identifier hs-var">contents</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679126967"><span class="hs-identifier hs-var">end</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">-- | Create an XML opening tag, e.g., @&lt;p&gt;@</span><span>
</span><a name="line-44"></a><span class="hs-identifier">xmltagOpen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ text of tag</span><span>
</span><a name="line-45"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-46"></a><a name="xmltagOpen"><a href="Scribo.MEI.html#xmltagOpen"><span class="hs-identifier">xmltagOpen</span></a></a><span> </span><a name="local-6989586621679126969"><a href="#local-6989586621679126969"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#enbrace"><span class="hs-identifier hs-var">enbrace</span></a><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span> </span><a href="#local-6989586621679126969"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- | Create an XML closing tag, e.g., @&lt;/p&gt;@</span><span>
</span><a name="line-49"></a><span class="hs-identifier">xmltagClose</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ text of tag</span><span>
</span><a name="line-50"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-51"></a><a name="xmltagClose"><a href="Scribo.MEI.html#xmltagClose"><span class="hs-identifier">xmltagClose</span></a></a><span> </span><a name="local-6989586621679126970"><a href="#local-6989586621679126970"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#enbrace"><span class="hs-identifier hs-var">enbrace</span></a><span> </span><span class="hs-string">&quot;&lt;/&quot;</span><span> </span><span class="hs-string">&quot;&gt; &quot;</span><span> </span><a href="#local-6989586621679126970"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- | Put something between opening and closing XML tags, specifying text of</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- opening tag, contents, and closing tag:</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- &gt; xmlWrap &quot;p&quot; &quot;text&quot; &quot;p&quot; =&gt; &lt;p&gt;text&lt;/p&gt;</span><span>
</span><a name="line-56"></a><span class="hs-identifier">xmlWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ opening tag text</span><span>
</span><a name="line-57"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ list of contents</span><span>
</span><a name="line-58"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ closing tag text</span><span>
</span><a name="line-59"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-60"></a><a name="xmlWrap"><a href="Scribo.MEI.html#xmlWrap"><span class="hs-identifier">xmlWrap</span></a></a><span> </span><a name="local-6989586621679126971"><a href="#local-6989586621679126971"><span class="hs-identifier">open</span></a></a><span> </span><a name="local-6989586621679126972"><a href="#local-6989586621679126972"><span class="hs-identifier">contents</span></a></a><span> </span><a name="local-6989586621679126973"><a href="#local-6989586621679126973"><span class="hs-identifier">close</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#xmltagOpen"><span class="hs-identifier hs-var">xmltagOpen</span></a><span> </span><a href="#local-6989586621679126971"><span class="hs-identifier hs-var">open</span></a><span>
</span><a name="line-61"></a><span>                                </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><a href="#local-6989586621679126972"><span class="hs-identifier hs-var">contents</span></a><span>
</span><a name="line-62"></a><span>                                </span><span class="hs-operator hs-var">++</span><span> </span><a href="Scribo.MEI.html#xmltagClose"><span class="hs-identifier hs-var">xmltagClose</span></a><span> </span><a href="#local-6989586621679126973"><span class="hs-identifier hs-var">close</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- | Put something between XML tags, with the same text for opening and</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- closing: </span><span>
</span><a name="line-66"></a><span class="hs-comment">-- &gt; xmlWrapBasic &quot;p&quot; &quot;text&quot; =&gt; &lt;p&gt;text&lt;/p&gt;</span><span>
</span><a name="line-67"></a><span class="hs-identifier">xmlWrapBasic</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>  </span><span class="hs-comment">-- ^ open and closing tag text</span><span>
</span><a name="line-68"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ list of contents</span><span>
</span><a name="line-69"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-70"></a><a name="xmlWrapBasic"><a href="Scribo.MEI.html#xmlWrapBasic"><span class="hs-identifier">xmlWrapBasic</span></a></a><span> </span><a name="local-6989586621679126974"><a href="#local-6989586621679126974"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679126975"><a href="#local-6989586621679126975"><span class="hs-identifier">contents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#xmlWrap"><span class="hs-identifier hs-var">xmlWrap</span></a><span> </span><a href="#local-6989586621679126974"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679126975"><span class="hs-identifier hs-var">contents</span></a><span> </span><a href="#local-6989586621679126974"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- ** Create elements and attributes, and elements with attributes</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | Create an XML element (which may contain other elements).</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- If you need attributes, use 'elementAttr'.</span><span>
</span><a name="line-76"></a><span class="hs-identifier">element</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ name</span><span>
</span><a name="line-77"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ values (list of contents, including other elements)</span><span>
</span><a name="line-78"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-79"></a><a name="element"><a href="Scribo.MEI.html#element"><span class="hs-identifier">element</span></a></a><span> </span><a name="local-6989586621679126976"><a href="#local-6989586621679126976"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679126977"><a href="#local-6989586621679126977"><span class="hs-identifier">values</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#xmlWrapBasic"><span class="hs-identifier hs-var">xmlWrapBasic</span></a><span> </span><a href="#local-6989586621679126976"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679126977"><span class="hs-identifier hs-var">values</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | Create an XML attribute</span><span>
</span><a name="line-82"></a><span class="hs-identifier">attr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>  </span><span class="hs-comment">-- ^ name</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ single value</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-85"></a><a name="attr"><a href="Scribo.MEI.html#attr"><span class="hs-identifier">attr</span></a></a><span> </span><a name="local-6989586621679126978"><a href="#local-6989586621679126978"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679126979"><a href="#local-6989586621679126979"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126978"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Scribo.MEI.html#enbrace"><span class="hs-identifier hs-var">enbrace</span></a><span> </span><span class="hs-string">&quot;=\&quot;&quot;</span><span> </span><span class="hs-string">&quot;\&quot;&quot;</span><span> </span><a href="#local-6989586621679126979"><span class="hs-identifier hs-var">value</span></a><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-comment">-- | Create an XML element that has attributes, e.g., @&lt;p class=&quot;foo&quot;&gt;bar&lt;/p&gt;@</span><span>
</span><a name="line-88"></a><span class="hs-identifier">elementAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ name</span><span>
</span><a name="line-89"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ list of attributes created with 'attr'</span><span>
</span><a name="line-90"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ values (list of contents, including other elements)</span><span>
</span><a name="line-91"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-92"></a><a name="elementAttr"><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier">elementAttr</span></a></a><span> </span><a name="local-6989586621679126980"><a href="#local-6989586621679126980"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679126981"><a href="#local-6989586621679126981"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679126982"><a href="#local-6989586621679126982"><span class="hs-identifier">values</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#xmlWrap"><span class="hs-identifier hs-var">xmlWrap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126980"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><a href="#local-6989586621679126981"><span class="hs-identifier hs-var">attrs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126982"><span class="hs-identifier hs-var">values</span></a><span> </span><a href="#local-6989586621679126980"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- * Serialize our data structures to MEI</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-comment">-- ** @Note@ becomes @note@ (pitch with syllable, or rest)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- | Create an MEI @note@ element from our @Note@ datatype, converting the</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- attributes as needed. If the @Note@ actually contains a rest ('Pitch' with</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- only a 'Dur' in the rest range), then produce a @rest@ element.</span><span>
</span><a name="line-102"></a><span class="hs-identifier">note2mei</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cogito.Musarithmetic.html#Note"><span class="hs-identifier hs-type">Note</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-103"></a><a name="note2mei"><a href="Scribo.MEI.html#note2mei"><span class="hs-identifier">note2mei</span></a></a><span> </span><a name="local-6989586621679126983"><a href="#local-6989586621679126983"><span class="hs-identifier">note</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Cogito.Musarithmetic.html#isPitchRest"><span class="hs-identifier hs-var">isPitchRest</span></a><span> </span><a href="#local-6989586621679126984"><span class="hs-identifier hs-var">pitch</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126986"><span class="hs-identifier hs-var">meiRest</span></a><span>
</span><a name="line-104"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126987"><span class="hs-identifier hs-var">meiNote</span></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>        </span><a name="local-6989586621679126984"><a href="#local-6989586621679126984"><span class="hs-identifier">pitch</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">notePitch</span><span> </span><a href="#local-6989586621679126983"><span class="hs-identifier hs-var">note</span></a><span>
</span><a name="line-107"></a><span>        </span><a name="local-6989586621679126985"><a href="#local-6989586621679126985"><span class="hs-identifier">syllable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">noteSyllable</span><span> </span><a href="#local-6989586621679126983"><span class="hs-identifier hs-var">note</span></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>        </span><a name="local-6989586621679126986"><a href="#local-6989586621679126986"><span class="hs-identifier">meiRest</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;rest&quot;</span><span> </span><span class="hs-special">[</span><a href="Scribo.MEI.html#meiDur"><span class="hs-identifier hs-var">meiDur</span></a><span> </span><a href="#local-6989586621679126984"><span class="hs-identifier hs-var">pitch</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span>        </span><a name="local-6989586621679126987"><a href="#local-6989586621679126987"><span class="hs-identifier">meiNote</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;note&quot;</span><span>
</span><a name="line-112"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679126988"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679126984"><span class="hs-identifier hs-var">pitch</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126988"><a href="#local-6989586621679126988"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="Scribo.MEI.html#meiPname"><span class="hs-identifier hs-var">meiPname</span></a><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#meiOct"><span class="hs-identifier hs-var">meiOct</span></a><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#meiDur"><span class="hs-identifier hs-var">meiDur</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-113"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#meiAccid"><span class="hs-identifier hs-var">meiAccid</span></a><span> </span><a href="#local-6989586621679126984"><span class="hs-identifier hs-var">pitch</span></a><span>
</span><a name="line-114"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;verse&quot;</span><span> </span><span class="hs-special">[</span><a href="Scribo.MEI.html#meiSyllable"><span class="hs-identifier hs-var">meiSyllable</span></a><span> </span><a href="#local-6989586621679126985"><span class="hs-identifier hs-var">syllable</span></a><span class="hs-special">]</span><span>
</span><a name="line-115"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- *** Conversions for @Note@ members</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- | Convert 'Pnum' to MEI @pname@</span><span>
</span><a name="line-120"></a><span class="hs-identifier">meiPname</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-121"></a><a name="meiPname"><a href="Scribo.MEI.html#meiPname"><span class="hs-identifier">meiPname</span></a></a><span> </span><a name="local-6989586621679126989"><a href="#local-6989586621679126989"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;pname&quot;</span><span> </span><a href="#local-6989586621679126990"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-122"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126990"><a href="#local-6989586621679126990"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">pnum</span><span> </span><a href="#local-6989586621679126989"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-123"></a><span>           </span><a href="Aedifico.html#PCc"><span class="hs-identifier hs-var">PCc</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;c&quot;</span><span>
</span><a name="line-124"></a><span>           </span><a href="Aedifico.html#PCd"><span class="hs-identifier hs-var">PCd</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;d&quot;</span><span>
</span><a name="line-125"></a><span>           </span><a href="Aedifico.html#PCe"><span class="hs-identifier hs-var">PCe</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;e&quot;</span><span>
</span><a name="line-126"></a><span>           </span><a href="Aedifico.html#PCf"><span class="hs-identifier hs-var">PCf</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;f&quot;</span><span>
</span><a name="line-127"></a><span>           </span><a href="Aedifico.html#PCg"><span class="hs-identifier hs-var">PCg</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;g&quot;</span><span>
</span><a name="line-128"></a><span>           </span><a href="Aedifico.html#PCa"><span class="hs-identifier hs-var">PCa</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;a&quot;</span><span>
</span><a name="line-129"></a><span>           </span><a href="Aedifico.html#PCb"><span class="hs-identifier hs-var">PCb</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;b&quot;</span><span>
</span><a name="line-130"></a><span>           </span><a href="Aedifico.html#PCc8"><span class="hs-identifier hs-var">PCc8</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;c&quot;</span><span>
</span><a name="line-131"></a><span>           </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Unknown pitch&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">pnum</span><span> </span><a href="#local-6989586621679126989"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- | Just print the octave number</span><span>
</span><a name="line-134"></a><span class="hs-identifier">meiOct</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-135"></a><a name="meiOct"><a href="Scribo.MEI.html#meiOct"><span class="hs-identifier">meiOct</span></a></a><span> </span><a name="local-6989586621679126991"><a href="#local-6989586621679126991"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;oct&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">oct</span><span> </span><a href="#local-6989586621679126991"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-comment">-- | Convert 'Dur' to MEI @dur@ (base value of duration) and @dots (if any;</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- omit if not)</span><span>
</span><a name="line-139"></a><span class="hs-identifier">meiDur</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-140"></a><a name="meiDur"><a href="Scribo.MEI.html#meiDur"><span class="hs-identifier">meiDur</span></a></a><span> </span><a name="local-6989586621679126992"><a href="#local-6989586621679126992"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126993"><span class="hs-identifier hs-var">durAttr</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126995"><span class="hs-identifier hs-var">dotsAttr</span></a><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-142"></a><span>        </span><a name="local-6989586621679126993"><a href="#local-6989586621679126993"><span class="hs-identifier">durAttr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;dur&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679126994"><span class="hs-identifier hs-var">durString</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">dur</span><span> </span><a href="#local-6989586621679126992"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>        </span><span class="hs-identifier">durString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-145"></a><span>        </span><a name="local-6989586621679126994"><a href="#local-6989586621679126994"><span class="hs-identifier">durString</span></a></a><span> </span><a name="local-6989586621679126996"><a href="#local-6989586621679126996"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126996"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Aedifico.html#DurNil"><span class="hs-identifier hs-var">DurNil</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;_&quot;</span><span>
</span><a name="line-146"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126996"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#Lg"><span class="hs-identifier hs-var">Lg</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#LgD"><span class="hs-identifier hs-var">LgD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#LgR"><span class="hs-identifier hs-var">LgR</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;long&quot;</span><span>
</span><a name="line-147"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126996"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#Br"><span class="hs-identifier hs-var">Br</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#BrD"><span class="hs-identifier hs-var">BrD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#BrR"><span class="hs-identifier hs-var">BrR</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;breve&quot;</span><span>
</span><a name="line-148"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126996"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#Sb"><span class="hs-identifier hs-var">Sb</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#SbD"><span class="hs-identifier hs-var">SbD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#SbR"><span class="hs-identifier hs-var">SbR</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-149"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126996"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#Mn"><span class="hs-identifier hs-var">Mn</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#MnD"><span class="hs-identifier hs-var">MnD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#MnR"><span class="hs-identifier hs-var">MnR</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-150"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126996"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#Sm"><span class="hs-identifier hs-var">Sm</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#SmD"><span class="hs-identifier hs-var">SmD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#SmR"><span class="hs-identifier hs-var">SmR</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;4&quot;</span><span>
</span><a name="line-151"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126996"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#Fs"><span class="hs-identifier hs-var">Fs</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#FsD"><span class="hs-identifier hs-var">FsD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#FsR"><span class="hs-identifier hs-var">FsR</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;8&quot;</span><span>
</span><a name="line-152"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Unknown duration&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679126996"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span>        </span><span class="hs-comment">-- | Get MEI @dots@ from our 'Dur' (omit attribute if duration is not dotted)</span><span>
</span><a name="line-155"></a><span>        </span><a name="local-6989586621679126995"><a href="#local-6989586621679126995"><span class="hs-identifier">dotsAttr</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">dur</span><span> </span><a href="#local-6989586621679126992"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#LgD"><span class="hs-identifier hs-var">LgD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#BrD"><span class="hs-identifier hs-var">BrD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#SbD"><span class="hs-identifier hs-var">SbD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#MnD"><span class="hs-identifier hs-var">MnD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#SmD"><span class="hs-identifier hs-var">SmD</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#FsD"><span class="hs-identifier hs-var">FsD</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;dots&quot;</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-156"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- | Convert our 'Accid' to MEI @accid@ (omit if natural)</span><span>
</span><a name="line-159"></a><span class="hs-comment">--</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- __TODO__ Verovio will display the accidental if the @accid@ attribute or</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- element is present, regardless of the key signature. We would need to check</span><span>
</span><a name="line-162"></a><span class="hs-comment">-- the tone/key and then use accid.ges for accidentals that are in the key</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- signature.</span><span>
</span><a name="line-164"></a><span class="hs-identifier">meiAccid</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-165"></a><a name="meiAccid"><a href="Scribo.MEI.html#meiAccid"><span class="hs-identifier">meiAccid</span></a></a><span> </span><a name="local-6989586621679126997"><a href="#local-6989586621679126997"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">accidType</span><span> </span><a href="#local-6989586621679126997"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-166"></a><span>    </span><a href="Aedifico.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-167"></a><span>    </span><a href="Aedifico.html#Written"><span class="hs-identifier hs-var">Written</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;accid&quot;</span><span>
</span><a name="line-168"></a><span>                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;accid&quot;</span><span> </span><a href="#local-6989586621679126998"><span class="hs-identifier hs-var">accidString</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-169"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-170"></a><span>    </span><a href="Aedifico.html#Implicit"><span class="hs-identifier hs-var">Implicit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;accid&quot;</span><span>
</span><a name="line-171"></a><span>                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;accid.ges&quot;</span><span> </span><a href="#local-6989586621679126998"><span class="hs-identifier hs-var">accidString</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-172"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-173"></a><span>    </span><a href="Aedifico.html#Suggested"><span class="hs-identifier hs-var">Suggested</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;accid&quot;</span><span>
</span><a name="line-174"></a><span>                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;accid&quot;</span><span> </span><a href="#local-6989586621679126998"><span class="hs-identifier hs-var">accidString</span></a><span>
</span><a name="line-175"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;func&quot;</span><span> </span><span class="hs-string">&quot;edit&quot;</span><span>
</span><a name="line-176"></a><span>                </span><span class="hs-special">]</span><span>
</span><a name="line-177"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126998"><a href="#local-6989586621679126998"><span class="hs-identifier">accidString</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">accid</span><span> </span><a href="#local-6989586621679126997"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-179"></a><span>            </span><a href="Aedifico.html#Fl"><span class="hs-identifier hs-var">Fl</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;f&quot;</span><span>
</span><a name="line-180"></a><span>            </span><a href="Aedifico.html#Na"><span class="hs-identifier hs-var">Na</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;n&quot;</span><span>
</span><a name="line-181"></a><span>            </span><a href="Aedifico.html#Sh"><span class="hs-identifier hs-var">Sh</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;s&quot;</span><span>
</span><a name="line-182"></a><span>            </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;unknown accid&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">accid</span><span> </span><a href="#local-6989586621679126997"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- *** Conversions for lyrics</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-comment">-- | If a word is a single syllable, we do not need to include @\@con@ or</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- @\@wordpos@; if it is more than one syllable, we include these attributes.</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- We use a dash connector by default, and get the word position from the data</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- in the 'Syllable' type.</span><span>
</span><a name="line-190"></a><span class="hs-identifier">meiSyllable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cogito.Musarithmetic.html#Syllable"><span class="hs-identifier hs-type">Syllable</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-191"></a><a name="meiSyllable"><a href="Scribo.MEI.html#meiSyllable"><span class="hs-identifier">meiSyllable</span></a></a><span> </span><a name="local-6989586621679126999"><a href="#local-6989586621679126999"><span class="hs-identifier">syl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">sylPosition</span><span> </span><a href="#local-6989586621679126999"><span class="hs-identifier hs-var">syl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-192"></a><span>    </span><a href="Cogito.Musarithmetic.html#Tacet"><span class="hs-identifier hs-var">Tacet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-193"></a><span>    </span><a href="Cogito.Musarithmetic.html#Only"><span class="hs-identifier hs-var">Only</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;syl&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679127000"><span class="hs-identifier hs-var">text</span></a><span class="hs-special">]</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;syl&quot;</span><span>
</span><a name="line-195"></a><span>                </span><span class="hs-special">[</span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679127001"><span class="hs-identifier hs-var">sylConnector</span></a><span> </span><span class="hs-string">&quot;d&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127002"><span class="hs-identifier hs-var">sylPos2mei</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">sylPosition</span><span> </span><a href="#local-6989586621679126999"><span class="hs-identifier hs-var">syl</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-196"></a><span>                </span><span class="hs-special">[</span><a href="#local-6989586621679127000"><span class="hs-identifier hs-var">text</span></a><span class="hs-special">]</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-198"></a><span>        </span><a name="local-6989586621679127000"><a href="#local-6989586621679127000"><span class="hs-identifier">text</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sylText</span><span> </span><a href="#local-6989586621679126999"><span class="hs-identifier hs-var">syl</span></a><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span>        </span><span class="hs-comment">-- | Syllable connector: We call this with default @d@ for dash, but</span><span>
</span><a name="line-201"></a><span>        </span><span class="hs-comment">-- could be modified to elide syllables (@b@ for breve, curved line</span><span>
</span><a name="line-202"></a><span>        </span><span class="hs-comment">-- below).</span><span>
</span><a name="line-203"></a><span>        </span><span class="hs-identifier">sylConnector</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-204"></a><span>        </span><a name="local-6989586621679127001"><a href="#local-6989586621679127001"><span class="hs-identifier">sylConnector</span></a></a><span> </span><a name="local-6989586621679127003"><a href="#local-6989586621679127003"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;con&quot;</span><span> </span><a href="#local-6989586621679127003"><span class="hs-identifier hs-var">value</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span>        </span><span class="hs-comment">-- | Convert our 'SyllablePosition' to MEI @wordpos@ (first/initial,</span><span>
</span><a name="line-207"></a><span>        </span><span class="hs-comment">-- @i@; middle, @m@; or last/terminal, @t@)</span><span>
</span><a name="line-208"></a><span>        </span><span class="hs-identifier">sylPos2mei</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cogito.Musarithmetic.html#SyllablePosition"><span class="hs-identifier hs-type">SyllablePosition</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-209"></a><span>        </span><a name="local-6989586621679127002"><a href="#local-6989586621679127002"><span class="hs-identifier">sylPos2mei</span></a></a><span> </span><a name="local-6989586621679127004"><a href="#local-6989586621679127004"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;wordpos&quot;</span><span> </span><a href="#local-6989586621679127005"><span class="hs-identifier hs-var">meiPos</span></a><span>
</span><a name="line-210"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679127005"><a href="#local-6989586621679127005"><span class="hs-identifier">meiPos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679127004"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-211"></a><span>                    </span><a href="Cogito.Musarithmetic.html#First"><span class="hs-identifier hs-var">First</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;i&quot;</span><span>
</span><a name="line-212"></a><span>                    </span><a href="Cogito.Musarithmetic.html#Middle"><span class="hs-identifier hs-var">Middle</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;m&quot;</span><span>
</span><a name="line-213"></a><span>                    </span><a href="Cogito.Musarithmetic.html#Last"><span class="hs-identifier hs-var">Last</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;t&quot;</span><span>
</span><a name="line-214"></a><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Unknown syllable position&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679127004"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">]</span><span>
</span><a name="line-215"></a><span>                    </span><span class="hs-comment">-- last two positions are Only and Tacet which shouldn't make</span><span>
</span><a name="line-216"></a><span>                    </span><span class="hs-comment">-- it this far</span><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-comment">-- * Write large groups to MEI</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span class="hs-comment">-- | Where is this item in the list that contains it?</span><span>
</span><a name="line-221"></a><span class="hs-keyword">data</span><span> </span><a name="ListPosition"><a href="Scribo.MEI.html#ListPosition"><span class="hs-identifier">ListPosition</span></a></a><span> </span><span class="hs-glyph">=</span><span>   </span><a name="ListHead"><a href="Scribo.MEI.html#ListHead"><span class="hs-identifier">ListHead</span></a></a><span> </span><span class="hs-comment">-- ^ head of list</span><span>
</span><a name="line-222"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a name="ListBody"><a href="Scribo.MEI.html#ListBody"><span class="hs-identifier">ListBody</span></a></a><span> </span><span class="hs-comment">-- ^ neither head nor last</span><span>
</span><a name="line-223"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a name="ListEnd"><a href="Scribo.MEI.html#ListEnd"><span class="hs-identifier">ListEnd</span></a></a><span>  </span><span class="hs-comment">-- ^ last item in list</span><span>
</span><a name="line-224"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a name="ListOnly"><a href="Scribo.MEI.html#ListOnly"><span class="hs-identifier">ListOnly</span></a></a><span> </span><span class="hs-comment">-- ^ only item of a one-item list</span><span>
</span><a name="line-225"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">-- | Given a function that takes a ListPosition argument and a list, apply the</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- function to the list. This allows you to treat the first and last items in</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- the list differently.</span><span>
</span><a name="line-230"></a><span class="hs-identifier">positionMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListPosition"><span class="hs-identifier hs-type">ListPosition</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126964"><span class="hs-identifier hs-type">a1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126965"><span class="hs-identifier hs-type">a2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126964"><span class="hs-identifier hs-type">a1</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126965"><span class="hs-identifier hs-type">a2</span></a><span class="hs-special">]</span><span>
</span><a name="line-231"></a><a name="positionMap"><a href="Scribo.MEI.html#positionMap"><span class="hs-identifier">positionMap</span></a></a><span> </span><a name="local-6989586621679127006"><a href="#local-6989586621679127006"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621679127007"><a href="#local-6989586621679127007"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679127006"><span class="hs-identifier hs-var">fn</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Scribo.MEI.html#markedEnds"><span class="hs-identifier hs-var">markedEnds</span></a><span> </span><a href="#local-6989586621679127007"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">-- | Mark a list with the positions of the items: first, body, and last.</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- Output a list of pairs with the 'ListPosition' and the original list item.</span><span>
</span><a name="line-235"></a><span class="hs-identifier">markedEnds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126963"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListPosition"><span class="hs-identifier hs-type">ListPosition</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126963"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><a name="markedEnds"><a href="Scribo.MEI.html#markedEnds"><span class="hs-identifier">markedEnds</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-238"></a><span class="hs-identifier">markedEnds</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679127008"><a href="#local-6989586621679127008"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListOnly"><span class="hs-identifier hs-var">ListOnly</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127008"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-239"></a><span class="hs-identifier">markedEnds</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679127009"><a href="#local-6989586621679127009"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679127010"><a href="#local-6989586621679127010"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListHead"><span class="hs-identifier hs-var">ListHead</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127009"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListEnd"><span class="hs-identifier hs-var">ListEnd</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127010"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-241"></a><span class="hs-identifier">markedEnds</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679127011"><a href="#local-6989586621679127011"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679127012"><a href="#local-6989586621679127012"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679127013"><a href="#local-6989586621679127013"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListHead"><span class="hs-identifier hs-var">ListHead</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127011"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-242"></a><span>                      </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679127014"><a href="#local-6989586621679127014"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListBody"><span class="hs-identifier hs-var">ListBody</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127014"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679127012"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679127013"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>                      </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListEnd"><span class="hs-identifier hs-var">ListEnd</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679127013"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">-- | Make an XML string containing a list of @note@ elements out of a</span><span>
</span><a name="line-246"></a><span class="hs-comment">-- 'MusicPhrase'; end each phrase with @barline@, except for last in the list.</span><span>
</span><a name="line-247"></a><span class="hs-comment">--</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- Leave the barline of the last phrase up to the next-higher function (end of</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- sentence gets regular bar; end of sentence, double bar; end of</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- section, final bar).</span><span>
</span><a name="line-251"></a><span class="hs-identifier">phrase2mei</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListPosition"><span class="hs-identifier hs-type">ListPosition</span></a><span class="hs-special">,</span><span> </span><a href="Cogito.Musarithmetic.html#MusicPhrase"><span class="hs-identifier hs-type">MusicPhrase</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-252"></a><a name="phrase2mei"><a href="Scribo.MEI.html#phrase2mei"><span class="hs-identifier">phrase2mei</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679127015"><a href="#local-6989586621679127015"><span class="hs-identifier">position</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679127016"><a href="#local-6989586621679127016"><span class="hs-identifier">phrase</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679127015"><span class="hs-identifier hs-var">position</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Scribo.MEI.html#ListEnd"><span class="hs-identifier hs-var">ListEnd</span></a><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#ListOnly"><span class="hs-identifier hs-var">ListOnly</span></a><span class="hs-special">]</span><span>
</span><a name="line-253"></a><span>                                    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679127017"><span class="hs-identifier hs-var">meiNotes</span></a><span>
</span><a name="line-254"></a><span>                              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-255"></a><span>                                    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679127017"><span class="hs-identifier hs-var">meiNotes</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Scribo.MEI.html#meiBarline"><span class="hs-identifier hs-var">meiBarline</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-256"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679127017"><a href="#local-6989586621679127017"><span class="hs-identifier">meiNotes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Scribo.MEI.html#note2mei"><span class="hs-identifier hs-var">note2mei</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">notes</span><span> </span><a href="#local-6989586621679127016"><span class="hs-identifier hs-var">phrase</span></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-comment">-- | Make an XML string containing all the contents of one @layer@ out of a</span><span>
</span><a name="line-260"></a><span class="hs-comment">-- 'MusicSentence'.</span><span>
</span><a name="line-261"></a><span class="hs-comment">-- If this is the last sentence in the section, omit the bar so the higher</span><span>
</span><a name="line-262"></a><span class="hs-comment">-- function calling this one can add it.</span><span>
</span><a name="line-263"></a><span class="hs-comment">-- Sentence ends with regular barline.</span><span>
</span><a name="line-264"></a><span class="hs-identifier">sentence2mei</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListPosition"><span class="hs-identifier hs-type">ListPosition</span></a><span class="hs-special">,</span><span> </span><a href="Cogito.Musarithmetic.html#MusicSentence"><span class="hs-identifier hs-type">MusicSentence</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-265"></a><a name="sentence2mei"><a href="Scribo.MEI.html#sentence2mei"><span class="hs-identifier">sentence2mei</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679127018"><a href="#local-6989586621679127018"><span class="hs-identifier">position</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679127019"><a href="#local-6989586621679127019"><span class="hs-identifier">sent</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679127018"><span class="hs-identifier hs-var">position</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Scribo.MEI.html#ListEnd"><span class="hs-identifier hs-var">ListEnd</span></a><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#ListOnly"><span class="hs-identifier hs-var">ListOnly</span></a><span class="hs-special">]</span><span>
</span><a name="line-266"></a><span>                                    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679127020"><span class="hs-identifier hs-var">meiPhrases</span></a><span>
</span><a name="line-267"></a><span>                              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-268"></a><span>                                    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679127020"><span class="hs-identifier hs-var">meiPhrases</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Scribo.MEI.html#meiBarline"><span class="hs-identifier hs-var">meiBarline</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-269"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679127020"><a href="#local-6989586621679127020"><span class="hs-identifier">meiPhrases</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Scribo.MEI.html#phrase2mei"><span class="hs-identifier hs-var">phrase2mei</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Scribo.MEI.html#markedEnds"><span class="hs-identifier hs-var">markedEnds</span></a><span> </span><a href="#local-6989586621679127019"><span class="hs-identifier hs-var">sent</span></a><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-comment">-- | A 'MusicSection' contains all the music for one section, /for a single</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- voice/: so combine all subdivisions into one @staff@ and @layer@ so this</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- can be made part of an MEI @section@ in 'chorus2mei'.  </span><span>
</span><a name="line-274"></a><span class="hs-comment">-- Include MEI 1-indexed staff number derived from 'VoiceName' enum </span><span>
</span><a name="line-275"></a><span class="hs-comment">-- Put a double bar at the end of sections and a final bar at the end of the</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- piece.</span><span>
</span><a name="line-277"></a><span class="hs-comment">--</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- __TODO__: you could put more than one layer per staff if you wanted a</span><span>
</span><a name="line-279"></a><span class="hs-comment">-- 2-staff choirstaff (e.g., SA on one, TB on the other)</span><span>
</span><a name="line-280"></a><span class="hs-identifier">section2mei</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListPosition"><span class="hs-identifier hs-type">ListPosition</span></a><span class="hs-special">,</span><span> </span><a href="Cogito.Musarithmetic.html#MusicSection"><span class="hs-identifier hs-type">MusicSection</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-281"></a><a name="section2mei"><a href="Scribo.MEI.html#section2mei"><span class="hs-identifier">section2mei</span></a></a><span> </span><a name="local-6989586621679127021"><a href="#local-6989586621679127021"><span class="hs-identifier">arca</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679127022"><a href="#local-6989586621679127022"><span class="hs-identifier">position</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679127023"><a href="#local-6989586621679127023"><span class="hs-identifier">sec</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127026"><span class="hs-identifier hs-var">scoreDef</span></a><span>
</span><a name="line-283"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;staff&quot;</span><span>
</span><a name="line-284"></a><span>                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;n&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679127024"><span class="hs-identifier hs-var">voiceNum</span></a><span>
</span><a name="line-285"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;corresp&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679127025"><span class="hs-identifier hs-var">voiceName</span></a><span>
</span><a name="line-286"></a><span>                </span><span class="hs-special">]</span><span>
</span><a name="line-287"></a><span>                </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127027"><span class="hs-identifier hs-var">tempo</span></a><span> </span><span class="hs-comment">-- TODO This is correct MEI but Verovio does not support this</span><span>
</span><a name="line-288"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;layer&quot;</span><span>
</span><a name="line-289"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;n&quot;</span><span> </span><span class="hs-string">&quot;1&quot;</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- just one layer per staff</span><span>
</span><a name="line-290"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127032"><span class="hs-identifier hs-var">meiSentencesWithBar</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-291"></a><span>                </span><span class="hs-special">]</span><span>
</span><a name="line-292"></a><span>            </span><span class="hs-special">]</span><span>
</span><a name="line-293"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-294"></a><span>        </span><a name="local-6989586621679127024"><a href="#local-6989586621679127024"><span class="hs-identifier">voiceNum</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679127025"><span class="hs-identifier hs-var">voiceName</span></a><span>
</span><a name="line-295"></a><span>        </span><a name="local-6989586621679127025"><a href="#local-6989586621679127025"><span class="hs-identifier">voiceName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">secVoiceID</span><span> </span><a href="#local-6989586621679127023"><span class="hs-identifier hs-var">sec</span></a><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span>        </span><a name="local-6989586621679127026"><a href="#local-6989586621679127026"><span class="hs-identifier">scoreDef</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679127022"><span class="hs-identifier hs-var">position</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Scribo.MEI.html#ListHead"><span class="hs-identifier hs-var">ListHead</span></a><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#ListOnly"><span class="hs-identifier hs-var">ListOnly</span></a><span class="hs-special">]</span><span>
</span><a name="line-298"></a><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-299"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-300"></a><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;scoreDef&quot;</span><span>
</span><a name="line-301"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127028"><span class="hs-identifier hs-var">mensur</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679127030"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span>        </span><a name="local-6989586621679127027"><a href="#local-6989586621679127027"><span class="hs-identifier">tempo</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiMidiTempo"><span class="hs-identifier hs-var">meiMidiTempo</span></a><span> </span><a href="#local-6989586621679127029"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-304"></a><span>        </span><a name="local-6989586621679127028"><a href="#local-6989586621679127028"><span class="hs-identifier">mensur</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiMeter"><span class="hs-identifier hs-var">meiMeter</span></a><span> </span><a href="#local-6989586621679127029"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-305"></a><span>        </span><a name="local-6989586621679127029"><a href="#local-6989586621679127029"><span class="hs-identifier">meter</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkMusicMeter</span><span> </span><a href="#local-6989586621679127031"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-306"></a><span>        </span><a name="local-6989586621679127030"><a href="#local-6989586621679127030"><span class="hs-identifier">key</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiKey"><span class="hs-identifier hs-var">meiKey</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">arkTone</span><span> </span><a href="#local-6989586621679127031"><span class="hs-identifier hs-var">config</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">systems</span><span> </span><a href="#local-6989586621679127021"><span class="hs-identifier hs-var">arca</span></a><span>
</span><a name="line-307"></a><span>
</span><a name="line-308"></a><span>        </span><a name="local-6989586621679127031"><a href="#local-6989586621679127031"><span class="hs-identifier">config</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">secConfig</span><span> </span><a href="#local-6989586621679127023"><span class="hs-identifier hs-var">sec</span></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span>        </span><a name="local-6989586621679127032"><a href="#local-6989586621679127032"><span class="hs-identifier">meiSentencesWithBar</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679127022"><span class="hs-identifier hs-var">position</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Scribo.MEI.html#ListEnd"><span class="hs-identifier hs-var">ListEnd</span></a><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#ListOnly"><span class="hs-identifier hs-var">ListOnly</span></a><span class="hs-special">]</span><span>
</span><a name="line-311"></a><span>                                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679127033"><span class="hs-identifier hs-var">meiSentences</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Scribo.MEI.html#meiFinalBar"><span class="hs-identifier hs-var">meiFinalBar</span></a><span>
</span><a name="line-312"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-313"></a><span>                                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679127033"><span class="hs-identifier hs-var">meiSentences</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Scribo.MEI.html#meiDoubleBar"><span class="hs-identifier hs-var">meiDoubleBar</span></a><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span>        </span><a name="local-6989586621679127033"><a href="#local-6989586621679127033"><span class="hs-identifier">meiSentences</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Scribo.MEI.html#sentence2mei"><span class="hs-identifier hs-var">sentence2mei</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Scribo.MEI.html#markedEnds"><span class="hs-identifier hs-var">markedEnds</span></a><span> </span><a href="#local-6989586621679127034"><span class="hs-identifier hs-var">sentences</span></a><span>
</span><a name="line-316"></a><span>        </span><a name="local-6989586621679127034"><a href="#local-6989586621679127034"><span class="hs-identifier">sentences</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">secSentences</span><span> </span><a href="#local-6989586621679127023"><span class="hs-identifier hs-var">sec</span></a><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-comment">-- | Take a list of sections, one per SATB voice, and create a single MEI</span><span>
</span><a name="line-319"></a><span class="hs-comment">-- @section@ including all the voices.</span><span>
</span><a name="line-320"></a><span class="hs-comment">-- Add a final bar at the end.</span><span>
</span><a name="line-321"></a><span class="hs-identifier">chorus2mei</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#ListPosition"><span class="hs-identifier hs-type">ListPosition</span></a><span class="hs-special">,</span><span> </span><a href="Cogito.Musarithmetic.html#MusicChorus"><span class="hs-identifier hs-type">MusicChorus</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-322"></a><a name="chorus2mei"><a href="Scribo.MEI.html#chorus2mei"><span class="hs-identifier">chorus2mei</span></a></a><span> </span><a name="local-6989586621679127035"><a href="#local-6989586621679127035"><span class="hs-identifier">arca</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679127036"><a href="#local-6989586621679127036"><span class="hs-identifier">position</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679127037"><a href="#local-6989586621679127037"><span class="hs-identifier">chorus</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;section&quot;</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127039"><span class="hs-identifier hs-var">music</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-323"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-324"></a><span>        </span><a name="local-6989586621679127038"><a href="#local-6989586621679127038"><span class="hs-identifier">config</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">secConfig</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cantus</span><span> </span><a href="#local-6989586621679127037"><span class="hs-identifier hs-var">chorus</span></a><span>
</span><a name="line-325"></a><span>        </span><a name="local-6989586621679127039"><a href="#local-6989586621679127039"><span class="hs-identifier">music</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679127041"><a href="#local-6989586621679127041"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Scribo.MEI.html#section2mei"><span class="hs-identifier hs-var">section2mei</span></a><span> </span><a href="#local-6989586621679127035"><span class="hs-identifier hs-var">arca</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679127036"><span class="hs-identifier hs-var">position</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127041"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679127040"><span class="hs-identifier hs-var">choruses</span></a><span>
</span><a name="line-326"></a><span>        </span><a name="local-6989586621679127040"><a href="#local-6989586621679127040"><span class="hs-identifier">choruses</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#chorus2list"><span class="hs-identifier hs-var">chorus2list</span></a><span> </span><a href="#local-6989586621679127037"><span class="hs-identifier hs-var">chorus</span></a><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">-- | Create an MEI key signature (all naturals or one flat) based on tone</span><span>
</span><a name="line-329"></a><span class="hs-comment">-- (@key.sig@ attribute for use in @scoreDef@/@staffDef@)</span><span>
</span><a name="line-330"></a><span class="hs-identifier">meiKey</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Tone"><span class="hs-identifier hs-type">Tone</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ToneSystem"><span class="hs-identifier hs-type">ToneSystem</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-331"></a><a name="meiKey"><a href="Scribo.MEI.html#meiKey"><span class="hs-identifier">meiKey</span></a></a><span> </span><a name="local-6989586621679127042"><a href="#local-6989586621679127042"><span class="hs-identifier">tone</span></a></a><span> </span><a name="local-6989586621679127043"><a href="#local-6989586621679127043"><span class="hs-identifier">toneSystem</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;keySig&quot;</span><span>
</span><a name="line-332"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;sig&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Scribo.MEI.html#meiKeySigString"><span class="hs-identifier hs-var">meiKeySigString</span></a><span> </span><a href="#local-6989586621679127042"><span class="hs-identifier hs-var">tone</span></a><span> </span><a href="#local-6989586621679127043"><span class="hs-identifier hs-var">toneSystem</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-333"></a><span>                            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- | MEI key signature as an attribute (for use in @staffDef@)</span><span>
</span><a name="line-336"></a><span class="hs-identifier">meiKeyAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Tone"><span class="hs-identifier hs-type">Tone</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ToneSystem"><span class="hs-identifier hs-type">ToneSystem</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-337"></a><a name="meiKeyAttr"><a href="Scribo.MEI.html#meiKeyAttr"><span class="hs-identifier">meiKeyAttr</span></a></a><span> </span><a name="local-6989586621679127044"><a href="#local-6989586621679127044"><span class="hs-identifier">tone</span></a></a><span> </span><a name="local-6989586621679127045"><a href="#local-6989586621679127045"><span class="hs-identifier">toneSystem</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;key.sig&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Scribo.MEI.html#meiKeySigString"><span class="hs-identifier hs-var">meiKeySigString</span></a><span> </span><a href="#local-6989586621679127044"><span class="hs-identifier hs-var">tone</span></a><span> </span><a href="#local-6989586621679127045"><span class="hs-identifier hs-var">toneSystem</span></a><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-comment">-- | Value for MEI @key.sig@: one flat if tone is /mollis/, no signature</span><span>
</span><a name="line-340"></a><span class="hs-comment">-- otherwise</span><span>
</span><a name="line-341"></a><span class="hs-identifier">meiKeySigString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Tone"><span class="hs-identifier hs-type">Tone</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ToneSystem"><span class="hs-identifier hs-type">ToneSystem</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-342"></a><a name="meiKeySigString"><a href="Scribo.MEI.html#meiKeySigString"><span class="hs-identifier">meiKeySigString</span></a></a><span> </span><a name="local-6989586621679127046"><a href="#local-6989586621679127046"><span class="hs-identifier">tone</span></a></a><span> </span><a name="local-6989586621679127047"><a href="#local-6989586621679127047"><span class="hs-identifier">toneSystem</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Cogito.Musarithmetic.html#toneMollis"><span class="hs-identifier hs-var">toneMollis</span></a><span> </span><a href="#local-6989586621679127046"><span class="hs-identifier hs-var">tone</span></a><span> </span><a href="#local-6989586621679127047"><span class="hs-identifier hs-var">toneSystem</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;1f&quot;</span><span>
</span><a name="line-343"></a><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;0&quot;</span><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">-- | Switch to select which kind of meter to use as an element</span><span>
</span><a name="line-347"></a><span class="hs-identifier">meiMeter</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-348"></a><a name="meiMeter"><a href="Scribo.MEI.html#meiMeter"><span class="hs-identifier">meiMeter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiMeterMensural"><span class="hs-identifier hs-var">meiMeterMensural</span></a><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-comment">-- | Switch to select which kind of meter to use as an attribute</span><span>
</span><a name="line-351"></a><span class="hs-identifier">meiMeterAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-352"></a><a name="meiMeterAttr"><a href="Scribo.MEI.html#meiMeterAttr"><span class="hs-identifier">meiMeterAttr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiMeterMensuralAttr"><span class="hs-identifier hs-var">meiMeterMensuralAttr</span></a><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-comment">-- | Create an MEI meter signature (using modern equivalents of Kircher's C,</span><span>
</span><a name="line-355"></a><span class="hs-comment">-- C3, cutC3).</span><span>
</span><a name="line-356"></a><span class="hs-comment">-- (@meterSig with @meter.count@ and @meter.unit@ attributes for use in</span><span>
</span><a name="line-357"></a><span class="hs-comment">-- @scoreDef@/@staffDef@) </span><span>
</span><a name="line-358"></a><span class="hs-identifier">meiMeterModern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-359"></a><a name="meiMeterModern"><a href="Scribo.MEI.html#meiMeterModern"><span class="hs-identifier">meiMeterModern</span></a></a><span> </span><a name="local-6989586621679127048"><a href="#local-6989586621679127048"><span class="hs-identifier">meter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;meterSig&quot;</span><span>
</span><a name="line-360"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;count&quot;</span><span> </span><a href="#local-6989586621679127049"><span class="hs-identifier hs-var">count</span></a><span>
</span><a name="line-361"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;unit&quot;</span><span> </span><span class="hs-keyword">unit</span><span>
</span><a name="line-362"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-363"></a><span>                    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-364"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-365"></a><span>        </span><a name="local-6989586621679127049"><a href="#local-6989586621679127049"><span class="hs-identifier">count</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679127051"><span class="hs-identifier hs-var">meterValues</span></a><span>
</span><a name="line-366"></a><span>        </span><span class="hs-keyword">unit</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679127051"><span class="hs-identifier hs-var">meterValues</span></a><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span>        </span><a name="local-6989586621679127051"><a href="#local-6989586621679127051"><span class="hs-identifier">meterValues</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679127048"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-369"></a><span>            </span><a href="Aedifico.html#Duple"><span class="hs-identifier hs-var">Duple</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-number">4</span><span class="hs-special">,</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span>            </span><a href="Aedifico.html#TripleMajor"><span class="hs-identifier hs-var">TripleMajor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span>            </span><a href="Aedifico.html#TripleMinor"><span class="hs-identifier hs-var">TripleMinor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-special">,</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span class="hs-comment">-- | Mensural version of 'meiMeter'. We want either &quot;cut C&quot;, &quot;C3&quot;, or &quot;cutC3&quot;.</span><span>
</span><a name="line-374"></a><span class="hs-comment">-- Verovio does not render these correctly as of 2021/07 when using the</span><span>
</span><a name="line-375"></a><span class="hs-comment">-- @proport@ element (or @proport.num@ attribute) for the number, which is the</span><span>
</span><a name="line-376"></a><span class="hs-comment">-- correct encoding. But putting @num@ directly inside @mensur@ works with</span><span>
</span><a name="line-377"></a><span class="hs-comment">-- Verovio.</span><span>
</span><a name="line-378"></a><span class="hs-identifier">meiMeterMensural</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-379"></a><a name="meiMeterMensural"><a href="Scribo.MEI.html#meiMeterMensural"><span class="hs-identifier">meiMeterMensural</span></a></a><span> </span><a name="local-6989586621679127052"><a href="#local-6989586621679127052"><span class="hs-identifier">meter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;mensur&quot;</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127053"><span class="hs-identifier hs-var">mensur</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-380"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-381"></a><span>        </span><a name="local-6989586621679127053"><a href="#local-6989586621679127053"><span class="hs-identifier">mensur</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679127052"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-382"></a><span>            </span><a href="Aedifico.html#Duple"><span class="hs-identifier hs-var">Duple</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679127054"><span class="hs-identifier hs-var">meterCutC</span></a><span>
</span><a name="line-383"></a><span>            </span><a href="Aedifico.html#TripleMinor"><span class="hs-identifier hs-var">TripleMinor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679127055"><span class="hs-identifier hs-var">meterC3</span></a><span>
</span><a name="line-384"></a><span>            </span><a href="Aedifico.html#TripleMajor"><span class="hs-identifier hs-var">TripleMajor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679127056"><span class="hs-identifier hs-var">meterCutC3</span></a><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><span>        </span><a name="local-6989586621679127054"><a href="#local-6989586621679127054"><span class="hs-identifier">meterCutC</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127057"><span class="hs-identifier hs-var">imperfectTempus</span></a><span>
</span><a name="line-387"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127059"><span class="hs-identifier hs-var">allaBreve</span></a><span>
</span><a name="line-388"></a><span>                      </span><span class="hs-special">]</span><span>
</span><a name="line-389"></a><span>        </span><a name="local-6989586621679127055"><a href="#local-6989586621679127055"><span class="hs-identifier">meterC3</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127057"><span class="hs-identifier hs-var">imperfectTempus</span></a><span>
</span><a name="line-390"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127058"><span class="hs-identifier hs-var">minorProportion</span></a><span>
</span><a name="line-391"></a><span>                      </span><span class="hs-special">]</span><span>
</span><a name="line-392"></a><span>        </span><a name="local-6989586621679127056"><a href="#local-6989586621679127056"><span class="hs-identifier">meterCutC3</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127057"><span class="hs-identifier hs-var">imperfectTempus</span></a><span>
</span><a name="line-393"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127059"><span class="hs-identifier hs-var">allaBreve</span></a><span>
</span><a name="line-394"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127058"><span class="hs-identifier hs-var">minorProportion</span></a><span>
</span><a name="line-395"></a><span>                      </span><span class="hs-special">]</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span>        </span><a name="local-6989586621679127057"><a href="#local-6989586621679127057"><span class="hs-identifier">imperfectTempus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;sign&quot;</span><span>    </span><span class="hs-string">&quot;C&quot;</span><span>
</span><a name="line-398"></a><span>                                  </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;tempus&quot;</span><span>  </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-399"></a><span>                                  </span><span class="hs-special">]</span><span>
</span><a name="line-400"></a><span>        </span><a name="local-6989586621679127058"><a href="#local-6989586621679127058"><span class="hs-identifier">minorProportion</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;num&quot;</span><span>     </span><span class="hs-string">&quot;3&quot;</span><span>
</span><a name="line-401"></a><span>        </span><a name="local-6989586621679127059"><a href="#local-6989586621679127059"><span class="hs-identifier">allaBreve</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;slash&quot;</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-comment">-- | Mensural meter with proportion as a string of attributes (for use in</span><span>
</span><a name="line-404"></a><span class="hs-comment">-- @staffDef@, where the correct encoding also works with Verovio).</span><span>
</span><a name="line-405"></a><span class="hs-identifier">meiMeterMensuralAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-406"></a><a name="meiMeterMensuralAttr"><a href="Scribo.MEI.html#meiMeterMensuralAttr"><span class="hs-identifier">meiMeterMensuralAttr</span></a></a><span> </span><a name="local-6989586621679127060"><a href="#local-6989586621679127060"><span class="hs-identifier">meter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679127060"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-407"></a><span>        </span><a href="Aedifico.html#Duple"><span class="hs-identifier hs-var">Duple</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;mensur.sign&quot;</span><span>   </span><span class="hs-string">&quot;C&quot;</span><span>
</span><a name="line-408"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;mensur.tempus&quot;</span><span> </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-409"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;mensur.slash&quot;</span><span>  </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-410"></a><span>                       </span><span class="hs-special">]</span><span>
</span><a name="line-411"></a><span>        </span><a href="Aedifico.html#TripleMajor"><span class="hs-identifier hs-var">TripleMajor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;mensur.sign&quot;</span><span>   </span><span class="hs-string">&quot;C&quot;</span><span>
</span><a name="line-412"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;mensur.slash&quot;</span><span>  </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-413"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;mensur.tempus&quot;</span><span> </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-414"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;proport.num&quot;</span><span>   </span><span class="hs-string">&quot;3&quot;</span><span>
</span><a name="line-415"></a><span>                       </span><span class="hs-special">]</span><span>
</span><a name="line-416"></a><span>        </span><a href="Aedifico.html#TripleMinor"><span class="hs-identifier hs-var">TripleMinor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;mensur.sign&quot;</span><span>   </span><span class="hs-string">&quot;C&quot;</span><span>
</span><a name="line-417"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;mensur.tempus&quot;</span><span> </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-418"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;proport.num&quot;</span><span>   </span><span class="hs-string">&quot;3&quot;</span><span>
</span><a name="line-419"></a><span>                       </span><span class="hs-special">]</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span class="hs-comment">-- | MEI @tempo@ element for MIDI speed: quarter-note (semiminim) beats per</span><span>
</span><a name="line-422"></a><span class="hs-comment">-- minute, different tempi for each mensuration</span><span>
</span><a name="line-423"></a><span class="hs-identifier">meiMidiTempo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-424"></a><a name="meiMidiTempo"><a href="Scribo.MEI.html#meiMidiTempo"><span class="hs-identifier">meiMidiTempo</span></a></a><span> </span><a name="local-6989586621679127061"><a href="#local-6989586621679127061"><span class="hs-identifier">meter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;tempo&quot;</span><span>
</span><a name="line-425"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#meiMidiBPM"><span class="hs-identifier hs-var">meiMidiBPM</span></a><span> </span><a href="#local-6989586621679127061"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-426"></a><span>                        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-427"></a><span>
</span><a name="line-428"></a><span class="hs-comment">-- | MEI @midi.bpm@ attribute appropriate for each mensuration</span><span>
</span><a name="line-429"></a><span class="hs-comment">-- This is how it should work, but Verovio does not accept a tempo element</span><span>
</span><a name="line-430"></a><span class="hs-comment">-- within staff, so I do not know how to do a tempo change mid-piece. </span><span>
</span><a name="line-431"></a><a name="meiMidiBPM"><a href="Scribo.MEI.html#meiMidiBPM"><span class="hs-identifier">meiMidiBPM</span></a></a><span> </span><a name="local-6989586621679127062"><a href="#local-6989586621679127062"><span class="hs-identifier">meter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;midi.bpm&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679127063"><span class="hs-identifier hs-var">bpm</span></a><span>
</span><a name="line-432"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679127063"><a href="#local-6989586621679127063"><span class="hs-identifier">bpm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679127062"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-433"></a><span>            </span><a href="Aedifico.html#Duple"><span class="hs-identifier hs-var">Duple</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">120</span><span>
</span><a name="line-434"></a><span>            </span><a href="Aedifico.html#TripleMinor"><span class="hs-identifier hs-var">TripleMinor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">180</span><span>
</span><a name="line-435"></a><span>            </span><a href="Aedifico.html#TripleMajor"><span class="hs-identifier hs-var">TripleMajor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">320</span><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-comment">-- | Extract a simple list of 'MusicSentence' from the four members of a</span><span>
</span><a name="line-439"></a><span class="hs-comment">-- 'MusicChorus'</span><span>
</span><a name="line-440"></a><span class="hs-identifier">chorus2list</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cogito.Musarithmetic.html#MusicChorus"><span class="hs-identifier hs-type">MusicChorus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Cogito.Musarithmetic.html#MusicSection"><span class="hs-identifier hs-type">MusicSection</span></a><span class="hs-special">]</span><span>
</span><a name="line-441"></a><a name="chorus2list"><a href="Scribo.MEI.html#chorus2list"><span class="hs-identifier">chorus2list</span></a></a><span> </span><a name="local-6989586621679127064"><a href="#local-6989586621679127064"><span class="hs-identifier">chorus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679127065"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679127064"><span class="hs-identifier hs-var">chorus</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679127065"><a href="#local-6989586621679127065"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">cantus</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">alto</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tenor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bass</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-comment">-- * Write a whole score to MEI</span><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-comment">-- | Convert a whole 'MusicScore' to MEI XML.</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- Include meter and key of first section in top-level @scoreDef@ (__TODO__ ?)</span><span>
</span><a name="line-448"></a><span class="hs-comment">-- Pass on the position in the list to the next function down.</span><span>
</span><a name="line-449"></a><span class="hs-identifier">score2mei</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#ArkMetadata"><span class="hs-identifier hs-type">ArkMetadata</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cogito.Musarithmetic.html#MusicScore"><span class="hs-identifier hs-type">MusicScore</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-450"></a><a name="score2mei"><a href="Scribo.MEI.html#score2mei"><span class="hs-identifier">score2mei</span></a></a><span> </span><a name="local-6989586621679127066"><a href="#local-6989586621679127066"><span class="hs-identifier">arca</span></a></a><span> </span><a name="local-6989586621679127067"><a href="#local-6989586621679127067"><span class="hs-identifier">metadata</span></a></a><span> </span><a name="local-6989586621679127068"><a href="#local-6989586621679127068"><span class="hs-identifier">score</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiDocument"><span class="hs-identifier hs-var">meiDocument</span></a><span> </span><a href="#local-6989586621679127069"><span class="hs-identifier hs-var">title</span></a><span> </span><a href="#local-6989586621679127070"><span class="hs-identifier hs-var">poet</span></a><span> </span><a href="#local-6989586621679127072"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679127073"><span class="hs-identifier hs-var">meter</span></a><span> </span><a href="#local-6989586621679127074"><span class="hs-identifier hs-var">bpm</span></a><span> </span><a href="#local-6989586621679127075"><span class="hs-identifier hs-var">meiScore</span></a><span>
</span><a name="line-451"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-452"></a><span>        </span><a name="local-6989586621679127069"><a href="#local-6989586621679127069"><span class="hs-identifier">title</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkTitle</span><span> </span><a href="#local-6989586621679127067"><span class="hs-identifier hs-var">metadata</span></a><span>
</span><a name="line-453"></a><span>        </span><a name="local-6989586621679127070"><a href="#local-6989586621679127070"><span class="hs-identifier">poet</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkWordsAuthor</span><span> </span><a href="#local-6989586621679127067"><span class="hs-identifier hs-var">metadata</span></a><span>
</span><a name="line-454"></a><span>        </span><a name="local-6989586621679127071"><a href="#local-6989586621679127071"><span class="hs-identifier">config</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">secConfig</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cantus</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679127068"><span class="hs-identifier hs-var">score</span></a><span>
</span><a name="line-455"></a><span>        </span><a name="local-6989586621679127072"><a href="#local-6989586621679127072"><span class="hs-identifier">key</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiKeyAttr"><span class="hs-identifier hs-var">meiKeyAttr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">arkTone</span><span> </span><a href="#local-6989586621679127071"><span class="hs-identifier hs-var">config</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">systems</span><span> </span><a href="#local-6989586621679127066"><span class="hs-identifier hs-var">arca</span></a><span>
</span><a name="line-456"></a><span>        </span><a name="local-6989586621679127073"><a href="#local-6989586621679127073"><span class="hs-identifier">meter</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiMeterAttr"><span class="hs-identifier hs-var">meiMeterAttr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">arkMusicMeter</span><span> </span><a href="#local-6989586621679127071"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-457"></a><span>        </span><a name="local-6989586621679127074"><a href="#local-6989586621679127074"><span class="hs-identifier">bpm</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiMidiBPM"><span class="hs-identifier hs-var">meiMidiBPM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">arkMusicMeter</span><span> </span><a href="#local-6989586621679127071"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-458"></a><span>        </span><a name="local-6989586621679127075"><a href="#local-6989586621679127075"><span class="hs-identifier">meiScore</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Scribo.MEI.html#chorus2mei"><span class="hs-identifier hs-var">chorus2mei</span></a><span> </span><a href="#local-6989586621679127066"><span class="hs-identifier hs-var">arca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Scribo.MEI.html#markedEnds"><span class="hs-identifier hs-var">markedEnds</span></a><span> </span><a href="#local-6989586621679127068"><span class="hs-identifier hs-var">score</span></a><span>
</span><a name="line-459"></a><span>
</span><a name="line-460"></a><span class="hs-comment">-- ** The full MEI document</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span class="hs-comment">-- *** MEI Barlines</span><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span class="hs-comment">-- | Make an MEI double barline</span><span>
</span><a name="line-465"></a><span class="hs-identifier">meiDoubleBar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-466"></a><a name="meiDoubleBar"><a href="Scribo.MEI.html#meiDoubleBar"><span class="hs-identifier">meiDoubleBar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiBarline"><span class="hs-identifier hs-var">meiBarline</span></a><span> </span><span class="hs-string">&quot;dbl&quot;</span><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span class="hs-comment">-- | Make an MEI final barline</span><span>
</span><a name="line-469"></a><span class="hs-identifier">meiFinalBar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-470"></a><a name="meiFinalBar"><a href="Scribo.MEI.html#meiFinalBar"><span class="hs-identifier">meiFinalBar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#meiBarline"><span class="hs-identifier hs-var">meiBarline</span></a><span> </span><span class="hs-string">&quot;end&quot;</span><span>
</span><a name="line-471"></a><span>
</span><a name="line-472"></a><span class="hs-comment">-- | Make an MEI @barLine@ element</span><span>
</span><a name="line-473"></a><span class="hs-identifier">meiBarline</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ form string (&quot;dbl&quot;, &quot;end&quot;, or &quot;&quot; for regular barline)</span><span>
</span><a name="line-474"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-475"></a><a name="meiBarline"><a href="Scribo.MEI.html#meiBarline"><span class="hs-identifier">meiBarline</span></a></a><span> </span><a name="local-6989586621679127076"><a href="#local-6989586621679127076"><span class="hs-identifier">form</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679127076"><span class="hs-identifier hs-var">form</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;barLine&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-476"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;barLine&quot;</span><span>
</span><a name="line-477"></a><span>                                 </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;form&quot;</span><span> </span><a href="#local-6989586621679127076"><span class="hs-identifier hs-var">form</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-478"></a><span>                                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span class="hs-comment">-- *** String constants for XML document</span><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span class="hs-comment">-- | Default XML header</span><span>
</span><a name="line-483"></a><a name="_xmlHeader"><a href="Scribo.MEI.html#_xmlHeader"><span class="hs-identifier">_xmlHeader</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt; &quot;</span><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span class="hs-comment">-- | MEI version number</span><span>
</span><a name="line-486"></a><a name="_meiVersion"><a href="Scribo.MEI.html#_meiVersion"><span class="hs-identifier">_meiVersion</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;4.0.1&quot;</span><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span class="hs-comment">-- | The &quot;composer&quot; (that is, the ark itself)</span><span>
</span><a name="line-489"></a><a name="_whoami"><a href="Scribo.MEI.html#_whoami"><span class="hs-identifier">_whoami</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Arca musarithmica Athanasii Kircherii MDCL&quot;</span><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span class="hs-comment">-- | The &quot;inventor&quot;</span><span>
</span><a name="line-492"></a><a name="_Kircher"><a href="Scribo.MEI.html#_Kircher"><span class="hs-identifier">_Kircher</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Athanasius Kircher Societatis Iesu&quot;</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span class="hs-comment">-- | MEI project description text</span><span>
</span><a name="line-495"></a><a name="_projectDesc"><a href="Scribo.MEI.html#_projectDesc"><span class="hs-identifier">_projectDesc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;This music was generated automatically using Athanasius \
\ Kircher's Arca musarithmica, a device and system he described in 1650 for \
\ generating music by choosing from sets of predefined permutations of pitches \
\ and rhythms. This digital implementation of the ark in the Haskell \
\ programming language was created in 2021. It takes parsed texts in XML format \
\ and outputs their musical setting in MEI XML encoding.&quot;</span><span>
</span><a name="line-501"></a><span>
</span><a name="line-502"></a><span class="hs-comment">-- | MEI element for MIDI instrument number (1-indexed)</span><span>
</span><a name="line-503"></a><span class="hs-identifier">midiInstrumentNum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ 1-indexed MIDI instrument number (e.g., 19 = Church Organ)</span><span>
</span><a name="line-504"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ MEI @instrDef@ element</span><span>
</span><a name="line-505"></a><a name="midiInstrumentNum"><a href="Scribo.MEI.html#midiInstrumentNum"><span class="hs-identifier">midiInstrumentNum</span></a></a><span> </span><a name="local-6989586621679127077"><a href="#local-6989586621679127077"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;instrDef&quot;</span><span>
</span><a name="line-506"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;midi.instrnum&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679127077"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-507"></a><span>                    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-508"></a><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-comment">-- | MIDI instrument for playback </span><span>
</span><a name="line-511"></a><a name="_midiInstrument"><a href="Scribo.MEI.html#_midiInstrument"><span class="hs-identifier">_midiInstrument</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#midiInstrumentNum"><span class="hs-identifier hs-var">midiInstrumentNum</span></a><span> </span><a href="#local-6989586621679127079"><span class="hs-identifier hs-var">reedOrgan</span></a><span>
</span><a name="line-512"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-513"></a><span>        </span><a name="local-6989586621679127078"><a href="#local-6989586621679127078"><span class="hs-identifier">organ</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">19</span><span>
</span><a name="line-514"></a><span>        </span><a name="local-6989586621679127079"><a href="#local-6989586621679127079"><span class="hs-identifier">reedOrgan</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">20</span><span>
</span><a name="line-515"></a><span>        </span><a name="local-6989586621679127080"><a href="#local-6989586621679127080"><span class="hs-identifier">trumpet</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">56</span><span>
</span><a name="line-516"></a><span>        </span><a name="local-6989586621679127081"><a href="#local-6989586621679127081"><span class="hs-identifier">trombone</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">57</span><span>
</span><a name="line-517"></a><span>        </span><a name="local-6989586621679127082"><a href="#local-6989586621679127082"><span class="hs-identifier">oboe</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">68</span><span>
</span><a name="line-518"></a><span>        </span><a name="local-6989586621679127083"><a href="#local-6989586621679127083"><span class="hs-identifier">panflute</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">75</span><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-comment">-- *** The template</span><span>
</span><a name="line-521"></a><span>
</span><a name="line-522"></a><span class="hs-comment">-- | Plug in variables and musical content needed to boilerplate MEI document</span><span>
</span><a name="line-523"></a><span class="hs-comment">-- in all its baroque verbosity</span><span>
</span><a name="line-524"></a><span class="hs-identifier">meiDocument</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ title </span><span>
</span><a name="line-525"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ poet/author of words</span><span>
</span><a name="line-526"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ XML string with @keySig@ element</span><span>
</span><a name="line-527"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ XML string with @mensur@ element (and @proport@ if present)</span><span>
</span><a name="line-528"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ XML string with @midi.bpm@ attribute</span><span>
</span><a name="line-529"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ XML string representing the @section@ elements</span><span>
</span><a name="line-530"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-531"></a><a name="meiDocument"><a href="Scribo.MEI.html#meiDocument"><span class="hs-identifier">meiDocument</span></a></a><span> </span><a name="local-6989586621679127084"><a href="#local-6989586621679127084"><span class="hs-identifier">title</span></a></a><span> </span><a name="local-6989586621679127085"><a href="#local-6989586621679127085"><span class="hs-identifier">poet</span></a></a><span> </span><a name="local-6989586621679127086"><a href="#local-6989586621679127086"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679127087"><a href="#local-6989586621679127087"><span class="hs-identifier">meter</span></a></a><span> </span><a name="local-6989586621679127088"><a href="#local-6989586621679127088"><span class="hs-identifier">bpm</span></a></a><span> </span><a name="local-6989586621679127089"><a href="#local-6989586621679127089"><span class="hs-identifier">sections</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Scribo.MEI.html#_xmlHeader"><span class="hs-identifier hs-var">_xmlHeader</span></a><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-532"></a><span>    </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;mei&quot;</span><span>
</span><a name="line-533"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;xmlns&quot;</span><span> </span><span class="hs-string">&quot;https://www.music-encoding.org/ns/mei&quot;</span><span>
</span><a name="line-534"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;meiversion&quot;</span><span> </span><a href="Scribo.MEI.html#_meiVersion"><span class="hs-identifier hs-var">_meiVersion</span></a><span>
</span><a name="line-535"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-536"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;meiHead&quot;</span><span>
</span><a name="line-537"></a><span>            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;fileDesc&quot;</span><span>
</span><a name="line-538"></a><span>                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;titleStmt&quot;</span><span>
</span><a name="line-539"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;title&quot;</span><span>
</span><a name="line-540"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127084"><span class="hs-identifier hs-var">title</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-541"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;composer&quot;</span><span>
</span><a name="line-542"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;persName&quot;</span><span>
</span><a name="line-543"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;role&quot;</span><span> </span><span class="hs-string">&quot;creator&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-544"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#_whoami"><span class="hs-identifier hs-var">_whoami</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-545"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-546"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;lyricist&quot;</span><span>
</span><a name="line-547"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;persName&quot;</span><span>
</span><a name="line-548"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;role&quot;</span><span> </span><span class="hs-string">&quot;lyricist&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-549"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127085"><span class="hs-identifier hs-var">poet</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-550"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-551"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;respStmt&quot;</span><span>
</span><a name="line-552"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;persName&quot;</span><span>
</span><a name="line-553"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;role&quot;</span><span> </span><span class="hs-string">&quot;inventor&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-554"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#_Kircher"><span class="hs-identifier hs-var">_Kircher</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-555"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-556"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-557"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;pubStmt&quot;</span><span>
</span><a name="line-558"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;date&quot;</span><span>
</span><a name="line-559"></a><span>                        </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;Described 1650, implemented 2021&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-560"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;availability&quot;</span><span>
</span><a name="line-561"></a><span>                        </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;Musical output of the ark is in the public domain.&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-562"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-563"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;sourceDesc&quot;</span><span>
</span><a name="line-564"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;source&quot;</span><span>
</span><a name="line-565"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;bibl&quot;</span><span>
</span><a name="line-566"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;title&quot;</span><span>
</span><a name="line-567"></a><span>                                </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;Musurgia universalis&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-568"></a><span>                            </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;author&quot;</span><span>
</span><a name="line-569"></a><span>                                </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;Athanasius Kircher&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-570"></a><span>                            </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;imprint&quot;</span><span>
</span><a name="line-571"></a><span>                                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;pubPlace&quot;</span><span>
</span><a name="line-572"></a><span>                                    </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;Rome&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-573"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;date&quot;</span><span>
</span><a name="line-574"></a><span>                                    </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;1650&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-575"></a><span>                                </span><span class="hs-special">]</span><span>
</span><a name="line-576"></a><span>                            </span><span class="hs-special">]</span><span>
</span><a name="line-577"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-578"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-579"></a><span>                </span><span class="hs-special">]</span><span>
</span><a name="line-580"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;encodingDesc&quot;</span><span>
</span><a name="line-581"></a><span>                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;appInfo&quot;</span><span>
</span><a name="line-582"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;application&quot;</span><span>
</span><a name="line-583"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;name&quot;</span><span>
</span><a name="line-584"></a><span>                            </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;arca&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-585"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-586"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-587"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;projectDesc&quot;</span><span>
</span><a name="line-588"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;p&quot;</span><span>
</span><a name="line-589"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#_projectDesc"><span class="hs-identifier hs-var">_projectDesc</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-590"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-591"></a><span>                </span><span class="hs-special">]</span><span>
</span><a name="line-592"></a><span>            </span><span class="hs-special">]</span><span>
</span><a name="line-593"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;music&quot;</span><span>
</span><a name="line-594"></a><span>            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;body&quot;</span><span>
</span><a name="line-595"></a><span>                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;mdiv&quot;</span><span>
</span><a name="line-596"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;score&quot;</span><span>
</span><a name="line-597"></a><span>                        </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;scoreDef&quot;</span><span>
</span><a name="line-598"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127088"><span class="hs-identifier hs-var">bpm</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-599"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#element"><span class="hs-identifier hs-var">element</span></a><span> </span><span class="hs-string">&quot;pgHead&quot;</span><span>
</span><a name="line-600"></a><span>                                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;rend&quot;</span><span>
</span><a name="line-601"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;valign&quot;</span><span> </span><span class="hs-string">&quot;top&quot;</span><span>
</span><a name="line-602"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;halign&quot;</span><span> </span><span class="hs-string">&quot;center&quot;</span><span>
</span><a name="line-603"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;fontsize&quot;</span><span> </span><span class="hs-string">&quot;150%&quot;</span><span>
</span><a name="line-604"></a><span>                                    </span><span class="hs-special">]</span><span>
</span><a name="line-605"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127084"><span class="hs-identifier hs-var">title</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-606"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;rend&quot;</span><span>
</span><a name="line-607"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;valign&quot;</span><span> </span><span class="hs-string">&quot;bottom&quot;</span><span>
</span><a name="line-608"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;halign&quot;</span><span> </span><span class="hs-string">&quot;right&quot;</span><span>
</span><a name="line-609"></a><span>                                    </span><span class="hs-special">]</span><span>
</span><a name="line-610"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#_whoami"><span class="hs-identifier hs-var">_whoami</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-611"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;rend&quot;</span><span>
</span><a name="line-612"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;valign&quot;</span><span> </span><span class="hs-string">&quot;bottom&quot;</span><span>
</span><a name="line-613"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;halign&quot;</span><span> </span><span class="hs-string">&quot;left&quot;</span><span>
</span><a name="line-614"></a><span>                                    </span><span class="hs-special">]</span><span>
</span><a name="line-615"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679127085"><span class="hs-identifier hs-var">poet</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-616"></a><span>                                </span><span class="hs-special">]</span><span>
</span><a name="line-617"></a><span>                            </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;staffGrp&quot;</span><span>
</span><a name="line-618"></a><span>                                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;n&quot;</span><span>          </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-619"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;bar.thru&quot;</span><span>   </span><span class="hs-string">&quot;false&quot;</span><span>
</span><a name="line-620"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;symbol&quot;</span><span>     </span><span class="hs-string">&quot;bracket&quot;</span><span>
</span><a name="line-621"></a><span>                                </span><span class="hs-special">]</span><span>
</span><a name="line-622"></a><span>                                </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;staffDef&quot;</span><span>
</span><a name="line-623"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;n&quot;</span><span>              </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-624"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;xml:id&quot;</span><span>         </span><span class="hs-string">&quot;Cantus&quot;</span><span>
</span><a name="line-625"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;lines&quot;</span><span>          </span><span class="hs-string">&quot;5&quot;</span><span>
</span><a name="line-626"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.line&quot;</span><span>      </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-627"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.shape&quot;</span><span>     </span><span class="hs-string">&quot;G&quot;</span><span>
</span><a name="line-628"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127086"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-629"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127087"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-630"></a><span>                                    </span><span class="hs-special">]</span><span>
</span><a name="line-631"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#_midiInstrument"><span class="hs-identifier hs-var">_midiInstrument</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-632"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;staffDef&quot;</span><span>
</span><a name="line-633"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;n&quot;</span><span>              </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-634"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;xml:id&quot;</span><span>         </span><span class="hs-string">&quot;Alto&quot;</span><span>
</span><a name="line-635"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;lines&quot;</span><span>          </span><span class="hs-string">&quot;5&quot;</span><span>
</span><a name="line-636"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.line&quot;</span><span>      </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-637"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.shape&quot;</span><span>     </span><span class="hs-string">&quot;G&quot;</span><span>
</span><a name="line-638"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.dis&quot;</span><span>       </span><span class="hs-string">&quot;8&quot;</span><span>
</span><a name="line-639"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.dis.place&quot;</span><span> </span><span class="hs-string">&quot;below&quot;</span><span>
</span><a name="line-640"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127086"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-641"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127087"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-642"></a><span>                                    </span><span class="hs-special">]</span><span>
</span><a name="line-643"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#_midiInstrument"><span class="hs-identifier hs-var">_midiInstrument</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-644"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;staffDef&quot;</span><span>
</span><a name="line-645"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;n&quot;</span><span>              </span><span class="hs-string">&quot;3&quot;</span><span>
</span><a name="line-646"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;xml:id&quot;</span><span>         </span><span class="hs-string">&quot;Tenor&quot;</span><span>
</span><a name="line-647"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;lines&quot;</span><span>          </span><span class="hs-string">&quot;5&quot;</span><span>
</span><a name="line-648"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.line&quot;</span><span>      </span><span class="hs-string">&quot;2&quot;</span><span>
</span><a name="line-649"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.shape&quot;</span><span>     </span><span class="hs-string">&quot;G&quot;</span><span>
</span><a name="line-650"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.dis&quot;</span><span>       </span><span class="hs-string">&quot;8&quot;</span><span>
</span><a name="line-651"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.dis.place&quot;</span><span> </span><span class="hs-string">&quot;below&quot;</span><span>
</span><a name="line-652"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127086"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-653"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127087"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-654"></a><span>                                    </span><span class="hs-special">]</span><span>
</span><a name="line-655"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#_midiInstrument"><span class="hs-identifier hs-var">_midiInstrument</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-656"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#elementAttr"><span class="hs-identifier hs-var">elementAttr</span></a><span> </span><span class="hs-string">&quot;staffDef&quot;</span><span>
</span><a name="line-657"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;n&quot;</span><span>              </span><span class="hs-string">&quot;4&quot;</span><span>
</span><a name="line-658"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;xml:id&quot;</span><span>         </span><span class="hs-string">&quot;Bass&quot;</span><span>
</span><a name="line-659"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;lines&quot;</span><span>          </span><span class="hs-string">&quot;5&quot;</span><span>
</span><a name="line-660"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.line&quot;</span><span>      </span><span class="hs-string">&quot;4&quot;</span><span>
</span><a name="line-661"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Scribo.MEI.html#attr"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-string">&quot;clef.shape&quot;</span><span>     </span><span class="hs-string">&quot;F&quot;</span><span>
</span><a name="line-662"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127086"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-663"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127087"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-664"></a><span>                                    </span><span class="hs-special">]</span><span>
</span><a name="line-665"></a><span>                                    </span><span class="hs-special">[</span><span> </span><a href="Scribo.MEI.html#_midiInstrument"><span class="hs-identifier hs-var">_midiInstrument</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-666"></a><span>                                </span><span class="hs-special">]</span><span>
</span><a name="line-667"></a><span>                            </span><span class="hs-special">]</span><span>
</span><a name="line-668"></a><span>                            </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679127089"><span class="hs-identifier hs-var">sections</span></a><span>
</span><a name="line-669"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-670"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-671"></a><span>                </span><span class="hs-special">]</span><span>
</span><a name="line-672"></a><span>            </span><span class="hs-special">]</span><span>
</span><a name="line-673"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-674"></a></pre></body></html>