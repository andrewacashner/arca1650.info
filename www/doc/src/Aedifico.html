<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Aedifico
Description : Data structures for building Kircher's /Arca musarithmica/
Copyright   : (c) Andrew A. Cashner 2020
Maintainer  : Andrew Cashner, &lt;andrew.cashner@rochester.edu&gt;
Stability   : Experimental


This module provides the data structures and methods for storing the data of
Kircher's ark and then extracting it. (*aedifico* = Latin, &quot;I build&quot;)
The @Arca_musarithmica@ module actually builds it.

= Kircher's specification

As described in Kircher's /Musurgia universalis/ (Rome, 1650), book 8, 
the ark is a box containing rods (/pinakes/), each of which includes columns
with voice and rhythm permutations. The rods are grouped according to style
into /syntagmata/, where /syntagma/ 1 is simple homorhythmic counterpoint.
There are two surviving exemplars of physical implementations of the ark.

The top part of Kircher's &quot;rods&quot; contain tables table of numbers with four
rows, where the numbers represent pitch offsets from a modal base note, and
the rows are the notes for the four voice parts SATB.  Each table represents
the notes to set a single phrase of text with a given number of syllables.

= Implementation

This module implements analogous data structures using Haskell types and
defines methods for building the ark from input data, and for accessing each
element of the ark data. 

It also defines the data types needed for the other modules.

== Structure of the ark in Haskell implementation (simplified)

&gt;    Arca
&gt;        vperms
&gt;            Arca                     = Vector (Syntagma)
&gt;            Syntagma                 = Vector (Pinax)
&gt;            Pinax                    = Vector (Column)
&gt;            Column { colVpermTable } = VpermTable
&gt;            VpermTable { vperms }    = Vector (VpermChoir)
&gt;            VpermChoir               = Vector (Vperm)
&gt;            Vperm                    = [Int]
&gt;
&gt;        rperms
&gt;            Arca                     = Vector (Syntagma)
&gt;            Syntagma                 = Vector (Pinax)
&gt;            Pinax                    = Vector (Column)
&gt;            Column { colRpermTable } = RpermTable
&gt;            RpermTable               = Vector (RpermMeter)
&gt;            RpermMeter { rperms }    = Vector (RpermChoir)
&gt;            RpermChoir               = Vector (Rperm)
&gt;            Rperm                    = [Dur]

=== Accessing perms directly

The test module @Spec.hs@ shows how to access all of the ark data directly.
These notes might clarify how to reach individual ark vperms or rperms.

&gt;       vperms
&gt;            perms arca          :: Vector (Vector (Vector Column))
&gt;            colVpermTable       :: VpermTable
&gt;            vperms vpermTable   :: Vector (Vector [Int])
&gt;
&gt;            vperm :: [Int]
&gt;            vperm = vperms table ! vpermIndex ! voiceIndex
&gt;            where
&gt;                table  = colVpermTable $ column ! columnIndex
&gt;                column = perms arca ! syntagmaIndex ! pinaxIndex ! columnIndex
&gt;
&gt;       rperms
&gt;            rperm :: [Dur]
&gt;            rperm = rperms table ! rpermMeterIndex ! rpermVoiceIndex
&gt;            where
&gt;                table  = colVpermTable $ column ! columnIndex
&gt;                column = perms arca ! syntagmaIndex ! pinaxIndex ! columnIndex
-}</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Aedifico</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Vector</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Vector</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">!?</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromList</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">-- * Utitilies</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- | Safe list indexing</span><span>
</span><a name="line-96"></a><span class="hs-special">(</span><span class="hs-operator">!!?</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031338"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679031338"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-97"></a><span class="hs-keyword">as</span><span> </span><a name="%21%21%3F"><a href="Aedifico.html#%21%21%3F"><span class="hs-operator">!!?</span></a></a><span> </span><a name="local-6989586621679031391"><a href="#local-6989586621679031391"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679031391"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-98"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679031391"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">-- * Data types</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- ** Equivalents of Kircher's Rods and Tables</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- | Pitches</span><span>
</span><a name="line-106"></a><span class="hs-comment">--</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- The 'Pnum' is a 0-indexed diatonic pitch-class number, C through C an</span><span>
</span><a name="line-108"></a><span class="hs-comment">-- octave higher. (In Kircher's 1-indexed system he uses both 1 and 8 for C so</span><span>
</span><a name="line-109"></a><span class="hs-comment">-- we must be able to tell the difference.)</span><span>
</span><a name="line-110"></a><span class="hs-keyword">data</span><span> </span><a name="Pnum"><a href="Aedifico.html#Pnum"><span class="hs-identifier">Pnum</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-111"></a><span>      </span><a name="PCc"><a href="Aedifico.html#PCc"><span class="hs-identifier">PCc</span></a></a><span>
</span><a name="line-112"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PCd"><a href="Aedifico.html#PCd"><span class="hs-identifier">PCd</span></a></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PCe"><a href="Aedifico.html#PCe"><span class="hs-identifier">PCe</span></a></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PCf"><a href="Aedifico.html#PCf"><span class="hs-identifier">PCf</span></a></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PCg"><a href="Aedifico.html#PCg"><span class="hs-identifier">PCg</span></a></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PCa"><a href="Aedifico.html#PCa"><span class="hs-identifier">PCa</span></a></a><span>
</span><a name="line-117"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PCb"><a href="Aedifico.html#PCb"><span class="hs-identifier">PCb</span></a></a><span>
</span><a name="line-118"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PCc8"><a href="Aedifico.html#PCc8"><span class="hs-identifier">PCc8</span></a></a><span>  </span><span class="hs-comment">-- ^ C an octave higher</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Rest"><a href="Aedifico.html#Rest"><span class="hs-identifier">Rest</span></a></a><span>
</span><a name="line-120"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | Convert any integer to a 'Pnum'</span><span>
</span><a name="line-123"></a><span class="hs-identifier">toPnum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pnum"><span class="hs-identifier hs-type">Pnum</span></a><span>
</span><a name="line-124"></a><a name="toPnum"><a href="Aedifico.html#toPnum"><span class="hs-identifier">toPnum</span></a></a><span> </span><a name="local-6989586621679032720"><a href="#local-6989586621679032720"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032720"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">7</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | Accidentals</span><span>
</span><a name="line-127"></a><span class="hs-keyword">data</span><span> </span><a name="Accid"><a href="Aedifico.html#Accid"><span class="hs-identifier">Accid</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-128"></a><span>      </span><a name="FlFl"><a href="Aedifico.html#FlFl"><span class="hs-identifier">FlFl</span></a></a><span>      </span><span class="hs-comment">-- ^ double flat</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Fl"><a href="Aedifico.html#Fl"><span class="hs-identifier">Fl</span></a></a><span>        </span><span class="hs-comment">-- ^ flat</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Na"><a href="Aedifico.html#Na"><span class="hs-identifier">Na</span></a></a><span>        </span><span class="hs-comment">-- ^ natural</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Sh"><a href="Aedifico.html#Sh"><span class="hs-identifier">Sh</span></a></a><span>        </span><span class="hs-comment">-- ^ sharp</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ShSh"><a href="Aedifico.html#ShSh"><span class="hs-identifier">ShSh</span></a></a><span>      </span><span class="hs-comment">-- ^ double sharp</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="AccidNil"><a href="Aedifico.html#AccidNil"><span class="hs-identifier">AccidNil</span></a></a><span>  </span><span class="hs-comment">-- ^ when note is a rest</span><span>
</span><a name="line-134"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | Octaves</span><span>
</span><a name="line-137"></a><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- We set octave numbers in the Helmholtz system (middle C = C4); we only need</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- the enum 'OctNil' if the note is a rest.</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- </span><span>
</span><a name="line-141"></a><span class="hs-comment">-- __TODO__ check</span><span>
</span><a name="line-142"></a><span class="hs-keyword">data</span><span> </span><a name="Octave"><a href="Aedifico.html#Octave"><span class="hs-identifier">Octave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="OctNil"><a href="Aedifico.html#OctNil"><span class="hs-identifier">OctNil</span></a></a><span>
</span><a name="line-143"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- | Voices</span><span>
</span><a name="line-146"></a><span class="hs-comment">--</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- The ark always produces four-voice polyphony.</span><span>
</span><a name="line-148"></a><span class="hs-keyword">data</span><span> </span><a name="VoiceName"><a href="Aedifico.html#VoiceName"><span class="hs-identifier">VoiceName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Soprano"><a href="Aedifico.html#Soprano"><span class="hs-identifier">Soprano</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Alto"><a href="Aedifico.html#Alto"><span class="hs-identifier">Alto</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Tenor"><a href="Aedifico.html#Tenor"><span class="hs-identifier">Tenor</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Bass"><a href="Aedifico.html#Bass"><span class="hs-identifier">Bass</span></a></a><span>
</span><a name="line-149"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Aedifico.html#VoiceName"><span class="hs-identifier hs-type">VoiceName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-152"></a><span>    </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><a href="Aedifico.html#Soprano"><span class="hs-identifier hs-var">Soprano</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Soprano&quot;</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="Aedifico.html#Alto"><span class="hs-identifier hs-var">Alto</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Alto&quot;</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="Aedifico.html#Tenor"><span class="hs-identifier hs-var">Tenor</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Tenor&quot;</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="Aedifico.html#Bass"><span class="hs-identifier hs-var">Bass</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Bass&quot;</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- | Vocal Ranges</span><span>
</span><a name="line-158"></a><span class="hs-keyword">type</span><span> </span><a name="VoiceRanges"><a href="Aedifico.html#VoiceRanges"><span class="hs-identifier">VoiceRanges</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- | Duration values</span><span>
</span><a name="line-161"></a><span class="hs-comment">--</span><span>
</span><a name="line-162"></a><span class="hs-comment">-- We use the mensural names; first the base values, then dotted variants,</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- then a series marked as rest values.</span><span>
</span><a name="line-164"></a><span class="hs-keyword">data</span><span> </span><a name="Dur"><a href="Aedifico.html#Dur"><span class="hs-identifier">Dur</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-165"></a><span>      </span><a name="DurNil"><a href="Aedifico.html#DurNil"><span class="hs-identifier">DurNil</span></a></a><span> </span><span class="hs-comment">-- ^ unset</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Lg"><a href="Aedifico.html#Lg"><span class="hs-identifier">Lg</span></a></a><span>    </span><span class="hs-comment">-- ^ longa</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Br"><a href="Aedifico.html#Br"><span class="hs-identifier">Br</span></a></a><span>    </span><span class="hs-comment">-- ^ breve</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Sb"><a href="Aedifico.html#Sb"><span class="hs-identifier">Sb</span></a></a><span>    </span><span class="hs-comment">-- ^ semibreve </span><span>
</span><a name="line-169"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Mn"><a href="Aedifico.html#Mn"><span class="hs-identifier">Mn</span></a></a><span>    </span><span class="hs-comment">-- ^ minim</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Sm"><a href="Aedifico.html#Sm"><span class="hs-identifier">Sm</span></a></a><span>    </span><span class="hs-comment">-- ^ semiminim</span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Fs"><a href="Aedifico.html#Fs"><span class="hs-identifier">Fs</span></a></a><span>    </span><span class="hs-comment">-- ^ fusa</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LgD"><a href="Aedifico.html#LgD"><span class="hs-identifier">LgD</span></a></a><span>   </span><span class="hs-comment">-- ^ dotted longa</span><span>
</span><a name="line-173"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="BrD"><a href="Aedifico.html#BrD"><span class="hs-identifier">BrD</span></a></a><span>   </span><span class="hs-comment">-- ^ dotted breve</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="SbD"><a href="Aedifico.html#SbD"><span class="hs-identifier">SbD</span></a></a><span>   </span><span class="hs-comment">-- ^ dotted semibreve</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="MnD"><a href="Aedifico.html#MnD"><span class="hs-identifier">MnD</span></a></a><span>   </span><span class="hs-comment">-- ^ dotted minim</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="SmD"><a href="Aedifico.html#SmD"><span class="hs-identifier">SmD</span></a></a><span>   </span><span class="hs-comment">-- ^ dotted semiminim</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="FsD"><a href="Aedifico.html#FsD"><span class="hs-identifier">FsD</span></a></a><span>   </span><span class="hs-comment">-- ^ dotted fusa</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LgR"><a href="Aedifico.html#LgR"><span class="hs-identifier">LgR</span></a></a><span>   </span><span class="hs-comment">-- ^ longa rest</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="BrR"><a href="Aedifico.html#BrR"><span class="hs-identifier">BrR</span></a></a><span>   </span><span class="hs-comment">-- ^ breve rest</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="SbR"><a href="Aedifico.html#SbR"><span class="hs-identifier">SbR</span></a></a><span>   </span><span class="hs-comment">-- ^ semibreve rest</span><span>
</span><a name="line-181"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="MnR"><a href="Aedifico.html#MnR"><span class="hs-identifier">MnR</span></a></a><span>   </span><span class="hs-comment">-- ^ minim rest</span><span>
</span><a name="line-182"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="SmR"><a href="Aedifico.html#SmR"><span class="hs-identifier">SmR</span></a></a><span>   </span><span class="hs-comment">-- ^ semiminim rest</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="FsR"><a href="Aedifico.html#FsR"><span class="hs-identifier">FsR</span></a></a><span>   </span><span class="hs-comment">-- ^ fusa rest</span><span>
</span><a name="line-184"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-comment">-- | How should the accidental be displayed? (Needed for MEI)</span><span>
</span><a name="line-187"></a><span class="hs-keyword">data</span><span> </span><a name="AccidType"><a href="Aedifico.html#AccidType"><span class="hs-identifier">AccidType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="None"><a href="Aedifico.html#None"><span class="hs-identifier">None</span></a></a><span>       </span><span class="hs-comment">-- ^ No accidental</span><span>
</span><a name="line-188"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Written"><a href="Aedifico.html#Written"><span class="hs-identifier">Written</span></a></a><span>    </span><span class="hs-comment">-- ^ MEI accid </span><span>
</span><a name="line-189"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Implicit"><a href="Aedifico.html#Implicit"><span class="hs-identifier">Implicit</span></a></a><span>   </span><span class="hs-comment">-- ^ MEI accid.ges</span><span>
</span><a name="line-190"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Suggested"><a href="Aedifico.html#Suggested"><span class="hs-identifier">Suggested</span></a></a><span>  </span><span class="hs-comment">-- ^ MEI accid + func=&quot;edit&quot;</span><span>
</span><a name="line-191"></a><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-comment">-- | A 'Pitch' stores the essential information for notating a single note.</span><span>
</span><a name="line-195"></a><span class="hs-keyword">data</span><span> </span><a name="Pitch"><a href="Aedifico.html#Pitch"><span class="hs-identifier">Pitch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Pitch"><a href="Aedifico.html#Pitch"><span class="hs-identifier">Pitch</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-196"></a><span>    </span><a name="pnum"><a href="Aedifico.html#pnum"><span class="hs-identifier">pnum</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Pnum"><span class="hs-identifier hs-type">Pnum</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- ^ Enum for diatonic pitch number</span><span>
</span><a name="line-197"></a><span>    </span><a name="oct"><a href="Aedifico.html#oct"><span class="hs-identifier">oct</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- ^ Helmholtz system, middle C = 4</span><span>
</span><a name="line-198"></a><span>    </span><a name="dur"><a href="Aedifico.html#dur"><span class="hs-identifier">dur</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- ^ Duration, one of @Dur@ enum</span><span>
</span><a name="line-199"></a><span>    </span><a name="accid"><a href="Aedifico.html#accid"><span class="hs-identifier">accid</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Accid"><span class="hs-identifier hs-type">Accid</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- ^ Accidental</span><span>
</span><a name="line-200"></a><span>    </span><a name="accidType"><a href="Aedifico.html#accidType"><span class="hs-identifier">accidType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#AccidType"><span class="hs-identifier hs-type">AccidType</span></a><span>  </span><span class="hs-comment">-- ^ Type of accidental for display</span><span>
</span><a name="line-201"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">-- | Make a pitch with only 'pnum' and octave, no duration or accidental</span><span>
</span><a name="line-204"></a><span class="hs-identifier">simplePitch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#Pnum"><span class="hs-identifier hs-type">Pnum</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Pitch enum and Helmholtz octave number</span><span>
</span><a name="line-205"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span>
</span><a name="line-206"></a><a name="simplePitch"><a href="Aedifico.html#simplePitch"><span class="hs-identifier">simplePitch</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033238"><a href="#local-6989586621679033238"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679033239"><a href="#local-6989586621679033239"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#Pitch"><span class="hs-identifier hs-var">Pitch</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-207"></a><span>    </span><span class="hs-identifier">pnum</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033238"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-identifier">oct</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033239"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">,</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-identifier">dur</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#DurNil"><span class="hs-identifier hs-var">DurNil</span></a><span class="hs-special">,</span><span>
</span><a name="line-210"></a><span>    </span><span class="hs-identifier">accid</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#Na"><span class="hs-identifier hs-var">Na</span></a><span class="hs-special">,</span><span>
</span><a name="line-211"></a><span>    </span><span class="hs-identifier">accidType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-212"></a><span class="hs-special">}</span><span>
</span><a name="line-213"></a><span class="hs-comment">-- *** Metrical Systems</span><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-comment">-- | Kircher only seems to allow for duple (not making distinction between C and</span><span>
</span><a name="line-216"></a><span class="hs-comment">-- cut C), cut C 3 (triple major) and C3 (triple minor).</span><span>
</span><a name="line-217"></a><span class="hs-comment">--</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- __TODO__ Should we distinguish between C and cut C duple?</span><span>
</span><a name="line-219"></a><span class="hs-keyword">data</span><span> </span><a name="MusicMeter"><a href="Aedifico.html#MusicMeter"><span class="hs-identifier">MusicMeter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Duple"><a href="Aedifico.html#Duple"><span class="hs-identifier">Duple</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TripleMajor"><a href="Aedifico.html#TripleMajor"><span class="hs-identifier">TripleMajor</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TripleMinor"><a href="Aedifico.html#TripleMinor"><span class="hs-identifier">TripleMinor</span></a></a><span>
</span><a name="line-220"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-223"></a><span>    </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679031335"><a href="#local-6989586621679031335"><span class="hs-identifier">meter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679031335"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-224"></a><span>        </span><a href="Aedifico.html#Duple"><span class="hs-identifier hs-var">Duple</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;Duple&quot;</span><span>
</span><a name="line-225"></a><span>        </span><a href="Aedifico.html#TripleMajor"><span class="hs-identifier hs-var">TripleMajor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;TripleMajor&quot;</span><span>
</span><a name="line-226"></a><span>        </span><a href="Aedifico.html#TripleMinor"><span class="hs-identifier hs-var">TripleMinor</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;TripleMinor&quot;</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-comment">-- | Select meter by string</span><span>
</span><a name="line-229"></a><span class="hs-identifier">toMusicMeter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span>
</span><a name="line-230"></a><a name="toMusicMeter"><a href="Aedifico.html#toMusicMeter"><span class="hs-identifier">toMusicMeter</span></a></a><span> </span><a name="local-6989586621679033240"><a href="#local-6989586621679033240"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033240"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-231"></a><span>    </span><span class="hs-string">&quot;Duple&quot;</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Duple"><span class="hs-identifier hs-var">Duple</span></a><span>
</span><a name="line-232"></a><span>    </span><span class="hs-string">&quot;TripleMajor&quot;</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#TripleMajor"><span class="hs-identifier hs-var">TripleMajor</span></a><span>
</span><a name="line-233"></a><span>    </span><span class="hs-string">&quot;TripleMinor&quot;</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#TripleMinor"><span class="hs-identifier hs-var">TripleMinor</span></a><span>
</span><a name="line-234"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;bad meter&quot;</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-comment">-- *** Textual/poetic meter</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- | Text meter (of input text, distinguished from musical meter of setting)</span><span>
</span><a name="line-239"></a><span class="hs-keyword">data</span><span> </span><a name="TextMeter"><a href="Aedifico.html#TextMeter"><span class="hs-identifier">TextMeter</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-240"></a><span>      </span><a name="TextMeterNil"><a href="Aedifico.html#TextMeterNil"><span class="hs-identifier">TextMeterNil</span></a></a><span>
</span><a name="line-241"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Prose"><a href="Aedifico.html#Prose"><span class="hs-identifier">Prose</span></a></a><span>                         </span><span class="hs-comment">-- ^ No meter, free, or irregular</span><span>
</span><a name="line-242"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ProseLong"><a href="Aedifico.html#ProseLong"><span class="hs-identifier">ProseLong</span></a></a><span>                     </span><span class="hs-comment">-- ^ Prose, 2-6 syllabels, penultimate is long</span><span>
</span><a name="line-243"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ProseShort"><a href="Aedifico.html#ProseShort"><span class="hs-identifier">ProseShort</span></a></a><span>                    </span><span class="hs-comment">-- ^ Prose, 2-6 syllables, penultimate is short</span><span>
</span><a name="line-244"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Adonium"><a href="Aedifico.html#Adonium"><span class="hs-identifier">Adonium</span></a></a><span>                       </span><span class="hs-comment">-- ^ 5  syllables (@`--`-@)</span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Dactylicum"><a href="Aedifico.html#Dactylicum"><span class="hs-identifier">Dactylicum</span></a></a><span>                    </span><span class="hs-comment">-- ^ 6  syllables (@`--`--@)</span><span>
</span><a name="line-246"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="IambicumEuripidaeum"><a href="Aedifico.html#IambicumEuripidaeum"><span class="hs-identifier">IambicumEuripidaeum</span></a></a><span>           </span><span class="hs-comment">-- ^ 6  syllables (@`-`-`-@)</span><span>
</span><a name="line-247"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Anacreonticum"><a href="Aedifico.html#Anacreonticum"><span class="hs-identifier">Anacreonticum</span></a></a><span>                 </span><span class="hs-comment">-- ^ 7  syllables, penultimate long </span><span>
</span><a name="line-248"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="IambicumArchilochicum"><a href="Aedifico.html#IambicumArchilochicum"><span class="hs-identifier">IambicumArchilochicum</span></a></a><span>         </span><span class="hs-comment">-- ^ 8  syllables, penultimate short</span><span>
</span><a name="line-249"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="IambicumEnneasyllabicum"><a href="Aedifico.html#IambicumEnneasyllabicum"><span class="hs-identifier">IambicumEnneasyllabicum</span></a></a><span>       </span><span class="hs-comment">-- ^ 9  syllables, penultimate long</span><span>
</span><a name="line-250"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Enneasyllabicum"><a href="Aedifico.html#Enneasyllabicum"><span class="hs-identifier">Enneasyllabicum</span></a></a><span>               </span><span class="hs-comment">-- ^ 9  syllables (generic)</span><span>
</span><a name="line-251"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Decasyllabicum"><a href="Aedifico.html#Decasyllabicum"><span class="hs-identifier">Decasyllabicum</span></a></a><span>                </span><span class="hs-comment">-- ^ 10 syllables, penultimate short</span><span>
</span><a name="line-252"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PhaleuciumHendecasyllabicum"><a href="Aedifico.html#PhaleuciumHendecasyllabicum"><span class="hs-identifier">PhaleuciumHendecasyllabicum</span></a></a><span>   </span><span class="hs-comment">-- ^ 11 syllables</span><span>
</span><a name="line-253"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Hendecasyllabicum"><a href="Aedifico.html#Hendecasyllabicum"><span class="hs-identifier">Hendecasyllabicum</span></a></a><span>             </span><span class="hs-comment">-- ^ 11 syllables (generic)</span><span>
</span><a name="line-254"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Sapphicum"><a href="Aedifico.html#Sapphicum"><span class="hs-identifier">Sapphicum</span></a></a><span>                     </span><span class="hs-comment">-- ^ 11 syllables, three lines + 5-syllable tag</span><span>
</span><a name="line-255"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Dodecasyllabicum"><a href="Aedifico.html#Dodecasyllabicum"><span class="hs-identifier">Dodecasyllabicum</span></a></a><span>              </span><span class="hs-comment">-- ^ 12 syllables, penultimate short</span><span>
</span><a name="line-256"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">-- | Select text meter by string</span><span>
</span><a name="line-259"></a><span class="hs-identifier">toTextMeter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#TextMeter"><span class="hs-identifier hs-type">TextMeter</span></a><span>
</span><a name="line-260"></a><a name="toTextMeter"><a href="Aedifico.html#toTextMeter"><span class="hs-identifier">toTextMeter</span></a></a><span> </span><a name="local-6989586621679033255"><a href="#local-6989586621679033255"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033255"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-261"></a><span>    </span><span class="hs-string">&quot;Prose&quot;</span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Prose"><span class="hs-identifier hs-var">Prose</span></a><span>
</span><a name="line-262"></a><span>    </span><span class="hs-string">&quot;ProseLong&quot;</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ProseLong"><span class="hs-identifier hs-var">ProseLong</span></a><span>
</span><a name="line-263"></a><span>    </span><span class="hs-string">&quot;ProseShort&quot;</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ProseShort"><span class="hs-identifier hs-var">ProseShort</span></a><span>
</span><a name="line-264"></a><span>    </span><span class="hs-string">&quot;Adonium&quot;</span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Adonium"><span class="hs-identifier hs-var">Adonium</span></a><span>
</span><a name="line-265"></a><span>    </span><span class="hs-string">&quot;Dactylicum&quot;</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Dactylicum"><span class="hs-identifier hs-var">Dactylicum</span></a><span>
</span><a name="line-266"></a><span>    </span><span class="hs-string">&quot;IambicumEuripidaeum&quot;</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#IambicumEuripidaeum"><span class="hs-identifier hs-var">IambicumEuripidaeum</span></a><span>
</span><a name="line-267"></a><span>    </span><span class="hs-string">&quot;Anacreonticum&quot;</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Anacreonticum"><span class="hs-identifier hs-var">Anacreonticum</span></a><span>
</span><a name="line-268"></a><span>    </span><span class="hs-string">&quot;IambicumArchilochicum&quot;</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#IambicumArchilochicum"><span class="hs-identifier hs-var">IambicumArchilochicum</span></a><span>
</span><a name="line-269"></a><span>    </span><span class="hs-string">&quot;IambicumEnneasyllabicum&quot;</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#IambicumEnneasyllabicum"><span class="hs-identifier hs-var">IambicumEnneasyllabicum</span></a><span>
</span><a name="line-270"></a><span>    </span><span class="hs-string">&quot;Enneasyllabicum&quot;</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Enneasyllabicum"><span class="hs-identifier hs-var">Enneasyllabicum</span></a><span>
</span><a name="line-271"></a><span>    </span><span class="hs-string">&quot;Decasyllabicum&quot;</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Decasyllabicum"><span class="hs-identifier hs-var">Decasyllabicum</span></a><span>
</span><a name="line-272"></a><span>    </span><span class="hs-string">&quot;PhaleuciumHendecasyllabicum&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#PhaleuciumHendecasyllabicum"><span class="hs-identifier hs-var">PhaleuciumHendecasyllabicum</span></a><span>
</span><a name="line-273"></a><span>    </span><span class="hs-string">&quot;Hendecasyllabicum&quot;</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Hendecasyllabicum"><span class="hs-identifier hs-var">Hendecasyllabicum</span></a><span>
</span><a name="line-274"></a><span>    </span><span class="hs-string">&quot;Sapphicum&quot;</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Sapphicum"><span class="hs-identifier hs-var">Sapphicum</span></a><span>
</span><a name="line-275"></a><span>    </span><span class="hs-string">&quot;Dodecasyllabicum&quot;</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Dodecasyllabicum"><span class="hs-identifier hs-var">Dodecasyllabicum</span></a><span>
</span><a name="line-276"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Unknown textmeter&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679033255"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-comment">-- | Get maximum number of syllables for a TextMeter</span><span>
</span><a name="line-279"></a><span class="hs-identifier">maxSyllables</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#TextMeter"><span class="hs-identifier hs-type">TextMeter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-280"></a><a name="maxSyllables"><a href="Aedifico.html#maxSyllables"><span class="hs-identifier">maxSyllables</span></a></a><span> </span><a name="local-6989586621679033412"><a href="#local-6989586621679033412"><span class="hs-identifier">meter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033412"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-281"></a><span>    </span><a href="Aedifico.html#Prose"><span class="hs-identifier hs-var">Prose</span></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">6</span><span>
</span><a name="line-282"></a><span>    </span><a href="Aedifico.html#Adonium"><span class="hs-identifier hs-var">Adonium</span></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">5</span><span>
</span><a name="line-283"></a><span>    </span><a href="Aedifico.html#Dactylicum"><span class="hs-identifier hs-var">Dactylicum</span></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">6</span><span>
</span><a name="line-284"></a><span>    </span><a href="Aedifico.html#IambicumEuripidaeum"><span class="hs-identifier hs-var">IambicumEuripidaeum</span></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">6</span><span>
</span><a name="line-285"></a><span>    </span><a href="Aedifico.html#Anacreonticum"><span class="hs-identifier hs-var">Anacreonticum</span></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">7</span><span>
</span><a name="line-286"></a><span>    </span><a href="Aedifico.html#IambicumArchilochicum"><span class="hs-identifier hs-var">IambicumArchilochicum</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-287"></a><span>    </span><a href="Aedifico.html#IambicumEnneasyllabicum"><span class="hs-identifier hs-var">IambicumEnneasyllabicum</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">9</span><span>
</span><a name="line-288"></a><span>    </span><a href="Aedifico.html#Enneasyllabicum"><span class="hs-identifier hs-var">Enneasyllabicum</span></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">9</span><span>
</span><a name="line-289"></a><span>    </span><a href="Aedifico.html#Decasyllabicum"><span class="hs-identifier hs-var">Decasyllabicum</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">10</span><span>
</span><a name="line-290"></a><span>    </span><a href="Aedifico.html#PhaleuciumHendecasyllabicum"><span class="hs-identifier hs-var">PhaleuciumHendecasyllabicum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">11</span><span>
</span><a name="line-291"></a><span>    </span><a href="Aedifico.html#Hendecasyllabicum"><span class="hs-identifier hs-var">Hendecasyllabicum</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">11</span><span>
</span><a name="line-292"></a><span>    </span><a href="Aedifico.html#Sapphicum"><span class="hs-identifier hs-var">Sapphicum</span></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">11</span><span>
</span><a name="line-293"></a><span>    </span><a href="Aedifico.html#Dodecasyllabicum"><span class="hs-identifier hs-var">Dodecasyllabicum</span></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">12</span><span>
</span><a name="line-294"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;bad meter&quot;</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-comment">-- *** Style</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-comment">-- | The choice of style determines which of Kircher's three /syntagmata/ we</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- select. 'Simple' style calls up Syntagma 1 for simple, note-against-note (first-species) homorhythmic counterpoint. 'Florid' style calls up Syntagma 2 for syllabic, imitative, and even in some permutations fugal counterpoint. </span><span>
</span><a name="line-301"></a><span class="hs-comment">--</span><span>
</span><a name="line-302"></a><span class="hs-comment">-- __TODO__ There is also a third syntagma, for adding rhetorical figures to</span><span>
</span><a name="line-303"></a><span class="hs-comment">-- simple counterpoint for more nuanced text-setting. We have not yet</span><span>
</span><a name="line-304"></a><span class="hs-comment">-- implemented this, and do not know if it can be fully automated.</span><span>
</span><a name="line-305"></a><span class="hs-keyword">data</span><span> </span><a name="Style"><a href="Aedifico.html#Style"><span class="hs-identifier">Style</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a name="Simple"><a href="Aedifico.html#Simple"><span class="hs-identifier">Simple</span></a></a><span> </span><span class="hs-comment">-- ^ Syllabic, homorhythmic counterpoint (syntagma 1)</span><span>
</span><a name="line-306"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="Florid"><a href="Aedifico.html#Florid"><span class="hs-identifier">Florid</span></a></a><span> </span><span class="hs-comment">-- ^ Melismatic, imitative counterpoint (syntagma 2)</span><span>
</span><a name="line-307"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span class="hs-comment">-- | Select style by string (used in processing XML input)</span><span>
</span><a name="line-310"></a><span class="hs-identifier">toStyle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ &quot;Simple&quot; or &quot;Florid&quot; </span><span>
</span><a name="line-311"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Style"><span class="hs-identifier hs-type">Style</span></a><span>
</span><a name="line-312"></a><a name="toStyle"><a href="Aedifico.html#toStyle"><span class="hs-identifier">toStyle</span></a></a><span> </span><a name="local-6989586621679033413"><a href="#local-6989586621679033413"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033413"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-313"></a><span>    </span><span class="hs-string">&quot;Simple&quot;</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Simple"><span class="hs-identifier hs-var">Simple</span></a><span>
</span><a name="line-314"></a><span>    </span><span class="hs-string">&quot;Florid&quot;</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Florid"><span class="hs-identifier hs-var">Florid</span></a><span>
</span><a name="line-315"></a><span>    </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Unknown style&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679033413"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-comment">-- | Mode</span><span>
</span><a name="line-318"></a><span class="hs-comment">--</span><span>
</span><a name="line-319"></a><span class="hs-comment">-- Kircher's table of modes is different from the traditional chant modes.</span><span>
</span><a name="line-320"></a><span class="hs-comment">-- They are more like &quot;church keys&quot; or /toni/ for psalm intonations.</span><span>
</span><a name="line-321"></a><span class="hs-keyword">data</span><span> </span><a name="Mode"><a href="Aedifico.html#Mode"><span class="hs-identifier">Mode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Mode1"><a href="Aedifico.html#Mode1"><span class="hs-identifier">Mode1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode2"><a href="Aedifico.html#Mode2"><span class="hs-identifier">Mode2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode3"><a href="Aedifico.html#Mode3"><span class="hs-identifier">Mode3</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode4"><a href="Aedifico.html#Mode4"><span class="hs-identifier">Mode4</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode5"><a href="Aedifico.html#Mode5"><span class="hs-identifier">Mode5</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode6"><a href="Aedifico.html#Mode6"><span class="hs-identifier">Mode6</span></a></a><span>
</span><a name="line-322"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="Mode7"><a href="Aedifico.html#Mode7"><span class="hs-identifier">Mode7</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode8"><a href="Aedifico.html#Mode8"><span class="hs-identifier">Mode8</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode9"><a href="Aedifico.html#Mode9"><span class="hs-identifier">Mode9</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode10"><a href="Aedifico.html#Mode10"><span class="hs-identifier">Mode10</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode11"><a href="Aedifico.html#Mode11"><span class="hs-identifier">Mode11</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mode12"><a href="Aedifico.html#Mode12"><span class="hs-identifier">Mode12</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ModeUnset"><a href="Aedifico.html#ModeUnset"><span class="hs-identifier">ModeUnset</span></a></a><span>
</span><a name="line-323"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-comment">-- | Select mode by string (e.g., &quot;Mode1&quot; or &quot;Mode12&quot; in XML input)</span><span>
</span><a name="line-326"></a><span class="hs-identifier">toMode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span>
</span><a name="line-327"></a><a name="toMode"><a href="Aedifico.html#toMode"><span class="hs-identifier">toMode</span></a></a><span> </span><a name="local-6989586621679033414"><a href="#local-6989586621679033414"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033414"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-328"></a><span>    </span><span class="hs-string">&quot;Mode1&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode1"><span class="hs-identifier hs-var">Mode1</span></a><span>
</span><a name="line-329"></a><span>    </span><span class="hs-string">&quot;Mode2&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode2"><span class="hs-identifier hs-var">Mode2</span></a><span>
</span><a name="line-330"></a><span>    </span><span class="hs-string">&quot;Mode3&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode3"><span class="hs-identifier hs-var">Mode3</span></a><span>
</span><a name="line-331"></a><span>    </span><span class="hs-string">&quot;Mode4&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode4"><span class="hs-identifier hs-var">Mode4</span></a><span>
</span><a name="line-332"></a><span>    </span><span class="hs-string">&quot;Mode5&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode5"><span class="hs-identifier hs-var">Mode5</span></a><span>
</span><a name="line-333"></a><span>    </span><span class="hs-string">&quot;Mode6&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode6"><span class="hs-identifier hs-var">Mode6</span></a><span>
</span><a name="line-334"></a><span>    </span><span class="hs-string">&quot;Mode7&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode7"><span class="hs-identifier hs-var">Mode7</span></a><span>
</span><a name="line-335"></a><span>    </span><span class="hs-string">&quot;Mode8&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode8"><span class="hs-identifier hs-var">Mode8</span></a><span>
</span><a name="line-336"></a><span>    </span><span class="hs-string">&quot;Mode9&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode9"><span class="hs-identifier hs-var">Mode9</span></a><span>
</span><a name="line-337"></a><span>    </span><span class="hs-string">&quot;Mode10&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode10"><span class="hs-identifier hs-var">Mode10</span></a><span>
</span><a name="line-338"></a><span>    </span><span class="hs-string">&quot;Mode11&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode11"><span class="hs-identifier hs-var">Mode11</span></a><span>
</span><a name="line-339"></a><span>    </span><span class="hs-string">&quot;Mode12&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode12"><span class="hs-identifier hs-var">Mode12</span></a><span>
</span><a name="line-340"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Unknown mode&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679033414"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-- ** Kircher's table with the mode systems and mode notes, on the lid of the</span><span>
</span><a name="line-343"></a><span class="hs-comment">-- arca. We include this in the main `Arca`.  </span><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-comment">-- | Mode system, /durus/ (natural)</span><span>
</span><a name="line-346"></a><span class="hs-comment">-- or /mollis/ (one flat in the key signature)</span><span>
</span><a name="line-347"></a><span class="hs-keyword">data</span><span> </span><a name="System"><a href="Aedifico.html#System"><span class="hs-identifier">System</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Durus"><a href="Aedifico.html#Durus"><span class="hs-identifier">Durus</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mollis"><a href="Aedifico.html#Mollis"><span class="hs-identifier">Mollis</span></a></a><span>
</span><a name="line-348"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-comment">-- | The series of 'System' values for the modes</span><span>
</span><a name="line-351"></a><span class="hs-keyword">type</span><span> </span><a name="ModeSystem"><a href="Aedifico.html#ModeSystem"><span class="hs-identifier">ModeSystem</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#System"><span class="hs-identifier hs-type">System</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span class="hs-comment">-- | Combination 'Pnum' and 'Accid' used to set a Pitch</span><span>
</span><a name="line-354"></a><span class="hs-keyword">type</span><span> </span><a name="PnumAccid"><a href="Aedifico.html#PnumAccid"><span class="hs-identifier">PnumAccid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#Pnum"><span class="hs-identifier hs-type">Pnum</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Accid"><span class="hs-identifier hs-type">Accid</span></a><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-comment">-- | A list of scales, including some notes with accidentals, from Kircher </span><span>
</span><a name="line-357"></a><span class="hs-keyword">type</span><span> </span><a name="ModeList"><a href="Aedifico.html#ModeList"><span class="hs-identifier">ModeList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="Aedifico.html#PnumAccid"><span class="hs-identifier hs-type">PnumAccid</span></a><span class="hs-special">)</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-comment">-- | List of modes appropriate for each pinax within each syntagma (style)</span><span>
</span><a name="line-360"></a><span class="hs-keyword">type</span><span> </span><a name="PinaxModeList"><a href="Aedifico.html#PinaxModeList"><span class="hs-identifier">PinaxModeList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Aedifico.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-comment">-- TODO Kircher's mode mixtures for each</span><span>
</span><a name="line-363"></a><span class="hs-comment">-- TODO Kircher's mood/character for each</span><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-comment">-- | Penultimate Syllable Length</span><span>
</span><a name="line-367"></a><span class="hs-comment">--</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- Every unit of text to be set to music must be marked with either a long or</span><span>
</span><a name="line-369"></a><span class="hs-comment">-- short penultimate syllable.</span><span>
</span><a name="line-370"></a><span class="hs-keyword">data</span><span> </span><a name="PenultLength"><a href="Aedifico.html#PenultLength"><span class="hs-identifier">PenultLength</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Long"><a href="Aedifico.html#Long"><span class="hs-identifier">Long</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Short"><a href="Aedifico.html#Short"><span class="hs-identifier">Short</span></a></a><span>
</span><a name="line-371"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span class="hs-comment">-- | 'Pinax' maps to 'TextMeter'</span><span>
</span><a name="line-374"></a><span class="hs-keyword">data</span><span> </span><a name="PinaxLabel"><a href="Aedifico.html#PinaxLabel"><span class="hs-identifier">PinaxLabel</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-375"></a><span>      </span><a name="Pinax1"><a href="Aedifico.html#Pinax1"><span class="hs-identifier">Pinax1</span></a></a><span>
</span><a name="line-376"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax2"><a href="Aedifico.html#Pinax2"><span class="hs-identifier">Pinax2</span></a></a><span>
</span><a name="line-377"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax3"><a href="Aedifico.html#Pinax3"><span class="hs-identifier">Pinax3</span></a></a><span>
</span><a name="line-378"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax4"><a href="Aedifico.html#Pinax4"><span class="hs-identifier">Pinax4</span></a></a><span>
</span><a name="line-379"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax5"><a href="Aedifico.html#Pinax5"><span class="hs-identifier">Pinax5</span></a></a><span>
</span><a name="line-380"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax6"><a href="Aedifico.html#Pinax6"><span class="hs-identifier">Pinax6</span></a></a><span>
</span><a name="line-381"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax7"><a href="Aedifico.html#Pinax7"><span class="hs-identifier">Pinax7</span></a></a><span>
</span><a name="line-382"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax8"><a href="Aedifico.html#Pinax8"><span class="hs-identifier">Pinax8</span></a></a><span>
</span><a name="line-383"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax9"><a href="Aedifico.html#Pinax9"><span class="hs-identifier">Pinax9</span></a></a><span>
</span><a name="line-384"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax10"><a href="Aedifico.html#Pinax10"><span class="hs-identifier">Pinax10</span></a></a><span>
</span><a name="line-385"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Pinax11"><a href="Aedifico.html#Pinax11"><span class="hs-identifier">Pinax11</span></a></a><span>
</span><a name="line-386"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PinaxNil"><a href="Aedifico.html#PinaxNil"><span class="hs-identifier">PinaxNil</span></a></a><span>
</span><a name="line-387"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span class="hs-comment">-- | Get pinax from textual meter; this depends on the 'Style' because the</span><span>
</span><a name="line-390"></a><span class="hs-comment">-- /syntagmata/ differ in the order of meters, so 'IambicumEuripidaeum' meter</span><span>
</span><a name="line-391"></a><span class="hs-comment">-- in Syntagma 1 is 'Pinax3', but in Syntagma 2 it is 'Pinax2'.</span><span>
</span><a name="line-392"></a><span class="hs-identifier">meter2pinax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Style"><span class="hs-identifier hs-type">Style</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#TextMeter"><span class="hs-identifier hs-type">TextMeter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#PinaxLabel"><span class="hs-identifier hs-type">PinaxLabel</span></a><span>
</span><a name="line-393"></a><a name="meter2pinax"><a href="Aedifico.html#meter2pinax"><span class="hs-identifier">meter2pinax</span></a></a><span> </span><a name="local-6989586621679033415"><a href="#local-6989586621679033415"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679033416"><a href="#local-6989586621679033416"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033415"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-394"></a><span>        </span><a href="Aedifico.html#Simple"><span class="hs-identifier hs-var">Simple</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679033417"><span class="hs-identifier hs-var">meter2pinaxSimple</span></a><span> </span><a href="#local-6989586621679033416"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-395"></a><span>        </span><a href="Aedifico.html#Florid"><span class="hs-identifier hs-var">Florid</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679033418"><span class="hs-identifier hs-var">meter2pinaxFlorid</span></a><span> </span><a href="#local-6989586621679033416"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-398"></a><span>            </span><a name="local-6989586621679033417"><a href="#local-6989586621679033417"><span class="hs-identifier">meter2pinaxSimple</span></a></a><span> </span><a name="local-6989586621679033419"><a href="#local-6989586621679033419"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033419"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-399"></a><span>                </span><a href="Aedifico.html#Prose"><span class="hs-identifier hs-var">Prose</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Need to determine ProseShort or ProseLong&quot;</span><span>
</span><a name="line-400"></a><span>                </span><a href="Aedifico.html#ProseLong"><span class="hs-identifier hs-var">ProseLong</span></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax1"><span class="hs-identifier hs-var">Pinax1</span></a><span>
</span><a name="line-401"></a><span>                </span><a href="Aedifico.html#ProseShort"><span class="hs-identifier hs-var">ProseShort</span></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax2"><span class="hs-identifier hs-var">Pinax2</span></a><span>
</span><a name="line-402"></a><span>                </span><a href="Aedifico.html#Adonium"><span class="hs-identifier hs-var">Adonium</span></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax3"><span class="hs-identifier hs-var">Pinax3</span></a><span>
</span><a name="line-403"></a><span>                </span><a href="Aedifico.html#Dactylicum"><span class="hs-identifier hs-var">Dactylicum</span></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax3"><span class="hs-identifier hs-var">Pinax3</span></a><span>
</span><a name="line-404"></a><span>                </span><a href="Aedifico.html#IambicumEuripidaeum"><span class="hs-identifier hs-var">IambicumEuripidaeum</span></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax4"><span class="hs-identifier hs-var">Pinax4</span></a><span>
</span><a name="line-405"></a><span>                </span><a href="Aedifico.html#Anacreonticum"><span class="hs-identifier hs-var">Anacreonticum</span></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax5"><span class="hs-identifier hs-var">Pinax5</span></a><span>
</span><a name="line-406"></a><span>                </span><a href="Aedifico.html#IambicumArchilochicum"><span class="hs-identifier hs-var">IambicumArchilochicum</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax6"><span class="hs-identifier hs-var">Pinax6</span></a><span>
</span><a name="line-407"></a><span>                </span><a href="Aedifico.html#IambicumEnneasyllabicum"><span class="hs-identifier hs-var">IambicumEnneasyllabicum</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax7"><span class="hs-identifier hs-var">Pinax7</span></a><span>
</span><a name="line-408"></a><span>                </span><a href="Aedifico.html#Enneasyllabicum"><span class="hs-identifier hs-var">Enneasyllabicum</span></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax7"><span class="hs-identifier hs-var">Pinax7</span></a><span>
</span><a name="line-409"></a><span>                </span><a href="Aedifico.html#Decasyllabicum"><span class="hs-identifier hs-var">Decasyllabicum</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax8"><span class="hs-identifier hs-var">Pinax8</span></a><span>
</span><a name="line-410"></a><span>                </span><a href="Aedifico.html#PhaleuciumHendecasyllabicum"><span class="hs-identifier hs-var">PhaleuciumHendecasyllabicum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax9"><span class="hs-identifier hs-var">Pinax9</span></a><span>
</span><a name="line-411"></a><span>                </span><a href="Aedifico.html#Hendecasyllabicum"><span class="hs-identifier hs-var">Hendecasyllabicum</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax9"><span class="hs-identifier hs-var">Pinax9</span></a><span>
</span><a name="line-412"></a><span>                </span><a href="Aedifico.html#Sapphicum"><span class="hs-identifier hs-var">Sapphicum</span></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax10"><span class="hs-identifier hs-var">Pinax10</span></a><span>
</span><a name="line-413"></a><span>                </span><a href="Aedifico.html#Dodecasyllabicum"><span class="hs-identifier hs-var">Dodecasyllabicum</span></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax11"><span class="hs-identifier hs-var">Pinax11</span></a><span>
</span><a name="line-414"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;bad textMeter&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679033419"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span>            </span><a name="local-6989586621679033418"><a href="#local-6989586621679033418"><span class="hs-identifier">meter2pinaxFlorid</span></a></a><span> </span><a name="local-6989586621679033420"><a href="#local-6989586621679033420"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033420"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-417"></a><span>                </span><a href="Aedifico.html#Adonium"><span class="hs-identifier hs-var">Adonium</span></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax1"><span class="hs-identifier hs-var">Pinax1</span></a><span>
</span><a name="line-418"></a><span>                </span><a href="Aedifico.html#Dactylicum"><span class="hs-identifier hs-var">Dactylicum</span></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax1"><span class="hs-identifier hs-var">Pinax1</span></a><span>
</span><a name="line-419"></a><span>                </span><a href="Aedifico.html#IambicumEuripidaeum"><span class="hs-identifier hs-var">IambicumEuripidaeum</span></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax2"><span class="hs-identifier hs-var">Pinax2</span></a><span>
</span><a name="line-420"></a><span>                </span><a href="Aedifico.html#Anacreonticum"><span class="hs-identifier hs-var">Anacreonticum</span></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax3"><span class="hs-identifier hs-var">Pinax3</span></a><span>
</span><a name="line-421"></a><span>                </span><a href="Aedifico.html#IambicumArchilochicum"><span class="hs-identifier hs-var">IambicumArchilochicum</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax4"><span class="hs-identifier hs-var">Pinax4</span></a><span>
</span><a name="line-422"></a><span>                </span><a href="Aedifico.html#IambicumEnneasyllabicum"><span class="hs-identifier hs-var">IambicumEnneasyllabicum</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax5"><span class="hs-identifier hs-var">Pinax5</span></a><span>
</span><a name="line-423"></a><span>                </span><a href="Aedifico.html#Enneasyllabicum"><span class="hs-identifier hs-var">Enneasyllabicum</span></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax5"><span class="hs-identifier hs-var">Pinax5</span></a><span>
</span><a name="line-424"></a><span>                </span><a href="Aedifico.html#Decasyllabicum"><span class="hs-identifier hs-var">Decasyllabicum</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax5"><span class="hs-identifier hs-var">Pinax5</span></a><span>
</span><a name="line-425"></a><span>                </span><a href="Aedifico.html#PhaleuciumHendecasyllabicum"><span class="hs-identifier hs-var">PhaleuciumHendecasyllabicum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax6"><span class="hs-identifier hs-var">Pinax6</span></a><span>
</span><a name="line-426"></a><span>                </span><a href="Aedifico.html#Hendecasyllabicum"><span class="hs-identifier hs-var">Hendecasyllabicum</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax6"><span class="hs-identifier hs-var">Pinax6</span></a><span>
</span><a name="line-427"></a><span>                </span><a href="Aedifico.html#Sapphicum"><span class="hs-identifier hs-var">Sapphicum</span></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax6"><span class="hs-identifier hs-var">Pinax6</span></a><span>
</span><a name="line-428"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;bad textMeter&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679033420"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span class="hs-comment">-- | Is this mode acceptable to use for this pinax in this syntagma, for this</span><span>
</span><a name="line-431"></a><span class="hs-comment">-- line number (&quot;stropha&quot;)?</span><span>
</span><a name="line-432"></a><span class="hs-identifier">isModeLegalInPinax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#PinaxModeList"><span class="hs-identifier hs-type">PinaxModeList</span></a><span> </span><span class="hs-comment">-- ^ list of appropriate modes per pinax</span><span>
</span><a name="line-433"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Style"><span class="hs-identifier hs-type">Style</span></a><span>        </span><span class="hs-comment">-- ^ corresponding to syntagma</span><span>
</span><a name="line-434"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#PinaxLabel"><span class="hs-identifier hs-type">PinaxLabel</span></a><span>   </span><span class="hs-comment">-- ^ pinax enum within syntagma</span><span>
</span><a name="line-435"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ 0-indexed line number (Kircher's &quot;stropha&quot;)</span><span>
</span><a name="line-436"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span>         </span><span class="hs-comment">-- ^ mode enum to check</span><span>
</span><a name="line-437"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-438"></a><a name="isModeLegalInPinax"><a href="Aedifico.html#isModeLegalInPinax"><span class="hs-identifier">isModeLegalInPinax</span></a></a><span> </span><a name="local-6989586621679033421"><a href="#local-6989586621679033421"><span class="hs-identifier">pinaxModes</span></a></a><span> </span><a name="local-6989586621679033422"><a href="#local-6989586621679033422"><span class="hs-identifier">style</span></a></a><span> </span><a name="local-6989586621679033423"><a href="#local-6989586621679033423"><span class="hs-identifier">pinax</span></a></a><span> </span><a name="local-6989586621679033424"><a href="#local-6989586621679033424"><span class="hs-identifier">lineNum</span></a></a><span> </span><a name="local-6989586621679033425"><a href="#local-6989586621679033425"><span class="hs-identifier">mode</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-439"></a><span>    </span><a href="#local-6989586621679033425"><span class="hs-identifier hs-var">mode</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Aedifico.html#ModeUnset"><span class="hs-identifier hs-var">ModeUnset</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679033425"><span class="hs-identifier hs-var">mode</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679033426"><span class="hs-identifier hs-var">modes</span></a><span>
</span><a name="line-440"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-441"></a><span>        </span><a name="local-6989586621679033426"><a href="#local-6989586621679033426"><span class="hs-identifier">modes</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679033427"><span class="hs-identifier hs-var">modeset</span></a><span> </span><a href="Aedifico.html#%21%21%3F"><span class="hs-operator hs-var">!!?</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679033424"><span class="hs-identifier hs-var">lineNum</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679033427"><span class="hs-identifier hs-var">modeset</span></a><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>        </span><a name="local-6989586621679033427"><a href="#local-6989586621679033427"><span class="hs-identifier">modeset</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;isModeLegalInPinax:modeset&quot;</span><span> </span><a href="#local-6989586621679033428"><span class="hs-identifier hs-var">pinakes</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679033423"><span class="hs-identifier hs-var">pinax</span></a><span>
</span><a name="line-443"></a><span>        </span><a name="local-6989586621679033428"><a href="#local-6989586621679033428"><span class="hs-identifier">pinakes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;isModeLegalInPinax:pinakes&quot;</span><span> </span><a href="#local-6989586621679033421"><span class="hs-identifier hs-var">pinaxModes</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679033422"><span class="hs-identifier hs-var">style</span></a><span>
</span><a name="line-444"></a><span>
</span><a name="line-445"></a><span class="hs-comment">-- | In prose, determine 'TextMeter' based on penultimate syllable length</span><span>
</span><a name="line-446"></a><span class="hs-identifier">proseMeter</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#PenultLength"><span class="hs-identifier hs-type">PenultLength</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#TextMeter"><span class="hs-identifier hs-type">TextMeter</span></a><span>
</span><a name="line-447"></a><a name="proseMeter"><a href="Aedifico.html#proseMeter"><span class="hs-identifier">proseMeter</span></a></a><span> </span><a name="local-6989586621679033429"><a href="#local-6989586621679033429"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033429"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-448"></a><span>    </span><a href="Aedifico.html#Long"><span class="hs-identifier hs-var">Long</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ProseLong"><span class="hs-identifier hs-var">ProseLong</span></a><span>
</span><a name="line-449"></a><span>    </span><a href="Aedifico.html#Short"><span class="hs-identifier hs-var">Short</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ProseShort"><span class="hs-identifier hs-var">ProseShort</span></a><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-comment">-- | All the ark settings in one structure: We use this to pass configuration</span><span>
</span><a name="line-452"></a><span class="hs-comment">-- settings through many functions down to the core level of pulling data from</span><span>
</span><a name="line-453"></a><span class="hs-comment">-- the ark.</span><span>
</span><a name="line-454"></a><span class="hs-keyword">data</span><span> </span><a name="ArkConfig"><a href="Aedifico.html#ArkConfig"><span class="hs-identifier">ArkConfig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ArkConfig"><a href="Aedifico.html#ArkConfig"><span class="hs-identifier">ArkConfig</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-455"></a><span>    </span><a name="arkStyle"><a href="Aedifico.html#arkStyle"><span class="hs-identifier">arkStyle</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Style"><span class="hs-identifier hs-type">Style</span></a><span class="hs-special">,</span><span>
</span><a name="line-456"></a><span>    </span><a name="arkMode"><a href="Aedifico.html#arkMode"><span class="hs-identifier">arkMode</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span class="hs-special">,</span><span>
</span><a name="line-457"></a><span>    </span><a name="arkModeB"><a href="Aedifico.html#arkModeB"><span class="hs-identifier">arkModeB</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ optional second mode (only used in syntagma 2, pinax 4)</span><span>
</span><a name="line-458"></a><span>    </span><a name="arkMusicMeter"><a href="Aedifico.html#arkMusicMeter"><span class="hs-identifier">arkMusicMeter</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span class="hs-special">,</span><span>
</span><a name="line-459"></a><span>    </span><a name="arkTextMeter"><a href="Aedifico.html#arkTextMeter"><span class="hs-identifier">arkTextMeter</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#TextMeter"><span class="hs-identifier hs-type">TextMeter</span></a><span>
</span><a name="line-460"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-type">ArkConfig</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-463"></a><span>    </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679031253"><a href="#local-6989586621679031253"><span class="hs-identifier">config</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-464"></a><span>        </span><span class="hs-string">&quot;style: &quot;</span><span>   </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">arkStyle</span><span> </span><a href="#local-6989586621679031253"><span class="hs-identifier hs-var">config</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-465"></a><span>        </span><span class="hs-string">&quot;, meter: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">arkMusicMeter</span><span> </span><a href="#local-6989586621679031253"><span class="hs-identifier hs-var">config</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-466"></a><span>        </span><span class="hs-string">&quot;, mode: &quot;</span><span>  </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">arkMode</span><span> </span><a href="#local-6989586621679031253"><span class="hs-identifier hs-var">config</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span class="hs-comment">-- ** Elements of the ark</span><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span class="hs-comment">-- *** 'Vperm': Pitch combinations for four-voice choir</span><span>
</span><a name="line-471"></a><span>
</span><a name="line-472"></a><span class="hs-comment">-- | The top part of Kircher's &quot;rods&quot; contain tables table of numbers with four rows,</span><span>
</span><a name="line-473"></a><span class="hs-comment">-- where the numbers represent pitch offsets from a modal base note, and the</span><span>
</span><a name="line-474"></a><span class="hs-comment">-- rows are the notes for the four voice parts SATB.</span><span>
</span><a name="line-475"></a><span class="hs-comment">-- Each table represents the notes to set a single phrase of text with a given</span><span>
</span><a name="line-476"></a><span class="hs-comment">-- number of syllables.</span><span>
</span><a name="line-477"></a><span class="hs-comment">--</span><span>
</span><a name="line-478"></a><span class="hs-comment">-- We implement the notes for one voice as a 'Vperm', a list of 'Int' values.</span><span>
</span><a name="line-479"></a><span class="hs-keyword">type</span><span> </span><a name="Vperm"><a href="Aedifico.html#Vperm"><span class="hs-identifier">Vperm</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-480"></a><span>
</span><a name="line-481"></a><span class="hs-comment">-- | A vector of four 'Vperm's makes a 'VpermChoir'.</span><span>
</span><a name="line-482"></a><span class="hs-keyword">type</span><span> </span><a name="VpermChoir"><a href="Aedifico.html#VpermChoir"><span class="hs-identifier">VpermChoir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#Vperm"><span class="hs-identifier hs-type">Vperm</span></a><span class="hs-special">)</span><span>
</span><a name="line-483"></a><span>
</span><a name="line-484"></a><span class="hs-comment">-- | A Vector of 'VpermChoir's is a 'VpermTable', which represents the top</span><span>
</span><a name="line-485"></a><span class="hs-comment">-- part of Kircher's &quot;rods&quot;. We need to know the vector length because it</span><span>
</span><a name="line-486"></a><span class="hs-comment">-- varies in different /pinakes/.</span><span>
</span><a name="line-487"></a><span class="hs-keyword">data</span><span> </span><a name="VpermTable"><a href="Aedifico.html#VpermTable"><span class="hs-identifier">VpermTable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="VpermTable"><a href="Aedifico.html#VpermTable"><span class="hs-identifier">VpermTable</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-488"></a><span>    </span><a name="vpermMax"><a href="Aedifico.html#vpermMax"><span class="hs-identifier">vpermMax</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>                </span><span class="hs-comment">-- ^ length of 'vperms'</span><span>
</span><a name="line-489"></a><span>    </span><a name="vperms"><a href="Aedifico.html#vperms"><span class="hs-identifier">vperms</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#VpermChoir"><span class="hs-identifier hs-type">VpermChoir</span></a><span class="hs-special">)</span><span>
</span><a name="line-490"></a><span class="hs-special">}</span><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span class="hs-comment">-- *** 'Rperm': Rhythm permutations to match the 'Vperm'</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span class="hs-comment">-- | The bottom part of the &quot;rods&quot; contain tables of rhythmic values written</span><span>
</span><a name="line-495"></a><span class="hs-comment">-- with musical notes. In the simple note-against-note style, there is one</span><span>
</span><a name="line-496"></a><span class="hs-comment">-- list of values to match each table of voices.</span><span>
</span><a name="line-497"></a><span class="hs-comment">--</span><span>
</span><a name="line-498"></a><span class="hs-comment">-- We implement this using our 'Dur' data type for the rhythmic values.</span><span>
</span><a name="line-499"></a><span class="hs-comment">-- An 'Rperm' is a list of 'Dur' values.</span><span>
</span><a name="line-500"></a><span class="hs-keyword">type</span><span> </span><a name="Rperm"><a href="Aedifico.html#Rperm"><span class="hs-identifier">Rperm</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span class="hs-special">]</span><span>
</span><a name="line-501"></a><span>
</span><a name="line-502"></a><span class="hs-comment">-- | In Syntagma I, there is only one set of rhythmic permutation that we</span><span>
</span><a name="line-503"></a><span class="hs-comment">-- apply to all four voices of the 'VpermChoir'. But in Syntagma II, there are</span><span>
</span><a name="line-504"></a><span class="hs-comment">-- groups of four 'Rperm's that match up with the four voices. </span><span>
</span><a name="line-505"></a><span class="hs-comment">-- So we make a &quot;choir&quot; as a vector of 'Rperm's, though in Syntagma I this</span><span>
</span><a name="line-506"></a><span class="hs-comment">-- will always just have a single member.</span><span>
</span><a name="line-507"></a><span class="hs-keyword">type</span><span> </span><a name="RpermChoir"><a href="Aedifico.html#RpermChoir"><span class="hs-identifier">RpermChoir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#Rperm"><span class="hs-identifier hs-type">Rperm</span></a><span class="hs-special">)</span><span>
</span><a name="line-508"></a><span>
</span><a name="line-509"></a><span class="hs-comment">-- | An 'RpermMeter' includes a vector of 'RpermChoir's all in one meter (see</span><span>
</span><a name="line-510"></a><span class="hs-comment">-- the 'MusicMeter' data type above) and the length of that vector.</span><span>
</span><a name="line-511"></a><span class="hs-comment">--</span><span>
</span><a name="line-512"></a><span class="hs-comment">-- Kircher has a variable number of 'Rperm's in the different meters, in each</span><span>
</span><a name="line-513"></a><span class="hs-comment">-- column, so we need to know how many there are.</span><span>
</span><a name="line-514"></a><span class="hs-comment">--</span><span>
</span><a name="line-515"></a><span class="hs-comment">-- In Syntagma II everything is duple meter so there is just the one meter.</span><span>
</span><a name="line-516"></a><span class="hs-keyword">data</span><span> </span><a name="RpermMeter"><a href="Aedifico.html#RpermMeter"><span class="hs-identifier">RpermMeter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RpermMeter"><a href="Aedifico.html#RpermMeter"><span class="hs-identifier">RpermMeter</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-517"></a><span>    </span><a name="rpermMax"><a href="Aedifico.html#rpermMax"><span class="hs-identifier">rpermMax</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ^ length of 'rperms'</span><span>
</span><a name="line-518"></a><span>    </span><a name="rperms"><a href="Aedifico.html#rperms"><span class="hs-identifier">rperms</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#RpermChoir"><span class="hs-identifier hs-type">RpermChoir</span></a><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span class="hs-special">}</span><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-comment">-- | The 'RpermTable' is a vector containing all the rhythmic permutations for</span><span>
</span><a name="line-522"></a><span class="hs-comment">-- one of Kircher's &quot;rods&quot;.</span><span>
</span><a name="line-523"></a><span class="hs-comment">--</span><span>
</span><a name="line-524"></a><span class="hs-comment">-- __TODO__: This implementation may not be sufficient for the more complex styles</span><span>
</span><a name="line-525"></a><span class="hs-comment">-- where there are different rhythms for the four voices. Also, as noted</span><span>
</span><a name="line-526"></a><span class="hs-comment">-- above, we may need to distinguish duple major and duple minor.</span><span>
</span><a name="line-527"></a><span class="hs-keyword">type</span><span> </span><a name="RpermTable"><a href="Aedifico.html#RpermTable"><span class="hs-identifier">RpermTable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#RpermMeter"><span class="hs-identifier hs-type">RpermMeter</span></a><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span>
</span><a name="line-529"></a><span class="hs-comment">-- ** Assembling the data into Kircher's structures</span><span>
</span><a name="line-530"></a><span>
</span><a name="line-531"></a><span class="hs-comment">-- | The ark is a box containing rods (/pinakes/), each of which includes</span><span>
</span><a name="line-532"></a><span class="hs-comment">-- columns with voice and rhythm permutations. The rods are grouped according</span><span>
</span><a name="line-533"></a><span class="hs-comment">-- to style into /syntagmata/, where /syntagma/ 1 is simple homorhythmic</span><span>
</span><a name="line-534"></a><span class="hs-comment">-- counterpoint.</span><span>
</span><a name="line-535"></a><span class="hs-comment">--</span><span>
</span><a name="line-536"></a><span class="hs-comment">-- We implement the 'Column' as a structure with one 'VpermTable' and one</span><span>
</span><a name="line-537"></a><span class="hs-comment">-- 'RpermTable'. </span><span>
</span><a name="line-538"></a><span class="hs-keyword">data</span><span> </span><a name="Column"><a href="Aedifico.html#Column"><span class="hs-identifier">Column</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a name="Column"><a href="Aedifico.html#Column"><span class="hs-identifier">Column</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-539"></a><span>    </span><a name="colVpermTable"><a href="Aedifico.html#colVpermTable"><span class="hs-identifier">colVpermTable</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#VpermTable"><span class="hs-identifier hs-type">VpermTable</span></a><span class="hs-special">,</span><span>
</span><a name="line-540"></a><span>    </span><a name="colRpermTable"><a href="Aedifico.html#colRpermTable"><span class="hs-identifier">colRpermTable</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#RpermTable"><span class="hs-identifier hs-type">RpermTable</span></a><span>
</span><a name="line-541"></a><span class="hs-special">}</span><span>
</span><a name="line-542"></a><span>
</span><a name="line-543"></a><span class="hs-comment">-- | A vector of 'Column' instances is a 'Pinax'.</span><span>
</span><a name="line-544"></a><span class="hs-keyword">type</span><span> </span><a name="Pinax"><a href="Aedifico.html#Pinax"><span class="hs-identifier">Pinax</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#Column"><span class="hs-identifier hs-type">Column</span></a><span class="hs-special">)</span><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span class="hs-comment">-- | A vector of 'Pinax' instances is a 'Syntagma'.</span><span>
</span><a name="line-547"></a><span class="hs-keyword">type</span><span> </span><a name="Syntagma"><a href="Aedifico.html#Syntagma"><span class="hs-identifier">Syntagma</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#Pinax"><span class="hs-identifier hs-type">Pinax</span></a><span class="hs-special">)</span><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-comment">-- | A vector of 'Syntagma' instances makes up the full 'Arca'.</span><span>
</span><a name="line-550"></a><span class="hs-keyword">data</span><span> </span><a name="Arca"><a href="Aedifico.html#Arca"><span class="hs-identifier">Arca</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Arca"><a href="Aedifico.html#Arca"><span class="hs-identifier">Arca</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-551"></a><span>    </span><a name="perms"><a href="Aedifico.html#perms"><span class="hs-identifier">perms</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#Syntagma"><span class="hs-identifier hs-type">Syntagma</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-552"></a><span>    </span><a name="modes"><a href="Aedifico.html#modes"><span class="hs-identifier">modes</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#ModeList"><span class="hs-identifier hs-type">ModeList</span></a><span class="hs-special">,</span><span>
</span><a name="line-553"></a><span>    </span><a name="systems"><a href="Aedifico.html#systems"><span class="hs-identifier">systems</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#ModeSystem"><span class="hs-identifier hs-type">ModeSystem</span></a><span class="hs-special">,</span><span>
</span><a name="line-554"></a><span>    </span><a name="pinaxModes"><a href="Aedifico.html#pinaxModes"><span class="hs-identifier">pinaxModes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#PinaxModeList"><span class="hs-identifier hs-type">PinaxModeList</span></a><span class="hs-special">,</span><span>
</span><a name="line-555"></a><span>    </span><a name="ranges"><a href="Aedifico.html#ranges"><span class="hs-identifier">ranges</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#VoiceRanges"><span class="hs-identifier hs-type">VoiceRanges</span></a><span>
</span><a name="line-556"></a><span class="hs-special">}</span><span>
</span><a name="line-557"></a><span>
</span><a name="line-558"></a><span class="hs-comment">-- * Accessing the Data</span><span>
</span><a name="line-559"></a><span class="hs-comment">-- ** By index</span><span>
</span><a name="line-560"></a><span>
</span><a name="line-561"></a><span class="hs-comment">-- | Just get a vector value by index, safely (combining 'fromJust' and '!?')</span><span>
</span><a name="line-562"></a><span class="hs-identifier">getVectorItem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ name of calling function, for debugging</span><span>
</span><a name="line-563"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-6989586621679031337"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ vector to pull from</span><span>
</span><a name="line-564"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ index to select</span><span>
</span><a name="line-565"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679031337"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-566"></a><a name="getVectorItem"><a href="Aedifico.html#getVectorItem"><span class="hs-identifier">getVectorItem</span></a></a><span> </span><a name="local-6989586621679033430"><a href="#local-6989586621679033430"><span class="hs-identifier">fnName</span></a></a><span> </span><a name="local-6989586621679033431"><a href="#local-6989586621679033431"><span class="hs-identifier">vector</span></a></a><span> </span><a name="local-6989586621679033432"><a href="#local-6989586621679033432"><span class="hs-identifier">index</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-6989586621679033433"><span class="hs-identifier hs-var">errorMsg</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033431"><span class="hs-identifier hs-var">vector</span></a><span> </span><span class="hs-operator hs-var">!?</span><span> </span><a href="#local-6989586621679033432"><span class="hs-identifier hs-var">index</span></a><span class="hs-special">)</span><span>
</span><a name="line-567"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679033433"><a href="#local-6989586621679033433"><span class="hs-identifier">errorMsg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;bad vector index in calling function&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679033430"><span class="hs-identifier hs-var">fnName</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679033432"><span class="hs-identifier hs-var">index</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679033431"><span class="hs-identifier hs-var">vector</span></a><span class="hs-special">]</span><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-comment">-- | Getting a 'Column' just requires indexing through nested vectors.</span><span>
</span><a name="line-570"></a><span class="hs-identifier">column</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span>        </span><span class="hs-comment">-- ^ ark (there's only one, but someone could make more)</span><span>
</span><a name="line-571"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>        </span><span class="hs-comment">-- ^ syntagma number</span><span>
</span><a name="line-572"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#PinaxLabel"><span class="hs-identifier hs-type">PinaxLabel</span></a><span> </span><span class="hs-comment">-- ^ pinax label enum </span><span>
</span><a name="line-573"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>        </span><span class="hs-comment">-- ^ column number</span><span>
</span><a name="line-574"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Column"><span class="hs-identifier hs-type">Column</span></a><span>
</span><a name="line-575"></a><a name="column"><a href="Aedifico.html#column"><span class="hs-identifier">column</span></a></a><span> </span><a name="local-6989586621679033434"><a href="#local-6989586621679033434"><span class="hs-identifier">arca</span></a></a><span> </span><a name="local-6989586621679033435"><a href="#local-6989586621679033435"><span class="hs-identifier">syntagma</span></a></a><span> </span><a name="local-6989586621679033436"><a href="#local-6989586621679033436"><span class="hs-identifier">pinax</span></a></a><span> </span><a name="local-6989586621679033437"><a href="#local-6989586621679033437"><span class="hs-identifier">col</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033438"><span class="hs-identifier hs-var">thisColumn</span></a><span>
</span><a name="line-576"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-577"></a><span>        </span><a name="local-6989586621679033438"><a href="#local-6989586621679033438"><span class="hs-identifier">thisColumn</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;column&quot;</span><span> </span><a href="#local-6989586621679033439"><span class="hs-identifier hs-var">thisPinax</span></a><span> </span><a href="#local-6989586621679033437"><span class="hs-identifier hs-var">col</span></a><span>
</span><a name="line-578"></a><span>        </span><a name="local-6989586621679033439"><a href="#local-6989586621679033439"><span class="hs-identifier">thisPinax</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;column:pinax&quot;</span><span> </span><a href="#local-6989586621679033440"><span class="hs-identifier hs-var">thisSyntagma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679033436"><span class="hs-identifier hs-var">pinax</span></a><span>
</span><a name="line-579"></a><span>        </span><a name="local-6989586621679033440"><a href="#local-6989586621679033440"><span class="hs-identifier">thisSyntagma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;column:syntagme&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">perms</span><span> </span><a href="#local-6989586621679033434"><span class="hs-identifier hs-var">arca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033435"><span class="hs-identifier hs-var">syntagma</span></a><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-comment">-- | Getting a 'VpermChoir' means taking the first of the 'Column' 2-tuple; we</span><span>
</span><a name="line-582"></a><span class="hs-comment">-- select which one using a random number (from @Fortuna@ module), though the</span><span>
</span><a name="line-583"></a><span class="hs-comment">-- Inquisition forbids chance operations</span><span>
</span><a name="line-584"></a><span class="hs-identifier">vperm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Column"><span class="hs-identifier hs-type">Column</span></a><span>
</span><a name="line-585"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ Index of voice permutation within the column</span><span>
</span><a name="line-586"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#VpermChoir"><span class="hs-identifier hs-type">VpermChoir</span></a><span>
</span><a name="line-587"></a><a name="vperm"><a href="Aedifico.html#vperm"><span class="hs-identifier">vperm</span></a></a><span> </span><a name="local-6989586621679033441"><a href="#local-6989586621679033441"><span class="hs-identifier">col</span></a></a><span> </span><a name="local-6989586621679033442"><a href="#local-6989586621679033442"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;vperm&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">vperms</span><span> </span><a href="#local-6989586621679033444"><span class="hs-identifier hs-var">vpermTable</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033443"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-588"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-589"></a><span>        </span><a name="local-6989586621679033443"><a href="#local-6989586621679033443"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033442"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">vpermMax</span><span> </span><a href="#local-6989586621679033444"><span class="hs-identifier hs-var">vpermTable</span></a><span>
</span><a name="line-590"></a><span>        </span><a name="local-6989586621679033444"><a href="#local-6989586621679033444"><span class="hs-identifier">vpermTable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">colVpermTable</span><span> </span><a href="#local-6989586621679033441"><span class="hs-identifier hs-var">col</span></a><span>
</span><a name="line-591"></a><span>
</span><a name="line-592"></a><span class="hs-comment">-- __TODO__: Adjust for new structure with added layer of RpermChoir</span><span>
</span><a name="line-593"></a><span>
</span><a name="line-594"></a><span class="hs-comment">-- | Getting an 'RpermChoir' means taking data from 'Column', using the meter</span><span>
</span><a name="line-595"></a><span class="hs-comment">-- and a random index (for Kircher, user's choice)</span><span>
</span><a name="line-596"></a><span class="hs-identifier">rperm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Column"><span class="hs-identifier hs-type">Column</span></a><span>
</span><a name="line-597"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#MusicMeter"><span class="hs-identifier hs-type">MusicMeter</span></a><span>
</span><a name="line-598"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ Index of rhythm permutation</span><span>
</span><a name="line-599"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#RpermChoir"><span class="hs-identifier hs-type">RpermChoir</span></a><span>
</span><a name="line-600"></a><a name="rperm"><a href="Aedifico.html#rperm"><span class="hs-identifier">rperm</span></a></a><span> </span><a name="local-6989586621679033445"><a href="#local-6989586621679033445"><span class="hs-identifier">col</span></a></a><span> </span><a name="local-6989586621679033446"><a href="#local-6989586621679033446"><span class="hs-identifier">meter</span></a></a><span> </span><a name="local-6989586621679033447"><a href="#local-6989586621679033447"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;rperm&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rperms</span><span> </span><a href="#local-6989586621679033449"><span class="hs-identifier hs-var">rpermTable</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033448"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-601"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-602"></a><span>        </span><a name="local-6989586621679033448"><a href="#local-6989586621679033448"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033447"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rpermMax</span><span> </span><a href="#local-6989586621679033449"><span class="hs-identifier hs-var">rpermTable</span></a><span>
</span><a name="line-603"></a><span>        </span><a name="local-6989586621679033449"><a href="#local-6989586621679033449"><span class="hs-identifier">rpermTable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;rperm:rpermTable&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">colRpermTable</span><span> </span><a href="#local-6989586621679033445"><span class="hs-identifier hs-var">col</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679033446"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-604"></a><span>
</span><a name="line-605"></a><span class="hs-comment">-- ** By meaningful data</span><span>
</span><a name="line-606"></a><span>
</span><a name="line-607"></a><span class="hs-comment">-- | The user of Kircher's arca needs only to know the number of syllables in</span><span>
</span><a name="line-608"></a><span class="hs-comment">-- a phrase and whether the penultimate syllable is long or short. Then they</span><span>
</span><a name="line-609"></a><span class="hs-comment">-- must freely (?) choose which table in the column.</span><span>
</span><a name="line-610"></a><span class="hs-comment">--</span><span>
</span><a name="line-611"></a><span class="hs-comment">-- We go straight to a voice and a rhythm permutation, given all the needed</span><span>
</span><a name="line-612"></a><span class="hs-comment">-- variables and an index.</span><span>
</span><a name="line-613"></a><span class="hs-comment">-- Instead of choosing freely we tempt fate and use a random number.</span><span>
</span><a name="line-614"></a><span class="hs-identifier">getVperm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span>
</span><a name="line-615"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-type">ArkConfig</span></a><span>    </span><span class="hs-comment">-- ^ we need 'Style'</span><span>
</span><a name="line-616"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ syllable count</span><span>
</span><a name="line-617"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ line count</span><span>
</span><a name="line-618"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ (random) index</span><span>
</span><a name="line-619"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#VpermChoir"><span class="hs-identifier hs-type">VpermChoir</span></a><span>
</span><a name="line-620"></a><a name="getVperm"><a href="Aedifico.html#getVperm"><span class="hs-identifier">getVperm</span></a></a><span> </span><a name="local-6989586621679033450"><a href="#local-6989586621679033450"><span class="hs-identifier">arca</span></a></a><span> </span><a name="local-6989586621679033451"><a href="#local-6989586621679033451"><span class="hs-identifier">config</span></a></a><span> </span><a name="local-6989586621679033452"><a href="#local-6989586621679033452"><span class="hs-identifier">sylCount</span></a></a><span> </span><a name="local-6989586621679033453"><a href="#local-6989586621679033453"><span class="hs-identifier">lineCount</span></a></a><span> </span><a name="local-6989586621679033454"><a href="#local-6989586621679033454"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-621"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Aedifico.html#isModeLegalInPinax"><span class="hs-identifier hs-var">isModeLegalInPinax</span></a><span> </span><a href="#local-6989586621679033455"><span class="hs-identifier hs-var">modeList</span></a><span> </span><a href="#local-6989586621679033456"><span class="hs-identifier hs-var">style</span></a><span> </span><a href="#local-6989586621679033457"><span class="hs-identifier hs-var">pinax</span></a><span> </span><a href="#local-6989586621679033453"><span class="hs-identifier hs-var">lineCount</span></a><span> </span><a href="#local-6989586621679033458"><span class="hs-identifier hs-var">mode</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#vperm"><span class="hs-identifier hs-var">vperm</span></a><span> </span><a href="#local-6989586621679033459"><span class="hs-identifier hs-var">col</span></a><span> </span><a href="#local-6989586621679033454"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-622"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><a href="#local-6989586621679033463"><span class="hs-identifier hs-var">modeErrorMsg</span></a><span>
</span><a name="line-623"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-624"></a><span>        </span><a name="local-6989586621679033455"><a href="#local-6989586621679033455"><span class="hs-identifier">modeList</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pinaxModes</span><span> </span><a href="#local-6989586621679033450"><span class="hs-identifier hs-var">arca</span></a><span>
</span><a name="line-625"></a><span>        </span><a name="local-6989586621679033456"><a href="#local-6989586621679033456"><span class="hs-identifier">style</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkStyle</span><span> </span><a href="#local-6989586621679033451"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-626"></a><span>        </span><a name="local-6989586621679033457"><a href="#local-6989586621679033457"><span class="hs-identifier">pinax</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#meter2pinax"><span class="hs-identifier hs-var">meter2pinax</span></a><span> </span><a href="#local-6989586621679033456"><span class="hs-identifier hs-var">style</span></a><span> </span><a href="#local-6989586621679033462"><span class="hs-identifier hs-var">textMeter</span></a><span>
</span><a name="line-627"></a><span>        </span><a name="local-6989586621679033458"><a href="#local-6989586621679033458"><span class="hs-identifier">mode</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#modeOrModeB"><span class="hs-identifier hs-var">modeOrModeB</span></a><span> </span><a href="#local-6989586621679033451"><span class="hs-identifier hs-var">config</span></a><span> </span><a href="#local-6989586621679033453"><span class="hs-identifier hs-var">lineCount</span></a><span>
</span><a name="line-628"></a><span>
</span><a name="line-629"></a><span>        </span><a name="local-6989586621679033459"><a href="#local-6989586621679033459"><span class="hs-identifier">col</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#column"><span class="hs-identifier hs-var">column</span></a><span> </span><a href="#local-6989586621679033450"><span class="hs-identifier hs-var">arca</span></a><span> </span><a href="#local-6989586621679033460"><span class="hs-identifier hs-var">styleNum</span></a><span> </span><a href="#local-6989586621679033457"><span class="hs-identifier hs-var">pinax</span></a><span> </span><a href="#local-6989586621679033461"><span class="hs-identifier hs-var">thisColIndex</span></a><span>
</span><a name="line-630"></a><span>        </span><a name="local-6989586621679033460"><a href="#local-6989586621679033460"><span class="hs-identifier">styleNum</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679033456"><span class="hs-identifier hs-var">style</span></a><span>
</span><a name="line-631"></a><span>        </span><a name="local-6989586621679033461"><a href="#local-6989586621679033461"><span class="hs-identifier">thisColIndex</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#columnIndex"><span class="hs-identifier hs-var">columnIndex</span></a><span> </span><a href="#local-6989586621679033456"><span class="hs-identifier hs-var">style</span></a><span> </span><a href="#local-6989586621679033462"><span class="hs-identifier hs-var">textMeter</span></a><span> </span><a href="#local-6989586621679033452"><span class="hs-identifier hs-var">sylCount</span></a><span> </span><a href="#local-6989586621679033453"><span class="hs-identifier hs-var">lineCount</span></a><span>
</span><a name="line-632"></a><span>        </span><a name="local-6989586621679033462"><a href="#local-6989586621679033462"><span class="hs-identifier">textMeter</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkTextMeter</span><span> </span><a href="#local-6989586621679033451"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-633"></a><span>
</span><a name="line-634"></a><span>        </span><a name="local-6989586621679033463"><a href="#local-6989586621679033463"><span class="hs-identifier">modeErrorMsg</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Illegal mode&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679033458"><span class="hs-identifier hs-var">mode</span></a><span class="hs-special">,</span><span>
</span><a name="line-635"></a><span>                                 </span><span class="hs-string">&quot;in syntagma&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679033456"><span class="hs-identifier hs-var">style</span></a><span class="hs-special">,</span><span>
</span><a name="line-636"></a><span>                                 </span><span class="hs-string">&quot;pinax&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679033457"><span class="hs-identifier hs-var">pinax</span></a><span class="hs-special">,</span><span>
</span><a name="line-637"></a><span>                                 </span><span class="hs-string">&quot;line number&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679033453"><span class="hs-identifier hs-var">lineCount</span></a><span class="hs-special">]</span><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span class="hs-comment">-- | Use @modeB@ attribute if needed, otherwise @mode@ (We only use @modeB@</span><span>
</span><a name="line-640"></a><span class="hs-comment">-- for florid pinax 4, every third and fourth line!)</span><span>
</span><a name="line-641"></a><span class="hs-identifier">modeOrModeB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-type">ArkConfig</span></a><span>
</span><a name="line-642"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ line number, zero indexed</span><span>
</span><a name="line-643"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span>
</span><a name="line-644"></a><a name="modeOrModeB"><a href="Aedifico.html#modeOrModeB"><span class="hs-identifier">modeOrModeB</span></a></a><span> </span><a name="local-6989586621679033464"><a href="#local-6989586621679033464"><span class="hs-identifier">config</span></a></a><span> </span><a name="local-6989586621679033465"><a href="#local-6989586621679033465"><span class="hs-identifier">lineCount</span></a></a><span>
</span><a name="line-645"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033466"><span class="hs-identifier hs-var">style</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Aedifico.html#Florid"><span class="hs-identifier hs-var">Florid</span></a><span>
</span><a name="line-646"></a><span>      </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Aedifico.html#meter2pinax"><span class="hs-identifier hs-var">meter2pinax</span></a><span> </span><a href="#local-6989586621679033466"><span class="hs-identifier hs-var">style</span></a><span> </span><a href="#local-6989586621679033467"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Aedifico.html#Pinax4"><span class="hs-identifier hs-var">Pinax4</span></a><span>
</span><a name="line-647"></a><span>      </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679033465"><span class="hs-identifier hs-var">lineCount</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-648"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkModeB</span><span> </span><a href="#local-6989586621679033464"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-649"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-650"></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkMode</span><span> </span><a href="#local-6989586621679033464"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-651"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-652"></a><span>        </span><a name="local-6989586621679033466"><a href="#local-6989586621679033466"><span class="hs-identifier">style</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkStyle</span><span> </span><a href="#local-6989586621679033464"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-653"></a><span>        </span><a name="local-6989586621679033467"><a href="#local-6989586621679033467"><span class="hs-identifier">meter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkTextMeter</span><span> </span><a href="#local-6989586621679033464"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-654"></a><span>
</span><a name="line-655"></a><span>
</span><a name="line-656"></a><span class="hs-comment">-- | Select the rhythm values for a single phrase from the ark's rhythm</span><span>
</span><a name="line-657"></a><span class="hs-comment">-- permutations (Rperms).</span><span>
</span><a name="line-658"></a><span class="hs-comment">--</span><span>
</span><a name="line-659"></a><span class="hs-comment">-- In Pinax 9, there is no TripleMinor category of rperms, so we screen that</span><span>
</span><a name="line-660"></a><span class="hs-comment">-- out first. </span><span>
</span><a name="line-661"></a><span class="hs-comment">--</span><span>
</span><a name="line-662"></a><span class="hs-comment">-- __TODO__: Using an error, but we could just substitute TripleMajor with a</span><span>
</span><a name="line-663"></a><span class="hs-comment">-- note in the log (if we had a log).</span><span>
</span><a name="line-664"></a><span class="hs-identifier">getRperm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span>
</span><a name="line-665"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-type">ArkConfig</span></a><span>    </span><span class="hs-comment">-- ^ we need 'Style' and 'MusicMeter' </span><span>
</span><a name="line-666"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ syllable count</span><span>
</span><a name="line-667"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ line count</span><span>
</span><a name="line-668"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ (random) index</span><span>
</span><a name="line-669"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#RpermChoir"><span class="hs-identifier hs-type">RpermChoir</span></a><span>
</span><a name="line-670"></a><a name="getRperm"><a href="Aedifico.html#getRperm"><span class="hs-identifier">getRperm</span></a></a><span> </span><a name="local-6989586621679033468"><a href="#local-6989586621679033468"><span class="hs-identifier">arca</span></a></a><span> </span><a name="local-6989586621679033469"><a href="#local-6989586621679033469"><span class="hs-identifier">config</span></a></a><span> </span><a name="local-6989586621679033470"><a href="#local-6989586621679033470"><span class="hs-identifier">sylCount</span></a></a><span> </span><a name="local-6989586621679033471"><a href="#local-6989586621679033471"><span class="hs-identifier">lineCount</span></a></a><span> </span><a name="local-6989586621679033472"><a href="#local-6989586621679033472"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-671"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033476"><span class="hs-identifier hs-var">pinax</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Aedifico.html#Pinax9"><span class="hs-identifier hs-var">Pinax9</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier">arkMusicMeter</span><span> </span><a href="#local-6989586621679033469"><span class="hs-identifier hs-var">config</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Aedifico.html#TripleMinor"><span class="hs-identifier hs-var">TripleMinor</span></a><span>
</span><a name="line-672"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Only Duple and TripleMajor musicMeter allowed with this textMeter&quot;</span><span>
</span><a name="line-673"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">arkStyle</span><span> </span><a href="#local-6989586621679033469"><span class="hs-identifier hs-var">config</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Aedifico.html#Florid"><span class="hs-identifier hs-var">Florid</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier">arkMusicMeter</span><span> </span><a href="#local-6989586621679033469"><span class="hs-identifier hs-var">config</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Aedifico.html#Duple"><span class="hs-identifier hs-var">Duple</span></a><span>
</span><a name="line-674"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Only Duple meter allowed in Syntagma 2 for florid counterpoint&quot;</span><span>
</span><a name="line-675"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-676"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#rperm"><span class="hs-identifier hs-var">rperm</span></a><span> </span><a href="#local-6989586621679033475"><span class="hs-identifier hs-var">col</span></a><span> </span><a href="#local-6989586621679033479"><span class="hs-identifier hs-var">meter</span></a><span> </span><a href="#local-6989586621679033472"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-677"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-678"></a><span>        </span><a name="local-6989586621679033473"><a href="#local-6989586621679033473"><span class="hs-identifier">style</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkStyle</span><span> </span><a href="#local-6989586621679033469"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-679"></a><span>        </span><a name="local-6989586621679033474"><a href="#local-6989586621679033474"><span class="hs-identifier">styleNum</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679033473"><span class="hs-identifier hs-var">style</span></a><span>
</span><a name="line-680"></a><span>        </span><a name="local-6989586621679033475"><a href="#local-6989586621679033475"><span class="hs-identifier">col</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#column"><span class="hs-identifier hs-var">column</span></a><span> </span><a href="#local-6989586621679033468"><span class="hs-identifier hs-var">arca</span></a><span> </span><a href="#local-6989586621679033474"><span class="hs-identifier hs-var">styleNum</span></a><span> </span><a href="#local-6989586621679033476"><span class="hs-identifier hs-var">pinax</span></a><span> </span><a href="#local-6989586621679033477"><span class="hs-identifier hs-var">thisColIndex</span></a><span>
</span><a name="line-681"></a><span>        </span><a name="local-6989586621679033476"><a href="#local-6989586621679033476"><span class="hs-identifier">pinax</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#meter2pinax"><span class="hs-identifier hs-var">meter2pinax</span></a><span> </span><a href="#local-6989586621679033473"><span class="hs-identifier hs-var">style</span></a><span> </span><a href="#local-6989586621679033478"><span class="hs-identifier hs-var">textMeter</span></a><span>
</span><a name="line-682"></a><span>        </span><a name="local-6989586621679033477"><a href="#local-6989586621679033477"><span class="hs-identifier">thisColIndex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#columnIndex"><span class="hs-identifier hs-var">columnIndex</span></a><span> </span><a href="#local-6989586621679033473"><span class="hs-identifier hs-var">style</span></a><span> </span><a href="#local-6989586621679033478"><span class="hs-identifier hs-var">textMeter</span></a><span> </span><a href="#local-6989586621679033470"><span class="hs-identifier hs-var">sylCount</span></a><span> </span><a href="#local-6989586621679033471"><span class="hs-identifier hs-var">lineCount</span></a><span>
</span><a name="line-683"></a><span>        </span><a name="local-6989586621679033478"><a href="#local-6989586621679033478"><span class="hs-identifier">textMeter</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkTextMeter</span><span> </span><a href="#local-6989586621679033469"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-684"></a><span>        </span><a name="local-6989586621679033479"><a href="#local-6989586621679033479"><span class="hs-identifier">meter</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkMusicMeter</span><span> </span><a href="#local-6989586621679033469"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-685"></a><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span class="hs-comment">-- | The rule for selecting the column index varies depending on the /pinax/.</span><span>
</span><a name="line-688"></a><span class="hs-comment">-- Pinax 1 and 2 are determined by whether the penultimate syllables is long</span><span>
</span><a name="line-689"></a><span class="hs-comment">-- or short, respectively, and then the column is based on the number of</span><span>
</span><a name="line-690"></a><span class="hs-comment">-- syllables in the phrase.</span><span>
</span><a name="line-691"></a><span class="hs-comment">-- Pinax 3 columns are based on whether the meter is Adonic or Dactylic (5 or</span><span>
</span><a name="line-692"></a><span class="hs-comment">-- six syllables respectively).</span><span>
</span><a name="line-693"></a><span class="hs-comment">-- </span><span>
</span><a name="line-694"></a><span class="hs-comment">-- There are different rules for each syntagma, hence the need for Style</span><span>
</span><a name="line-695"></a><span class="hs-comment">-- input.</span><span>
</span><a name="line-696"></a><span class="hs-identifier">columnIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Style"><span class="hs-identifier hs-type">Style</span></a><span>
</span><a name="line-697"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#TextMeter"><span class="hs-identifier hs-type">TextMeter</span></a><span>
</span><a name="line-698"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ syllable count</span><span>
</span><a name="line-699"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ line count</span><span>
</span><a name="line-700"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-701"></a><a name="columnIndex"><a href="Aedifico.html#columnIndex"><span class="hs-identifier">columnIndex</span></a></a><span> </span><a name="local-6989586621679033480"><a href="#local-6989586621679033480"><span class="hs-identifier">style</span></a></a><span> </span><a name="local-6989586621679033481"><a href="#local-6989586621679033481"><span class="hs-identifier">meter</span></a></a><span> </span><a name="local-6989586621679033482"><a href="#local-6989586621679033482"><span class="hs-identifier">sylCount</span></a></a><span> </span><a name="local-6989586621679033483"><a href="#local-6989586621679033483"><span class="hs-identifier">lineCount</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-702"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679033480"><span class="hs-identifier hs-var">style</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-703"></a><span>        </span><a href="Aedifico.html#Simple"><span class="hs-identifier hs-var">Simple</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679033487"><span class="hs-identifier hs-var">columnIndexSimple</span></a><span> </span><a href="#local-6989586621679033481"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-704"></a><span>        </span><a href="Aedifico.html#Florid"><span class="hs-identifier hs-var">Florid</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679033488"><span class="hs-identifier hs-var">columnIndexFlorid</span></a><span> </span><a href="#local-6989586621679033481"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-705"></a><span>
</span><a name="line-706"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-707"></a><span>        </span><a name="local-6989586621679033484"><a href="#local-6989586621679033484"><span class="hs-identifier">proseSylCount</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033482"><span class="hs-identifier hs-var">sylCount</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-708"></a><span>        </span><a name="local-6989586621679033485"><a href="#local-6989586621679033485"><span class="hs-identifier">quatrainPosition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033483"><span class="hs-identifier hs-var">lineCount</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-709"></a><span>        </span><a name="local-6989586621679033486"><a href="#local-6989586621679033486"><span class="hs-identifier">errorMsg</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Unrecognized meter &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679033481"><span class="hs-identifier hs-var">meter</span></a><span>
</span><a name="line-710"></a><span>                            </span><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;, could not select pinax&quot;</span><span>
</span><a name="line-711"></a><span>
</span><a name="line-712"></a><span>        </span><a name="local-6989586621679033487"><a href="#local-6989586621679033487"><span class="hs-identifier">columnIndexSimple</span></a></a><span> </span><a name="local-6989586621679033489"><a href="#local-6989586621679033489"><span class="hs-identifier">meter</span></a></a><span>
</span><a name="line-713"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033489"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Aedifico.html#Prose"><span class="hs-identifier hs-var">Prose</span></a><span>
</span><a name="line-714"></a><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Prose subtype not set&quot;</span><span>
</span><a name="line-715"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033489"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#ProseLong"><span class="hs-identifier hs-var">ProseLong</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#ProseShort"><span class="hs-identifier hs-var">ProseShort</span></a><span class="hs-special">]</span><span>
</span><a name="line-716"></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033484"><span class="hs-identifier hs-var">proseSylCount</span></a><span>
</span><a name="line-717"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033489"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Aedifico.html#Adonium"><span class="hs-identifier hs-var">Adonium</span></a><span>
</span><a name="line-718"></a><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-719"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033489"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Aedifico.html#Dactylicum"><span class="hs-identifier hs-var">Dactylicum</span></a><span>
</span><a name="line-720"></a><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-721"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033489"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span> </span><a href="Aedifico.html#IambicumEuripidaeum"><span class="hs-identifier hs-var">IambicumEuripidaeum</span></a><span>
</span><a name="line-722"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Anacreonticum"><span class="hs-identifier hs-var">Anacreonticum</span></a><span>
</span><a name="line-723"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#IambicumArchilochicum"><span class="hs-identifier hs-var">IambicumArchilochicum</span></a><span>
</span><a name="line-724"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#IambicumEnneasyllabicum"><span class="hs-identifier hs-var">IambicumEnneasyllabicum</span></a><span>
</span><a name="line-725"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Enneasyllabicum"><span class="hs-identifier hs-var">Enneasyllabicum</span></a><span>
</span><a name="line-726"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Decasyllabicum"><span class="hs-identifier hs-var">Decasyllabicum</span></a><span>
</span><a name="line-727"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#PhaleuciumHendecasyllabicum"><span class="hs-identifier hs-var">PhaleuciumHendecasyllabicum</span></a><span>
</span><a name="line-728"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Sapphicum"><span class="hs-identifier hs-var">Sapphicum</span></a><span>
</span><a name="line-729"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Dodecasyllabicum"><span class="hs-identifier hs-var">Dodecasyllabicum</span></a><span>
</span><a name="line-730"></a><span>                           </span><span class="hs-special">]</span><span>
</span><a name="line-731"></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033485"><span class="hs-identifier hs-var">quatrainPosition</span></a><span>
</span><a name="line-732"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-733"></a><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><a href="#local-6989586621679033486"><span class="hs-identifier hs-var">errorMsg</span></a><span>
</span><a name="line-734"></a><span>
</span><a name="line-735"></a><span>        </span><a name="local-6989586621679033488"><a href="#local-6989586621679033488"><span class="hs-identifier">columnIndexFlorid</span></a></a><span> </span><a name="local-6989586621679033490"><a href="#local-6989586621679033490"><span class="hs-identifier">meter</span></a></a><span>
</span><a name="line-736"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033490"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span> </span><a href="Aedifico.html#Adonium"><span class="hs-identifier hs-var">Adonium</span></a><span>
</span><a name="line-737"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Dactylicum"><span class="hs-identifier hs-var">Dactylicum</span></a><span>
</span><a name="line-738"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#IambicumEuripidaeum"><span class="hs-identifier hs-var">IambicumEuripidaeum</span></a><span>
</span><a name="line-739"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Anacreonticum"><span class="hs-identifier hs-var">Anacreonticum</span></a><span>
</span><a name="line-740"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#IambicumArchilochicum"><span class="hs-identifier hs-var">IambicumArchilochicum</span></a><span>
</span><a name="line-741"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#IambicumEnneasyllabicum"><span class="hs-identifier hs-var">IambicumEnneasyllabicum</span></a><span>
</span><a name="line-742"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Enneasyllabicum"><span class="hs-identifier hs-var">Enneasyllabicum</span></a><span>
</span><a name="line-743"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Decasyllabicum"><span class="hs-identifier hs-var">Decasyllabicum</span></a><span>
</span><a name="line-744"></a><span>                           </span><span class="hs-special">]</span><span>
</span><a name="line-745"></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033485"><span class="hs-identifier hs-var">quatrainPosition</span></a><span>
</span><a name="line-746"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033490"><span class="hs-identifier hs-var">meter</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span> </span><a href="Aedifico.html#PhaleuciumHendecasyllabicum"><span class="hs-identifier hs-var">PhaleuciumHendecasyllabicum</span></a><span>
</span><a name="line-747"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Hendecasyllabicum"><span class="hs-identifier hs-var">Hendecasyllabicum</span></a><span>
</span><a name="line-748"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Sapphicum"><span class="hs-identifier hs-var">Sapphicum</span></a><span>
</span><a name="line-749"></a><span>                           </span><span class="hs-special">]</span><span>
</span><a name="line-750"></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033483"><span class="hs-identifier hs-var">lineCount</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-comment">-- only three &quot;strophes&quot; for Sapphic (Pinax 6)</span><span>
</span><a name="line-751"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-752"></a><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><a href="#local-6989586621679033486"><span class="hs-identifier hs-var">errorMsg</span></a><span>
</span><a name="line-753"></a><span>
</span><a name="line-754"></a><span>
</span><a name="line-755"></a><span class="hs-comment">-- | Select the pitch numbers for a single voice from one of the ark's pitch</span><span>
</span><a name="line-756"></a><span class="hs-comment">-- permutations ('Vperm's).</span><span>
</span><a name="line-757"></a><span class="hs-identifier">getVoice</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span>
</span><a name="line-758"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-type">ArkConfig</span></a><span>    </span><span class="hs-comment">-- ^ we pass this along to 'getVperm'</span><span>
</span><a name="line-759"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ syllable count</span><span>
</span><a name="line-760"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ line count</span><span>
</span><a name="line-761"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#VoiceName"><span class="hs-identifier hs-type">VoiceName</span></a><span>
</span><a name="line-762"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ (random) index</span><span>
</span><a name="line-763"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Vperm"><span class="hs-identifier hs-type">Vperm</span></a><span>
</span><a name="line-764"></a><a name="getVoice"><a href="Aedifico.html#getVoice"><span class="hs-identifier">getVoice</span></a></a><span> </span><a name="local-6989586621679033491"><a href="#local-6989586621679033491"><span class="hs-identifier">arca</span></a></a><span> </span><a name="local-6989586621679033492"><a href="#local-6989586621679033492"><span class="hs-identifier">config</span></a></a><span> </span><a name="local-6989586621679033493"><a href="#local-6989586621679033493"><span class="hs-identifier">sylCount</span></a></a><span> </span><a name="local-6989586621679033494"><a href="#local-6989586621679033494"><span class="hs-identifier">lineCount</span></a></a><span> </span><a name="local-6989586621679033495"><a href="#local-6989586621679033495"><span class="hs-identifier">voice</span></a></a><span> </span><a name="local-6989586621679033496"><a href="#local-6989586621679033496"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033497"><span class="hs-identifier hs-var">thisVoice</span></a><span>
</span><a name="line-765"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-766"></a><span>        </span><a name="local-6989586621679033497"><a href="#local-6989586621679033497"><span class="hs-identifier">thisVoice</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;getVoice:voice&quot;</span><span> </span><a href="#local-6989586621679033498"><span class="hs-identifier hs-var">thisVperm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679033495"><span class="hs-identifier hs-var">voice</span></a><span>
</span><a name="line-767"></a><span>        </span><a name="local-6989586621679033498"><a href="#local-6989586621679033498"><span class="hs-identifier">thisVperm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVperm"><span class="hs-identifier hs-var">getVperm</span></a><span> </span><a href="#local-6989586621679033491"><span class="hs-identifier hs-var">arca</span></a><span> </span><a href="#local-6989586621679033492"><span class="hs-identifier hs-var">config</span></a><span> </span><a href="#local-6989586621679033493"><span class="hs-identifier hs-var">sylCount</span></a><span> </span><a href="#local-6989586621679033494"><span class="hs-identifier hs-var">lineCount</span></a><span> </span><a href="#local-6989586621679033496"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-768"></a><span>
</span><a name="line-769"></a><span class="hs-comment">-- * Building the Ark</span><span>
</span><a name="line-770"></a><span>
</span><a name="line-771"></a><span class="hs-comment">-- ** Data structures for input to build the ark</span><span>
</span><a name="line-772"></a><span>
</span><a name="line-773"></a><span class="hs-comment">-- | Voice permutation data: 1-indexed pitch numbers, sets of four voices</span><span>
</span><a name="line-774"></a><span class="hs-comment">-- each, usually ten sets per column</span><span>
</span><a name="line-775"></a><span class="hs-keyword">type</span><span> </span><a name="VpermTableInput"><a href="Aedifico.html#VpermTableInput"><span class="hs-identifier">VpermTableInput</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Aedifico.html#Vperm"><span class="hs-identifier hs-type">Vperm</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-776"></a><span>
</span><a name="line-777"></a><span class="hs-comment">-- | Rhythm permutation data: 'Dur' values, three sets for different meters,</span><span>
</span><a name="line-778"></a><span class="hs-comment">-- each containing either one set per voice permutation set (/syntagma I/) or</span><span>
</span><a name="line-779"></a><span class="hs-comment">-- a four-voice set to match (/syntagma II/)</span><span>
</span><a name="line-780"></a><span class="hs-keyword">type</span><span> </span><a name="RpermTableInput"><a href="Aedifico.html#RpermTableInput"><span class="hs-identifier">RpermTableInput</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Aedifico.html#Rperm"><span class="hs-identifier hs-type">Rperm</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-781"></a><span>
</span><a name="line-782"></a><span class="hs-comment">-- | Column data: Pairs of input data for voice and rhythm permutations</span><span>
</span><a name="line-783"></a><span class="hs-keyword">type</span><span> </span><a name="ColumnInput"><a href="Aedifico.html#ColumnInput"><span class="hs-identifier">ColumnInput</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#VpermTableInput"><span class="hs-identifier hs-type">VpermTableInput</span></a><span class="hs-special">,</span><span> </span><a href="Aedifico.html#RpermTableInput"><span class="hs-identifier hs-type">RpermTableInput</span></a><span class="hs-special">)</span><span>
</span><a name="line-784"></a><span>
</span><a name="line-785"></a><span class="hs-comment">-- | Pinax data: List of data for columns</span><span>
</span><a name="line-786"></a><span class="hs-keyword">type</span><span> </span><a name="PinaxInput"><a href="Aedifico.html#PinaxInput"><span class="hs-identifier">PinaxInput</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#ColumnInput"><span class="hs-identifier hs-type">ColumnInput</span></a><span class="hs-special">]</span><span>
</span><a name="line-787"></a><span>
</span><a name="line-788"></a><span class="hs-comment">-- ** Transforming input data to ark structures</span><span>
</span><a name="line-789"></a><span>
</span><a name="line-790"></a><span class="hs-comment">-- | To build the ark from the data in the @Arca/@ directory, we must take a</span><span>
</span><a name="line-791"></a><span class="hs-comment">-- singly nested list and make it into a vector of vectors. This allows for</span><span>
</span><a name="line-792"></a><span class="hs-comment">-- the data to be input and maintained more simply, as a nested list of</span><span>
</span><a name="line-793"></a><span class="hs-comment">-- integers and strings, but then converted to vectors for better</span><span>
</span><a name="line-794"></a><span class="hs-comment">-- performance.</span><span>
</span><a name="line-795"></a><span class="hs-comment">-- The innermost layer stays in list format.</span><span>
</span><a name="line-796"></a><span class="hs-comment">--</span><span>
</span><a name="line-797"></a><span class="hs-comment">-- __TODO__: Optimize?</span><span>
</span><a name="line-798"></a><span class="hs-identifier">fromList2D</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679031336"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031336"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-799"></a><a name="fromList2D"><a href="Aedifico.html#fromList2D"><span class="hs-identifier">fromList2D</span></a></a><span> </span><a name="local-6989586621679033499"><a href="#local-6989586621679033499"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679033500"><span class="hs-identifier hs-var">inner</span></a><span>
</span><a name="line-800"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-801"></a><span>        </span><a name="local-6989586621679033500"><a href="#local-6989586621679033500"><span class="hs-identifier">inner</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679033499"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-802"></a><span>
</span><a name="line-803"></a><span class="hs-comment">-- | Make a new 'VpermTable' that knows its own length: Application of</span><span>
</span><a name="line-804"></a><span class="hs-comment">-- 'fromList2D' to 'Vperm'</span><span>
</span><a name="line-805"></a><span class="hs-identifier">buildVpermTable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#VpermTableInput"><span class="hs-identifier hs-type">VpermTableInput</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#VpermTable"><span class="hs-identifier hs-type">VpermTable</span></a><span>
</span><a name="line-806"></a><a name="buildVpermTable"><a href="Aedifico.html#buildVpermTable"><span class="hs-identifier">buildVpermTable</span></a></a><span> </span><a name="local-6989586621679033501"><a href="#local-6989586621679033501"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#VpermTable"><span class="hs-identifier hs-var">VpermTable</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-807"></a><span>    </span><span class="hs-identifier">vpermMax</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679033501"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span>
</span><a name="line-808"></a><span>    </span><span class="hs-identifier">vperms</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#fromList2D"><span class="hs-identifier hs-var">fromList2D</span></a><span> </span><a href="#local-6989586621679033501"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-809"></a><span class="hs-special">}</span><span>
</span><a name="line-810"></a><span>
</span><a name="line-811"></a><span class="hs-comment">-- | Make a new 'RpermMeter' that knows its own length.</span><span>
</span><a name="line-812"></a><span class="hs-identifier">newRpermMeter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Aedifico.html#Rperm"><span class="hs-identifier hs-type">Rperm</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#RpermMeter"><span class="hs-identifier hs-type">RpermMeter</span></a><span>
</span><a name="line-813"></a><a name="newRpermMeter"><a href="Aedifico.html#newRpermMeter"><span class="hs-identifier">newRpermMeter</span></a></a><span> </span><a name="local-6989586621679033502"><a href="#local-6989586621679033502"><span class="hs-identifier">theseRperms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#RpermMeter"><span class="hs-identifier hs-var">RpermMeter</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-814"></a><span>    </span><span class="hs-identifier">rpermMax</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679033502"><span class="hs-identifier hs-var">theseRperms</span></a><span class="hs-special">,</span><span>
</span><a name="line-815"></a><span>    </span><span class="hs-identifier">rperms</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#fromList2D"><span class="hs-identifier hs-var">fromList2D</span></a><span> </span><a href="#local-6989586621679033502"><span class="hs-identifier hs-var">theseRperms</span></a><span>
</span><a name="line-816"></a><span class="hs-special">}</span><span>
</span><a name="line-817"></a><span>
</span><a name="line-818"></a><span class="hs-comment">-- | Build an 'RpermTable' with 'RpermMeter's that know their length.</span><span>
</span><a name="line-819"></a><span class="hs-identifier">buildRpermTable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#RpermTableInput"><span class="hs-identifier hs-type">RpermTableInput</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#RpermTable"><span class="hs-identifier hs-type">RpermTable</span></a><span>
</span><a name="line-820"></a><a name="buildRpermTable"><a href="Aedifico.html#buildRpermTable"><span class="hs-identifier">buildRpermTable</span></a></a><span> </span><a name="local-6989586621679033503"><a href="#local-6989586621679033503"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Aedifico.html#newRpermMeter"><span class="hs-identifier hs-var">newRpermMeter</span></a><span> </span><a href="#local-6989586621679033503"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-821"></a><span>
</span><a name="line-822"></a><span class="hs-comment">-- | Build a 'Column' directly from input data: two nested lists, one for all</span><span>
</span><a name="line-823"></a><span class="hs-comment">-- the voice permutations in the column and the other for all the rhythm</span><span>
</span><a name="line-824"></a><span class="hs-comment">-- permutations.</span><span>
</span><a name="line-825"></a><span class="hs-comment">-- Because we are manually entering Kircher's data for the ark we do not check</span><span>
</span><a name="line-826"></a><span class="hs-comment">-- for validity here, and there are several variations across the /syntagmata/</span><span>
</span><a name="line-827"></a><span class="hs-comment">-- and /pinakes/ in how the data is structured.</span><span>
</span><a name="line-828"></a><span class="hs-identifier">buildColumn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#ColumnInput"><span class="hs-identifier hs-type">ColumnInput</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Column"><span class="hs-identifier hs-type">Column</span></a><span>
</span><a name="line-829"></a><a name="buildColumn"><a href="Aedifico.html#buildColumn"><span class="hs-identifier">buildColumn</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033504"><a href="#local-6989586621679033504"><span class="hs-identifier">vperms</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679033505"><a href="#local-6989586621679033505"><span class="hs-identifier">rperms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#Column"><span class="hs-identifier hs-var">Column</span></a><span> </span><span class="hs-special">(</span><a href="Aedifico.html#buildVpermTable"><span class="hs-identifier hs-var">buildVpermTable</span></a><span> </span><a href="#local-6989586621679033504"><span class="hs-identifier hs-var">vperms</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Aedifico.html#buildRpermTable"><span class="hs-identifier hs-var">buildRpermTable</span></a><span> </span><a href="#local-6989586621679033505"><span class="hs-identifier hs-var">rperms</span></a><span class="hs-special">)</span><span>
</span><a name="line-830"></a><span>
</span><a name="line-831"></a><span class="hs-comment">-- | Build a 'Pinax' from pairs of 'VpermTable' and 'RpermTable' data</span><span>
</span><a name="line-832"></a><span class="hs-identifier">buildPinax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#PinaxInput"><span class="hs-identifier hs-type">PinaxInput</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Pinax"><span class="hs-identifier hs-type">Pinax</span></a><span>
</span><a name="line-833"></a><a name="buildPinax"><a href="Aedifico.html#buildPinax"><span class="hs-identifier">buildPinax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Aedifico.html#buildColumn"><span class="hs-identifier hs-var">buildColumn</span></a><span class="hs-special">)</span><span>
</span><a name="line-834"></a><span>
</span><a name="line-835"></a><span class="hs-comment">-- | Build a 'Syntagma' from constructed 'Pinax' items (not from raw input)</span><span>
</span><a name="line-836"></a><span class="hs-identifier">buildSyntagma</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Aedifico.html#Pinax"><span class="hs-identifier hs-type">Pinax</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Syntagma"><span class="hs-identifier hs-type">Syntagma</span></a><span>
</span><a name="line-837"></a><a name="buildSyntagma"><a href="Aedifico.html#buildSyntagma"><span class="hs-identifier">buildSyntagma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromList</span><span>
</span><a name="line-838"></a><span>
</span><a name="line-839"></a><span class="hs-comment">-- * Pull out values simply for testing</span><span>
</span><a name="line-840"></a><span>
</span><a name="line-841"></a><span class="hs-comment">-- | Pull out a single 'Column' given indices</span><span>
</span><a name="line-842"></a><span class="hs-identifier">columnFromArca</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span>
</span><a name="line-843"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ syntagma index</span><span>
</span><a name="line-844"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ pinax index</span><span>
</span><a name="line-845"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ column index</span><span>
</span><a name="line-846"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Column"><span class="hs-identifier hs-type">Column</span></a><span>
</span><a name="line-847"></a><a name="columnFromArca"><a href="Aedifico.html#columnFromArca"><span class="hs-identifier">columnFromArca</span></a></a><span> </span><a name="local-6989586621679033506"><a href="#local-6989586621679033506"><span class="hs-identifier">arca</span></a></a><span> </span><a name="local-6989586621679033507"><a href="#local-6989586621679033507"><span class="hs-identifier">syntagmaNum</span></a></a><span> </span><a name="local-6989586621679033508"><a href="#local-6989586621679033508"><span class="hs-identifier">pinaxNum</span></a></a><span> </span><a name="local-6989586621679033509"><a href="#local-6989586621679033509"><span class="hs-identifier">columnNum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033510"><span class="hs-identifier hs-var">thisColumn</span></a><span>
</span><a name="line-848"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-849"></a><span>        </span><a name="local-6989586621679033510"><a href="#local-6989586621679033510"><span class="hs-identifier">thisColumn</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;columnFromArca&quot;</span><span> </span><a href="#local-6989586621679033511"><span class="hs-identifier hs-var">thisPinax</span></a><span> </span><a href="#local-6989586621679033509"><span class="hs-identifier hs-var">columnNum</span></a><span>
</span><a name="line-850"></a><span>        </span><a name="local-6989586621679033511"><a href="#local-6989586621679033511"><span class="hs-identifier">thisPinax</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;columnFromArca:pinax&quot;</span><span> </span><a href="#local-6989586621679033512"><span class="hs-identifier hs-var">thisSyntagma</span></a><span> </span><a href="#local-6989586621679033508"><span class="hs-identifier hs-var">pinaxNum</span></a><span>
</span><a name="line-851"></a><span>        </span><a name="local-6989586621679033512"><a href="#local-6989586621679033512"><span class="hs-identifier">thisSyntagma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;columnFromArca:syntagma&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">perms</span><span> </span><a href="#local-6989586621679033506"><span class="hs-identifier hs-var">arca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033507"><span class="hs-identifier hs-var">syntagmaNum</span></a><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span class="hs-comment">-- | Pull out a single 'Vperm', which is a list of 'Int'</span><span>
</span><a name="line-854"></a><span class="hs-identifier">vpermFromArca</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span>
</span><a name="line-855"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ syntagma index</span><span>
</span><a name="line-856"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ pinax index</span><span>
</span><a name="line-857"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ column index</span><span>
</span><a name="line-858"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ vperm (row) index</span><span>
</span><a name="line-859"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ voice (SATB) index</span><span>
</span><a name="line-860"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Vperm"><span class="hs-identifier hs-type">Vperm</span></a><span>
</span><a name="line-861"></a><a name="vpermFromArca"><a href="Aedifico.html#vpermFromArca"><span class="hs-identifier">vpermFromArca</span></a></a><span> </span><a name="local-6989586621679033513"><a href="#local-6989586621679033513"><span class="hs-identifier">arca</span></a></a><span> </span><a name="local-6989586621679033514"><a href="#local-6989586621679033514"><span class="hs-identifier">syntagmaNum</span></a></a><span> </span><a name="local-6989586621679033515"><a href="#local-6989586621679033515"><span class="hs-identifier">pinaxNum</span></a></a><span> </span><a name="local-6989586621679033516"><a href="#local-6989586621679033516"><span class="hs-identifier">columnNum</span></a></a><span> </span><a name="local-6989586621679033517"><a href="#local-6989586621679033517"><span class="hs-identifier">vpermNum</span></a></a><span> </span><a name="local-6989586621679033518"><a href="#local-6989586621679033518"><span class="hs-identifier">voiceNum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033519"><span class="hs-identifier hs-var">thisVoice</span></a><span>
</span><a name="line-862"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-863"></a><span>        </span><a name="local-6989586621679033519"><a href="#local-6989586621679033519"><span class="hs-identifier">thisVoice</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;vpermFromArca:voice&quot;</span><span> </span><a href="#local-6989586621679033520"><span class="hs-identifier hs-var">thisVperm</span></a><span> </span><a href="#local-6989586621679033518"><span class="hs-identifier hs-var">voiceNum</span></a><span>
</span><a name="line-864"></a><span>        </span><a name="local-6989586621679033520"><a href="#local-6989586621679033520"><span class="hs-identifier">thisVperm</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;vpermFromArca:vperm&quot;</span><span> </span><a href="#local-6989586621679033521"><span class="hs-identifier hs-var">vpermTable</span></a><span> </span><a href="#local-6989586621679033517"><span class="hs-identifier hs-var">vpermNum</span></a><span>
</span><a name="line-865"></a><span>        </span><a name="local-6989586621679033521"><a href="#local-6989586621679033521"><span class="hs-identifier">vpermTable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">vperms</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">colVpermTable</span><span> </span><a href="#local-6989586621679033522"><span class="hs-identifier hs-var">thisColumn</span></a><span>
</span><a name="line-866"></a><span>        </span><a name="local-6989586621679033522"><a href="#local-6989586621679033522"><span class="hs-identifier">thisColumn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#columnFromArca"><span class="hs-identifier hs-var">columnFromArca</span></a><span> </span><a href="#local-6989586621679033513"><span class="hs-identifier hs-var">arca</span></a><span> </span><a href="#local-6989586621679033514"><span class="hs-identifier hs-var">syntagmaNum</span></a><span> </span><a href="#local-6989586621679033515"><span class="hs-identifier hs-var">pinaxNum</span></a><span> </span><a href="#local-6989586621679033516"><span class="hs-identifier hs-var">columnNum</span></a><span>
</span><a name="line-867"></a><span>
</span><a name="line-868"></a><span class="hs-comment">-- | Pull out a single 'Rperm', which is a list of 'Dur'</span><span>
</span><a name="line-869"></a><span class="hs-identifier">rpermFromArca</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#Arca"><span class="hs-identifier hs-type">Arca</span></a><span>
</span><a name="line-870"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ syntagma index</span><span>
</span><a name="line-871"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ pinax index</span><span>
</span><a name="line-872"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ column index</span><span>
</span><a name="line-873"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ meter index</span><span>
</span><a name="line-874"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ rperm index</span><span>
</span><a name="line-875"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ voice index</span><span>
</span><a name="line-876"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Rperm"><span class="hs-identifier hs-type">Rperm</span></a><span>
</span><a name="line-877"></a><a name="rpermFromArca"><a href="Aedifico.html#rpermFromArca"><span class="hs-identifier">rpermFromArca</span></a></a><span> </span><a name="local-6989586621679033523"><a href="#local-6989586621679033523"><span class="hs-identifier">arca</span></a></a><span> </span><a name="local-6989586621679033524"><a href="#local-6989586621679033524"><span class="hs-identifier">syntagmaNum</span></a></a><span> </span><a name="local-6989586621679033525"><a href="#local-6989586621679033525"><span class="hs-identifier">pinaxNum</span></a></a><span> </span><a name="local-6989586621679033526"><a href="#local-6989586621679033526"><span class="hs-identifier">columnNum</span></a></a><span> </span><a name="local-6989586621679033527"><a href="#local-6989586621679033527"><span class="hs-identifier">meterNum</span></a></a><span> </span><a name="local-6989586621679033528"><a href="#local-6989586621679033528"><span class="hs-identifier">rpermNum</span></a></a><span> </span><a name="local-6989586621679033529"><a href="#local-6989586621679033529"><span class="hs-identifier">voiceNum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033530"><span class="hs-identifier hs-var">thisRperm</span></a><span>
</span><a name="line-878"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-879"></a><span>        </span><a name="local-6989586621679033530"><a href="#local-6989586621679033530"><span class="hs-identifier">thisRperm</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;rpermFromArca:rperm&quot;</span><span> </span><a href="#local-6989586621679033531"><span class="hs-identifier hs-var">thisRpermMeter</span></a><span> </span><a href="#local-6989586621679033529"><span class="hs-identifier hs-var">voiceNum</span></a><span>
</span><a name="line-880"></a><span>        </span><a name="local-6989586621679033531"><a href="#local-6989586621679033531"><span class="hs-identifier">thisRpermMeter</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;rpermFromArca:rpermChoir&quot;</span><span> </span><a href="#local-6989586621679033532"><span class="hs-identifier hs-var">thisRpermChoir</span></a><span> </span><a href="#local-6989586621679033528"><span class="hs-identifier hs-var">rpermNum</span></a><span>
</span><a name="line-881"></a><span>        </span><a name="local-6989586621679033532"><a href="#local-6989586621679033532"><span class="hs-identifier">thisRpermChoir</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rperms</span><span>
</span><a name="line-882"></a><span>            </span><span class="hs-operator hs-var">$</span><span> </span><a href="Aedifico.html#getVectorItem"><span class="hs-identifier hs-var">getVectorItem</span></a><span> </span><span class="hs-string">&quot;rpermFromArca:rpermTable&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">colRpermTable</span><span> </span><a href="#local-6989586621679033533"><span class="hs-identifier hs-var">thisColumn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033527"><span class="hs-identifier hs-var">meterNum</span></a><span>
</span><a name="line-883"></a><span>        </span><a name="local-6989586621679033533"><a href="#local-6989586621679033533"><span class="hs-identifier">thisColumn</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#columnFromArca"><span class="hs-identifier hs-var">columnFromArca</span></a><span> </span><a href="#local-6989586621679033523"><span class="hs-identifier hs-var">arca</span></a><span> </span><a href="#local-6989586621679033524"><span class="hs-identifier hs-var">syntagmaNum</span></a><span> </span><a href="#local-6989586621679033525"><span class="hs-identifier hs-var">pinaxNum</span></a><span> </span><a href="#local-6989586621679033526"><span class="hs-identifier hs-var">columnNum</span></a><span>
</span><a name="line-884"></a><span>
</span><a name="line-885"></a><span>
</span><a name="line-886"></a></pre></body></html>