<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Lectio
Description : Read and process input text to be set to music
Copyright   : (c) Andrew A. Cashner 2021
Maintainer  : Andrew Cashner, &lt;andrew.cashner@rochester.edu&gt;
Stability   : Experimental

This module reads (/lectio/, Latin, &quot;I read&quot;) and process input text to be set
to music using the ark. 

= Kircher's specification

Kircher expects the user to prepare a text by segmenting it into phrases
according to the poetic meter and prosody.  In his description the texts are
Latin, but he also demonstrates how the machine could be used with Aramaic and
other languages, ideally by Jesuit missionaries.

= Implementation
== XML input

In our implementation we also expect the user to mark the input text by
dividing the syllables with hyphens and marking the long syllables with accent
symbols (@`@, placed before the relevant syllable), for example:

&gt; Lau-`da-te `Do-mi-num `om-nis `ter-rae. Al-le-`lu-ia. A-`men.

This implementation takes input in the form of an XML document, in which the
text is syllabified and accented as just demonstrated, and divided into one or
more sections. In the attributes for each @\&lt;section\&gt;@ element, the user sets
the values we need as input for the ark:

[@textMeter@]:  e.g., @Prose@ or @Adonium@
[@musicMeter@]: @Duple@, @TripleMinor@, or @TripleMajor@
[@style@]:      @Simple@ (= Syntagma I) or @Florid@ (= Syntagma II)
[@mode@]:       e.g., @Mode1@

Within each section the text is divided into one or more line groups (@\&lt;lg\&gt;@)
and lines (@\&lt;l\&gt;@). (These elements are borrowed from TEI.)

=== __TODO__

In Prose meter, Kircher leaves it up to the user to divide the text into
phrases. We are currently using a very simple algorithm to divide the
text into phrase groups within the correct size range. It would be
better to use a more sophisticated algorithm to parse the text into
optimal groups.

== Reading and parsing the input file

The main function is 'prepareInput', which reads and parses the file and produces a list of 'LyricSection's.

This module reads the input file, parses the XML tree to extract the text and
needed parameters for setting the text (within each section), and then
packages the text into its own data structures to pass on to the other parts
of the program (@Cogito@ for processing and @Scribo@ for writing output).

=== Capturing XML data

The text is first grouped into intermediate data structures that closely
reflect the XML structure. Each @\&lt;section\&gt;@ becomes an 'ArkTextSection',
containing a nested list of strings (line groups and lines from XML) and an
'Aedifico.ArkConfig' with the parameters from the XML section attributes. The list of
these is packaged into a single 'ArkInput' structure containing metadata for
the whole document (taken from the XML @\&lt;head\&gt;@), and a list of
'ArkTextSection's.

=== Preparing for musical setting

The module then processes this data and converts it into a list of
'LyricSection's that the other modules will use.  Below are the structures
that are passed on to other modules, from top down.  Each structure contains
the element below it, plus information about it (length, number of syllables,
etc.). To get that information, these structures are created with methods that
calculate the data upfront.

['LyricSection']: group of sentences (from @\&lt;section\&gt;@)

  * also contains an 'Aedifico.ArkConfig' with the text-setting parameters

['LyricSentence']: group of phrases (from @\&lt;lg\&gt;@)

['LyricPhrase']: group of words (from @\&lt;l\&gt;@)

['Verbum']: individual word, broken into syllables

-}</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lectio</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isSpace</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropWhileEnd</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.Split</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordsBy</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-100"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.XML.Light</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span> </span><a href="Aedifico.html"><span class="hs-identifier">Aedifico</span></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-type">ArkConfig</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span>      </span><span class="hs-special">(</span><a href="Aedifico.html#ModeUnset"><span class="hs-identifier hs-var">ModeUnset</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#TextMeter"><span class="hs-identifier hs-type">TextMeter</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#toStyle"><span class="hs-identifier hs-var">toStyle</span></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#toMode"><span class="hs-identifier hs-var">toMode</span></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#toMusicMeter"><span class="hs-identifier hs-var">toMusicMeter</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#toTextMeter"><span class="hs-identifier hs-var">toTextMeter</span></a><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#maxSyllables"><span class="hs-identifier hs-var">maxSyllables</span></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#PenultLength"><span class="hs-identifier hs-type">PenultLength</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-type">ArkConfig</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- * Read input file</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- ** Global settings for input format</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- | The character used to demarcate syllables (default @\'-\'@)</span><span>
</span><a name="line-122"></a><a name="hyphenChar"><a href="Lectio.html#hyphenChar"><span class="hs-identifier">hyphenChar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'-'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-comment">-- | The character used at the beginning of syllables to show long (or</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- accented) syllables (default @\'\`\'@)</span><span>
</span><a name="line-126"></a><a name="accentChar"><a href="Lectio.html#accentChar"><span class="hs-identifier">accentChar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'`'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">-- ** Storing XML data</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- | Header information</span><span>
</span><a name="line-131"></a><span class="hs-keyword">data</span><span> </span><a name="ArkMetadata"><a href="Lectio.html#ArkMetadata"><span class="hs-identifier">ArkMetadata</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ArkMetadata"><a href="Lectio.html#ArkMetadata"><span class="hs-identifier">ArkMetadata</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-132"></a><span>    </span><a name="arkTitle"><a href="Lectio.html#arkTitle"><span class="hs-identifier">arkTitle</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span>
</span><a name="line-133"></a><span>    </span><a name="arkWordsAuthor"><a href="Lectio.html#arkWordsAuthor"><span class="hs-identifier">arkWordsAuthor</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-134"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Show</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | The input to the ark is an 'ArkConfig' element with mode, style, and</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- meter; and a list of strings, each of which will become a 'LyricSentence'</span><span>
</span><a name="line-138"></a><span class="hs-keyword">data</span><span> </span><a name="ArkInput"><a href="Lectio.html#ArkInput"><span class="hs-identifier">ArkInput</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ArkInput"><a href="Lectio.html#ArkInput"><span class="hs-identifier">ArkInput</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-139"></a><span>    </span><a name="arkMetadata"><a href="Lectio.html#arkMetadata"><span class="hs-identifier">arkMetadata</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lectio.html#ArkMetadata"><span class="hs-identifier hs-type">ArkMetadata</span></a><span class="hs-special">,</span><span>
</span><a name="line-140"></a><span>    </span><a name="arkTextSections"><a href="Lectio.html#arkTextSections"><span class="hs-identifier">arkTextSections</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#ArkTextSection"><span class="hs-identifier hs-type">ArkTextSection</span></a><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Show</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- | A section of input text (from xml section element)</span><span>
</span><a name="line-144"></a><span class="hs-keyword">data</span><span> </span><a name="ArkTextSection"><a href="Lectio.html#ArkTextSection"><span class="hs-identifier">ArkTextSection</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ArkTextSection"><a href="Lectio.html#ArkTextSection"><span class="hs-identifier">ArkTextSection</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-145"></a><span>    </span><a name="arkConfig"><a href="Lectio.html#arkConfig"><span class="hs-identifier">arkConfig</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-type">ArkConfig</span></a><span class="hs-special">,</span><span>
</span><a name="line-146"></a><span>    </span><a name="arkText"><a href="Lectio.html#arkText"><span class="hs-identifier">arkText</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ list of @\&lt;lg\@&gt; containing lists of @\&lt;l\&gt;@</span><span>
</span><a name="line-147"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Show</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | Create a 'QName' to search the xml tree</span><span>
</span><a name="line-151"></a><span class="hs-identifier">xmlSearch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">QName</span><span>
</span><a name="line-152"></a><a name="xmlSearch"><a href="Lectio.html#xmlSearch"><span class="hs-identifier">xmlSearch</span></a></a><span> </span><a name="local-6989586621679113228"><a href="#local-6989586621679113228"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">QName</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-identifier">qName</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113228"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-identifier">qURI</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier">qPrefix</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-156"></a><span class="hs-special">}</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- | Get the text from a node</span><span>
</span><a name="line-159"></a><span class="hs-identifier">xmlNodeText</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ element name</span><span>
</span><a name="line-160"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Element</span><span>  </span><span class="hs-comment">-- ^ the node</span><span>
</span><a name="line-161"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>   </span><span class="hs-comment">-- ^ node text</span><span>
</span><a name="line-162"></a><a name="xmlNodeText"><a href="Lectio.html#xmlNodeText"><span class="hs-identifier">xmlNodeText</span></a></a><span> </span><a name="local-6989586621679113229"><a href="#local-6989586621679113229"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679113230"><a href="#local-6989586621679113230"><span class="hs-identifier">tree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">strContent</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679113231"><span class="hs-identifier hs-var">element</span></a><span>
</span><a name="line-163"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-164"></a><span>        </span><a name="local-6989586621679113231"><a href="#local-6989586621679113231"><span class="hs-identifier">element</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">findElement</span><span> </span><a href="#local-6989586621679113232"><span class="hs-identifier hs-var">searchName</span></a><span> </span><a href="#local-6989586621679113230"><span class="hs-identifier hs-var">tree</span></a><span>
</span><a name="line-165"></a><span>        </span><a name="local-6989586621679113232"><a href="#local-6989586621679113232"><span class="hs-identifier">searchName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#xmlSearch"><span class="hs-identifier hs-var">xmlSearch</span></a><span> </span><a href="#local-6989586621679113229"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | For each string in list, break text into strings at newlines, strip leading and trailing</span><span>
</span><a name="line-168"></a><span class="hs-comment">-- whitespace, remove empty strings, remove newlines</span><span>
</span><a name="line-169"></a><span class="hs-identifier">cleanUpText</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-170"></a><a name="cleanUpText"><a href="Lectio.html#cleanUpText"><span class="hs-identifier">cleanUpText</span></a></a><span> </span><a name="local-6989586621679113277"><a href="#local-6989586621679113277"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679113278"><a href="#local-6989586621679113278"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">null</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Lectio.html#strip"><span class="hs-identifier hs-var">strip</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621679113278"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113277"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">-- | Strip leading and trailing whitespace from a 'String'</span><span>
</span><a name="line-173"></a><span class="hs-identifier">strip</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-174"></a><a name="strip"><a href="Lectio.html#strip"><span class="hs-identifier">strip</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">dropWhileEnd</span><span> </span><span class="hs-identifier hs-var">isSpace</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-identifier hs-var">isSpace</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">-- | Read an XML string and return the data for input to the ark ('ArkInput')</span><span>
</span><a name="line-177"></a><span class="hs-identifier">readInput</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#ArkInput"><span class="hs-identifier hs-type">ArkInput</span></a><span>
</span><a name="line-178"></a><a name="readInput"><a href="Lectio.html#readInput"><span class="hs-identifier">readInput</span></a></a><span> </span><a name="local-6989586621679113617"><a href="#local-6989586621679113617"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#ArkInput"><span class="hs-identifier hs-var">ArkInput</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-179"></a><span>            </span><span class="hs-identifier">arkMetadata</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#ArkMetadata"><span class="hs-identifier hs-var">ArkMetadata</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-180"></a><span>                </span><span class="hs-identifier">arkTitle</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113620"><span class="hs-identifier hs-var">title</span></a><span class="hs-special">,</span><span>
</span><a name="line-181"></a><span>                </span><span class="hs-identifier">arkWordsAuthor</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113621"><span class="hs-identifier hs-var">author</span></a><span>
</span><a name="line-182"></a><span>            </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><a name="line-183"></a><span>            </span><span class="hs-identifier">arkTextSections</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113624"><span class="hs-identifier hs-var">sections</span></a><span>
</span><a name="line-184"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-185"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-186"></a><span>            </span><a name="local-6989586621679113618"><a href="#local-6989586621679113618"><span class="hs-identifier">xml</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">parseXMLDoc</span><span> </span><a href="#local-6989586621679113617"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span>            </span><a name="local-6989586621679113619"><a href="#local-6989586621679113619"><span class="hs-identifier">head</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">findElement</span><span> </span><span class="hs-special">(</span><a href="Lectio.html#xmlSearch"><span class="hs-identifier hs-var">xmlSearch</span></a><span> </span><span class="hs-string">&quot;head&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113618"><span class="hs-identifier hs-var">xml</span></a><span>
</span><a name="line-189"></a><span>            </span><a name="local-6989586621679113620"><a href="#local-6989586621679113620"><span class="hs-identifier">title</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#xmlNodeText"><span class="hs-identifier hs-var">xmlNodeText</span></a><span> </span><span class="hs-string">&quot;title&quot;</span><span> </span><a href="#local-6989586621679113619"><span class="hs-identifier hs-var">head</span></a><span>
</span><a name="line-190"></a><span>            </span><a name="local-6989586621679113621"><a href="#local-6989586621679113621"><span class="hs-identifier">author</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#xmlNodeText"><span class="hs-identifier hs-var">xmlNodeText</span></a><span> </span><span class="hs-string">&quot;wordsAuthor&quot;</span><span> </span><a href="#local-6989586621679113619"><span class="hs-identifier hs-var">head</span></a><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span>            </span><a name="local-6989586621679113622"><a href="#local-6989586621679113622"><span class="hs-identifier">xText</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">findElement</span><span> </span><span class="hs-special">(</span><a href="Lectio.html#xmlSearch"><span class="hs-identifier hs-var">xmlSearch</span></a><span> </span><span class="hs-string">&quot;text&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113618"><span class="hs-identifier hs-var">xml</span></a><span>
</span><a name="line-193"></a><span>            </span><a name="local-6989586621679113623"><a href="#local-6989586621679113623"><span class="hs-identifier">xSections</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">findChildren</span><span> </span><span class="hs-special">(</span><a href="Lectio.html#xmlSearch"><span class="hs-identifier hs-var">xmlSearch</span></a><span> </span><span class="hs-string">&quot;section&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113622"><span class="hs-identifier hs-var">xText</span></a><span>
</span><a name="line-194"></a><span>            </span><a name="local-6989586621679113624"><a href="#local-6989586621679113624"><span class="hs-identifier">sections</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Lectio.html#parseSection"><span class="hs-identifier hs-var">parseSection</span></a><span> </span><a href="#local-6989586621679113623"><span class="hs-identifier hs-var">xSections</span></a><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- | Parse an XML node tree into a section with configuration and parsed text.</span><span>
</span><a name="line-197"></a><span class="hs-identifier">parseSection</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Element</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#ArkTextSection"><span class="hs-identifier hs-type">ArkTextSection</span></a><span>
</span><a name="line-198"></a><a name="parseSection"><a href="Lectio.html#parseSection"><span class="hs-identifier">parseSection</span></a></a><span> </span><a name="local-6989586621679113648"><a href="#local-6989586621679113648"><span class="hs-identifier">xSection</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#ArkTextSection"><span class="hs-identifier hs-var">ArkTextSection</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-identifier">arkConfig</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113649"><span class="hs-identifier hs-var">sectionConfig</span></a><span class="hs-special">,</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-identifier">arkText</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113652"><span class="hs-identifier hs-var">getText</span></a><span>
</span><a name="line-201"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span>    </span><a name="local-6989586621679113649"><a href="#local-6989586621679113649"><span class="hs-identifier">sectionConfig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-var">ArkConfig</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-204"></a><span>        </span><span class="hs-identifier">arkStyle</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#toStyle"><span class="hs-identifier hs-var">toStyle</span></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679113650"><span class="hs-identifier hs-var">getSetting</span></a><span> </span><a href="#local-6989586621679113648"><span class="hs-identifier hs-var">xSection</span></a><span> </span><span class="hs-string">&quot;style&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-205"></a><span>        </span><span class="hs-identifier">arkMode</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#toMode"><span class="hs-identifier hs-var">toMode</span></a><span>       </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679113650"><span class="hs-identifier hs-var">getSetting</span></a><span> </span><a href="#local-6989586621679113648"><span class="hs-identifier hs-var">xSection</span></a><span> </span><span class="hs-string">&quot;mode&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-206"></a><span>        </span><span class="hs-identifier">arkModeB</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113651"><span class="hs-identifier hs-var">toModeB</span></a><span> </span><a href="#local-6989586621679113648"><span class="hs-identifier hs-var">xSection</span></a><span> </span><span class="hs-string">&quot;modeB&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-207"></a><span>        </span><span class="hs-identifier">arkMusicMeter</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#toMusicMeter"><span class="hs-identifier hs-var">toMusicMeter</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679113650"><span class="hs-identifier hs-var">getSetting</span></a><span> </span><a href="#local-6989586621679113648"><span class="hs-identifier hs-var">xSection</span></a><span> </span><span class="hs-string">&quot;musicMeter&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-208"></a><span>        </span><span class="hs-identifier">arkTextMeter</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#toTextMeter"><span class="hs-identifier hs-var">toTextMeter</span></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679113650"><span class="hs-identifier hs-var">getSetting</span></a><span> </span><a href="#local-6989586621679113648"><span class="hs-identifier hs-var">xSection</span></a><span> </span><span class="hs-string">&quot;textMeter&quot;</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span>    </span><span class="hs-identifier">getSetting</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Element</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-212"></a><span>    </span><a name="local-6989586621679113650"><a href="#local-6989586621679113650"><span class="hs-identifier">getSetting</span></a></a><span> </span><a name="local-6989586621679113654"><a href="#local-6989586621679113654"><span class="hs-identifier">tree</span></a></a><span> </span><a name="local-6989586621679113655"><a href="#local-6989586621679113655"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-213"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679113656"><a href="#local-6989586621679113656"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">findAttr</span><span> </span><span class="hs-special">(</span><a href="Lectio.html#xmlSearch"><span class="hs-identifier hs-var">xmlSearch</span></a><span> </span><a href="#local-6989586621679113655"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113654"><span class="hs-identifier hs-var">tree</span></a><span>
</span><a name="line-214"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679113656"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-215"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Attribute @&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679113655"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; not found&quot;</span><span>
</span><a name="line-216"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679113657"><a href="#local-6989586621679113657"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679113657"><span class="hs-identifier hs-var">attr</span></a><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span>    </span><span class="hs-comment">-- | @modeB@ is optional; if omitted, leave unset</span><span>
</span><a name="line-219"></a><span>    </span><span class="hs-identifier">toModeB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Element</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span>
</span><a name="line-220"></a><span>    </span><a name="local-6989586621679113651"><a href="#local-6989586621679113651"><span class="hs-identifier">toModeB</span></a></a><span> </span><a name="local-6989586621679113658"><a href="#local-6989586621679113658"><span class="hs-identifier">tree</span></a></a><span> </span><a name="local-6989586621679113659"><a href="#local-6989586621679113659"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-221"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679113660"><a href="#local-6989586621679113660"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">findAttr</span><span> </span><span class="hs-special">(</span><a href="Lectio.html#xmlSearch"><span class="hs-identifier hs-var">xmlSearch</span></a><span> </span><a href="#local-6989586621679113659"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113658"><span class="hs-identifier hs-var">tree</span></a><span>
</span><a name="line-222"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679113660"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-223"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#ModeUnset"><span class="hs-identifier hs-var">ModeUnset</span></a><span>
</span><a name="line-224"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679113661"><a href="#local-6989586621679113661"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Aedifico.html#toMode"><span class="hs-identifier hs-var">toMode</span></a><span> </span><a href="#local-6989586621679113661"><span class="hs-identifier hs-var">attr</span></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span>    </span><a name="local-6989586621679113652"><a href="#local-6989586621679113652"><span class="hs-identifier">getText</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679113665"><a href="#local-6989586621679113665"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679113653"><span class="hs-identifier hs-var">cleanText</span></a><span> </span><a href="#local-6989586621679113665"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113662"><span class="hs-identifier hs-var">textLines</span></a><span>
</span><a name="line-227"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-228"></a><span>            </span><a name="local-6989586621679113662"><a href="#local-6989586621679113662"><span class="hs-identifier">textLines</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679113664"><a href="#local-6989586621679113664"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">findChildren</span><span> </span><span class="hs-special">(</span><a href="Lectio.html#xmlSearch"><span class="hs-identifier hs-var">xmlSearch</span></a><span> </span><span class="hs-string">&quot;l&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113664"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113663"><span class="hs-identifier hs-var">lineGroups</span></a><span>
</span><a name="line-229"></a><span>            </span><a name="local-6989586621679113663"><a href="#local-6989586621679113663"><span class="hs-identifier">lineGroups</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">findChildren</span><span> </span><span class="hs-special">(</span><a href="Lectio.html#xmlSearch"><span class="hs-identifier hs-var">xmlSearch</span></a><span> </span><span class="hs-string">&quot;lg&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113648"><span class="hs-identifier hs-var">xSection</span></a><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span>    </span><span class="hs-identifier">cleanText</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Element</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-232"></a><span>    </span><a name="local-6989586621679113653"><a href="#local-6989586621679113653"><span class="hs-identifier">cleanText</span></a></a><span> </span><a name="local-6989586621679113666"><a href="#local-6989586621679113666"><span class="hs-identifier">tree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#cleanUpText"><span class="hs-identifier hs-var">cleanUpText</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">strContent</span><span> </span><a href="#local-6989586621679113666"><span class="hs-identifier hs-var">tree</span></a><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">-- * Hierarchical text groupings by word, phrase, and sentence</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-comment">-- ** 'Verbum': Single words and syllables</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-comment">-- | Every syllable is either 'Long' or 'Short'.</span><span>
</span><a name="line-240"></a><span class="hs-keyword">type</span><span> </span><a name="SylLen"><a href="Lectio.html#SylLen"><span class="hs-identifier">SylLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#PenultLength"><span class="hs-identifier hs-type">PenultLength</span></a><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-comment">-- | Our data type for a word includes the original text of the word, that</span><span>
</span><a name="line-243"></a><span class="hs-comment">-- text chunked into syllables, the count of those syllables, and a marker of</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- whether the penultimate syllable is short or long.</span><span>
</span><a name="line-245"></a><span class="hs-keyword">data</span><span> </span><a name="Verbum"><a href="Lectio.html#Verbum"><span class="hs-identifier">Verbum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Verbum"><a href="Lectio.html#Verbum"><span class="hs-identifier">Verbum</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-246"></a><span>    </span><a name="verbumText"><a href="Lectio.html#verbumText"><span class="hs-identifier">verbumText</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- ^ original text</span><span>
</span><a name="line-247"></a><span>    </span><a name="verbumSyl"><a href="Lectio.html#verbumSyl"><span class="hs-identifier">verbumSyl</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ text divided into list of syllables</span><span>
</span><a name="line-248"></a><span>    </span><a name="sylCount"><a href="Lectio.html#sylCount"><span class="hs-identifier">sylCount</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- ^ number of syllables</span><span>
</span><a name="line-249"></a><span>    </span><a name="penultLength"><a href="Lectio.html#penultLength"><span class="hs-identifier">penultLength</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lectio.html#SylLen"><span class="hs-identifier hs-type">SylLen</span></a><span>      </span><span class="hs-comment">-- ^ length of next-to-last syllable</span><span>
</span><a name="line-250"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span class="hs-comment">-- ** 'LyricPhrase': Multiple words</span><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-comment">-- | A 'LyricPhrase' is a group of 'Verbum' items (words): it contains the list of</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- words, the total count of syllables in the phrase, and a marker for the</span><span>
</span><a name="line-256"></a><span class="hs-comment">-- phrase's penultimate syllable length.</span><span>
</span><a name="line-257"></a><span class="hs-keyword">data</span><span> </span><a name="LyricPhrase"><a href="Lectio.html#LyricPhrase"><span class="hs-identifier">LyricPhrase</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LyricPhrase"><a href="Lectio.html#LyricPhrase"><span class="hs-identifier">LyricPhrase</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-258"></a><span>    </span><a name="phraseText"><a href="Lectio.html#phraseText"><span class="hs-identifier">phraseText</span></a></a><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#Verbum"><span class="hs-identifier hs-type">Verbum</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ list of words</span><span>
</span><a name="line-259"></a><span>    </span><a name="phraseSylCount"><a href="Lectio.html#phraseSylCount"><span class="hs-identifier">phraseSylCount</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- ^ total syllables in all words</span><span>
</span><a name="line-260"></a><span>    </span><a name="phrasePenultLength"><a href="Lectio.html#phrasePenultLength"><span class="hs-identifier">phrasePenultLength</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Lectio.html#SylLen"><span class="hs-identifier hs-type">SylLen</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ length of next-to-last syllable </span><span>
</span><a name="line-261"></a><span>                                     </span><span class="hs-comment">--     in whole phrase</span><span>
</span><a name="line-262"></a><span>    </span><a name="phrasePosition"><a href="Lectio.html#phrasePosition"><span class="hs-identifier">phrasePosition</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>       </span><span class="hs-comment">-- ^ position in list of phrases</span><span>
</span><a name="line-263"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Lectio.html#LyricPhrase"><span class="hs-identifier hs-type">LyricPhrase</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-266"></a><span>    </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679112523"><a href="#local-6989586621679112523"><span class="hs-identifier">phrase</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-267"></a><span>        </span><span class="hs-keyword">let</span><span>
</span><a name="line-268"></a><span>            </span><a name="local-6989586621679112524"><a href="#local-6989586621679112524"><span class="hs-identifier">s</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">verbumText</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">phraseText</span><span> </span><a href="#local-6989586621679112523"><span class="hs-identifier hs-var">phrase</span></a><span>
</span><a name="line-269"></a><span>            </span><a name="local-6989586621679112525"><a href="#local-6989586621679112525"><span class="hs-identifier">syl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">phraseSylCount</span><span> </span><a href="#local-6989586621679112523"><span class="hs-identifier hs-var">phrase</span></a><span>
</span><a name="line-270"></a><span>            </span><a name="local-6989586621679112526"><a href="#local-6989586621679112526"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">phrasePenultLength</span><span> </span><a href="#local-6989586621679112523"><span class="hs-identifier hs-var">phrase</span></a><span>
</span><a name="line-271"></a><span>            </span><a name="local-6989586621679112527"><a href="#local-6989586621679112527"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;,pos:&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">phrasePosition</span><span> </span><a href="#local-6989586621679112523"><span class="hs-identifier hs-var">phrase</span></a><span class="hs-special">]</span><span>
</span><a name="line-272"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-273"></a><span>        </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679112524"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679112525"><span class="hs-identifier hs-var">syl</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679112526"><span class="hs-identifier hs-var">len</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679112527"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">]</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-comment">-- ** 'LyricSentence': Multiple phrases</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span class="hs-comment">-- | Each sentence includes the number of phrases therein</span><span>
</span><a name="line-278"></a><span class="hs-keyword">type</span><span> </span><a name="PhrasesInLyricSentence"><a href="Lectio.html#PhrasesInLyricSentence"><span class="hs-identifier">PhrasesInLyricSentence</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">-- | A list of totals of phrases in a section </span><span>
</span><a name="line-281"></a><span class="hs-keyword">type</span><span> </span><a name="PhrasesInLyricSection"><a href="Lectio.html#PhrasesInLyricSection"><span class="hs-identifier">PhrasesInLyricSection</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#PhrasesInLyricSentence"><span class="hs-identifier hs-type">PhrasesInLyricSentence</span></a><span class="hs-special">]</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-comment">-- | A 'LyricSentence' is just a list of 'LyricPhrase' items.</span><span>
</span><a name="line-284"></a><span class="hs-keyword">data</span><span> </span><a name="LyricSentence"><a href="Lectio.html#LyricSentence"><span class="hs-identifier">LyricSentence</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LyricSentence"><a href="Lectio.html#LyricSentence"><span class="hs-identifier">LyricSentence</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-285"></a><span>    </span><a name="phrases"><a href="Lectio.html#phrases"><span class="hs-identifier">phrases</span></a></a><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#LyricPhrase"><span class="hs-identifier hs-type">LyricPhrase</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-286"></a><span>    </span><a name="sentenceLength"><a href="Lectio.html#sentenceLength"><span class="hs-identifier">sentenceLength</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Lectio.html#PhrasesInLyricSentence"><span class="hs-identifier hs-type">PhrasesInLyricSentence</span></a><span> </span><span class="hs-comment">-- ^ number of phrases</span><span>
</span><a name="line-287"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>
</span><a name="line-289"></a><span class="hs-comment">-- ** 'LyricSection': Multiple sentences with parameters for text-setting</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-comment">-- | A 'LyricSection' includes a list of 'LyricSentence's and an 'ArkConfig'.</span><span>
</span><a name="line-292"></a><span class="hs-comment">--</span><span>
</span><a name="line-293"></a><span class="hs-comment">-- Including an 'ArkConfig' structure makes it possible to structure the input</span><span>
</span><a name="line-294"></a><span class="hs-comment">-- text and program the ark to change meters or modes for different sections. </span><span>
</span><a name="line-295"></a><span class="hs-keyword">data</span><span> </span><a name="LyricSection"><a href="Lectio.html#LyricSection"><span class="hs-identifier">LyricSection</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LyricSection"><a href="Lectio.html#LyricSection"><span class="hs-identifier">LyricSection</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-296"></a><span>    </span><a name="sectionConfig"><a href="Lectio.html#sectionConfig"><span class="hs-identifier">sectionConfig</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#ArkConfig"><span class="hs-identifier hs-type">ArkConfig</span></a><span class="hs-special">,</span><span>
</span><a name="line-297"></a><span>    </span><a name="sentences"><a href="Lectio.html#sentences"><span class="hs-identifier">sentences</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#LyricSentence"><span class="hs-identifier hs-type">LyricSentence</span></a><span class="hs-special">]</span><span>
</span><a name="line-298"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-comment">-- *** Get phrase lengths for prepared text</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-comment">-- | Get the number of phrases per sentence for a whole section.</span><span>
</span><a name="line-303"></a><span class="hs-identifier">sectionPhraseLengths</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lectio.html#LyricSection"><span class="hs-identifier hs-type">LyricSection</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#PhrasesInLyricSection"><span class="hs-identifier hs-type">PhrasesInLyricSection</span></a><span>
</span><a name="line-304"></a><a name="sectionPhraseLengths"><a href="Lectio.html#sectionPhraseLengths"><span class="hs-identifier">sectionPhraseLengths</span></a></a><span> </span><a name="local-6989586621679113667"><a href="#local-6989586621679113667"><span class="hs-identifier">section</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679113668"><a href="#local-6989586621679113668"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">sentenceLength</span><span> </span><a href="#local-6989586621679113668"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">sentences</span><span> </span><a href="#local-6989586621679113667"><span class="hs-identifier hs-var">section</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-comment">-- | Get the phrase lengths for the whole input structure</span><span>
</span><a name="line-307"></a><span class="hs-identifier">inputPhraseLengths</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#LyricSection"><span class="hs-identifier hs-type">LyricSection</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#PhrasesInLyricSection"><span class="hs-identifier hs-type">PhrasesInLyricSection</span></a><span class="hs-special">]</span><span>
</span><a name="line-308"></a><a name="inputPhraseLengths"><a href="Lectio.html#inputPhraseLengths"><span class="hs-identifier">inputPhraseLengths</span></a></a><span> </span><a name="local-6989586621679113669"><a href="#local-6989586621679113669"><span class="hs-identifier">sections</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679113670"><a href="#local-6989586621679113670"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#sectionPhraseLengths"><span class="hs-identifier hs-var">sectionPhraseLengths</span></a><span> </span><a href="#local-6989586621679113670"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113669"><span class="hs-identifier hs-var">sections</span></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-comment">-- ** Methods to read and store textual data into the above structures</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-comment">-- | Make a 'LyricSentence' from a list of 'LyricPhrase's.</span><span>
</span><a name="line-314"></a><span class="hs-identifier">newLyricSentence</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#LyricPhrase"><span class="hs-identifier hs-type">LyricPhrase</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#LyricSentence"><span class="hs-identifier hs-type">LyricSentence</span></a><span>
</span><a name="line-315"></a><a name="newLyricSentence"><a href="Lectio.html#newLyricSentence"><span class="hs-identifier">newLyricSentence</span></a></a><span> </span><a name="local-6989586621679113671"><a href="#local-6989586621679113671"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#LyricSentence"><span class="hs-identifier hs-var">LyricSentence</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-316"></a><span>    </span><span class="hs-identifier">phrases</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679113672"><a href="#local-6989586621679113672"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><a name="local-6989586621679113673"><a href="#local-6989586621679113673"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#LyricPhrase"><span class="hs-identifier hs-var">LyricPhrase</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-317"></a><span>        </span><span class="hs-identifier">phraseText</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">phraseText</span><span> </span><a href="#local-6989586621679113672"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span>
</span><a name="line-318"></a><span>        </span><span class="hs-identifier">phraseSylCount</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">phraseSylCount</span><span> </span><a href="#local-6989586621679113672"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span>
</span><a name="line-319"></a><span>        </span><span class="hs-identifier">phrasePenultLength</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">phrasePenultLength</span><span> </span><a href="#local-6989586621679113672"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span>
</span><a name="line-320"></a><span>        </span><span class="hs-identifier">phrasePosition</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113673"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-321"></a><span>    </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679113671"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-322"></a><span>    </span><span class="hs-identifier">sentenceLength</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679113671"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-323"></a><span class="hs-special">}</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-comment">-- | Take a simple list of 'Verbum' items and make a 'LyricPhrase' structure from</span><span>
</span><a name="line-326"></a><span class="hs-comment">-- it: the original list is stored as 'phraseText', and the 'phraseSylCount'</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- and 'phrasePenultLength' are calculated from that list.</span><span>
</span><a name="line-328"></a><span class="hs-comment">-- The 'phraseSylCount' is the sum of all the 'sylCount's of the words in the</span><span>
</span><a name="line-329"></a><span class="hs-comment">-- list. The 'phrasePenultLength' is the 'penultLength' of the last list item.</span><span>
</span><a name="line-330"></a><span class="hs-identifier">newLyricPhrase</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#Verbum"><span class="hs-identifier hs-type">Verbum</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#LyricPhrase"><span class="hs-identifier hs-type">LyricPhrase</span></a><span>
</span><a name="line-331"></a><a name="newLyricPhrase"><a href="Lectio.html#newLyricPhrase"><span class="hs-identifier">newLyricPhrase</span></a></a><span> </span><a name="local-6989586621679113674"><a href="#local-6989586621679113674"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#LyricPhrase"><span class="hs-identifier hs-var">LyricPhrase</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-332"></a><span>    </span><span class="hs-identifier">phraseText</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113674"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span>
</span><a name="line-333"></a><span>    </span><span class="hs-identifier">phraseSylCount</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">sylCount</span><span> </span><a href="#local-6989586621679113674"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span>
</span><a name="line-334"></a><span>    </span><span class="hs-identifier">phrasePenultLength</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">penultLength</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679113674"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span>
</span><a name="line-335"></a><span>    </span><span class="hs-identifier">phrasePosition</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-336"></a><span class="hs-special">}</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">-- | Take a 'String' and create a 'Verbum' structure:</span><span>
</span><a name="line-339"></a><span class="hs-comment">--</span><span>
</span><a name="line-340"></a><span class="hs-comment">--  - strip the text of diacritics by removing 'hyphenChar' and 'accentChar' characters</span><span>
</span><a name="line-341"></a><span class="hs-comment">--  - extract syllables by stripping accents and splitting at hyphens</span><span>
</span><a name="line-342"></a><span class="hs-comment">--  - get syllable count from list created in previous step</span><span>
</span><a name="line-343"></a><span class="hs-comment">--  - get penultimate syllable length from list of syllables /including/</span><span>
</span><a name="line-344"></a><span class="hs-comment">--  accents, using 'penultValue'</span><span>
</span><a name="line-345"></a><span class="hs-identifier">newVerbum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#Verbum"><span class="hs-identifier hs-type">Verbum</span></a><span>
</span><a name="line-346"></a><a name="newVerbum"><a href="Lectio.html#newVerbum"><span class="hs-identifier">newVerbum</span></a></a><span> </span><a name="local-6989586621679113675"><a href="#local-6989586621679113675"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#Verbum"><span class="hs-identifier hs-var">Verbum</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-347"></a><span>    </span><span class="hs-identifier">verbumText</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113676"><span class="hs-identifier hs-var">plaintext</span></a><span class="hs-special">,</span><span>
</span><a name="line-348"></a><span>    </span><span class="hs-identifier">verbumSyl</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679113679"><span class="hs-identifier hs-var">plainSyllables</span></a><span class="hs-special">,</span><span>
</span><a name="line-349"></a><span>    </span><span class="hs-identifier">sylCount</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679113679"><span class="hs-identifier hs-var">plainSyllables</span></a><span class="hs-special">,</span><span>
</span><a name="line-350"></a><span>    </span><span class="hs-identifier">penultLength</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#penultValue"><span class="hs-identifier hs-var">penultValue</span></a><span> </span><a href="#local-6989586621679113678"><span class="hs-identifier hs-var">accentSyllables</span></a><span>
</span><a name="line-351"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-352"></a><span>    </span><a name="local-6989586621679113676"><a href="#local-6989586621679113676"><span class="hs-identifier">plaintext</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">notElem</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#hyphenChar"><span class="hs-identifier hs-var">hyphenChar</span></a><span class="hs-special">,</span><span> </span><a href="Lectio.html#accentChar"><span class="hs-identifier hs-var">accentChar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113675"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-comment">-- no accents or hyphens</span><span>
</span><a name="line-353"></a><span>    </span><a name="local-6989586621679113677"><a href="#local-6989586621679113677"><span class="hs-identifier">noAccents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><a href="Lectio.html#accentChar"><span class="hs-identifier hs-var">accentChar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113675"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-354"></a><span>    </span><a name="local-6989586621679113678"><a href="#local-6989586621679113678"><span class="hs-identifier">accentSyllables</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">wordsBy</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="Lectio.html#hyphenChar"><span class="hs-identifier hs-var">hyphenChar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113675"><span class="hs-identifier hs-var">s</span></a><span>          </span><span class="hs-comment">-- list of syllables including accents</span><span>
</span><a name="line-355"></a><span>    </span><a name="local-6989586621679113679"><a href="#local-6989586621679113679"><span class="hs-identifier">plainSyllables</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">wordsBy</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="Lectio.html#hyphenChar"><span class="hs-identifier hs-var">hyphenChar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113677"><span class="hs-identifier hs-var">noAccents</span></a><span>  </span><span class="hs-comment">-- list of syllables without accents</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-comment">-- *** Helper methods for parsing</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-comment">-- | Determine the length of the next-to-last in a list of strings.</span><span>
</span><a name="line-360"></a><span class="hs-comment">-- If the list length is 1 or shorter, or if there is no 'accentChar' at the</span><span>
</span><a name="line-361"></a><span class="hs-comment">-- beginning of the penultimate syllable (found using 'penult'), then the</span><span>
</span><a name="line-362"></a><span class="hs-comment">-- result is 'Short'; otherwise 'Long'.</span><span>
</span><a name="line-363"></a><span class="hs-identifier">penultValue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#SylLen"><span class="hs-identifier hs-type">SylLen</span></a><span>
</span><a name="line-364"></a><a name="penultValue"><a href="Lectio.html#penultValue"><span class="hs-identifier">penultValue</span></a></a><span> </span><a name="local-6989586621679114078"><a href="#local-6989586621679114078"><span class="hs-identifier">text</span></a></a><span>
</span><a name="line-365"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679114078"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#Short"><span class="hs-identifier hs-var">Short</span></a><span>
</span><a name="line-366"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679114079"><span class="hs-identifier hs-var">penultWord</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Lectio.html#accentChar"><span class="hs-identifier hs-var">accentChar</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#Short"><span class="hs-identifier hs-var">Short</span></a><span>
</span><a name="line-367"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Aedifico.html#Long"><span class="hs-identifier hs-var">Long</span></a><span>
</span><a name="line-368"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679114079"><a href="#local-6989586621679114079"><span class="hs-identifier">penultWord</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lectio.html#penult"><span class="hs-identifier hs-var">penult</span></a><span> </span><a href="#local-6989586621679114078"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-comment">-- | Return the next-to-last item in a list.</span><span>
</span><a name="line-371"></a><span class="hs-identifier">penult</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679112528"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679112528"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-372"></a><a name="penult"><a href="Lectio.html#penult"><span class="hs-identifier">penult</span></a></a><span> </span><a name="local-6989586621679114080"><a href="#local-6989586621679114080"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679114080"><span class="hs-identifier hs-var">ls</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-373"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679114080"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">-- ** Grouping prose</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">-- | Regroup a phrase int groups of words with total syllable count in each</span><span>
</span><a name="line-378"></a><span class="hs-comment">-- group not to exceed a given maximum.</span><span>
</span><a name="line-379"></a><span class="hs-comment">--</span><span>
</span><a name="line-380"></a><span class="hs-comment">-- __TODO__: Replace with more sophisticated algorithm:</span><span>
</span><a name="line-381"></a><span class="hs-comment">--      - what to do if word is longer than maxSyllables? (break it into</span><span>
</span><a name="line-382"></a><span class="hs-comment">--      parts?)</span><span>
</span><a name="line-383"></a><span class="hs-comment">--      - optimize this for best grouping, not just most convenient in-order</span><span>
</span><a name="line-384"></a><span class="hs-comment">--</span><span>
</span><a name="line-385"></a><span class="hs-identifier">rephrase</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>     </span><span class="hs-comment">-- ^ maximum syllable count per group</span><span>
</span><a name="line-386"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#LyricPhrase"><span class="hs-identifier hs-type">LyricPhrase</span></a><span>   </span><span class="hs-comment">-- ^ text already parsed into a 'LyricPhrase'</span><span>
</span><a name="line-387"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#LyricPhrase"><span class="hs-identifier hs-type">LyricPhrase</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ old phrase broken into list of phrases</span><span>
</span><a name="line-388"></a><a name="rephrase"><a href="Lectio.html#rephrase"><span class="hs-identifier">rephrase</span></a></a><span> </span><a name="local-6989586621679114081"><a href="#local-6989586621679114081"><span class="hs-identifier">max</span></a></a><span> </span><a name="local-6989586621679114082"><a href="#local-6989586621679114082"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Lectio.html#newLyricPhrase"><span class="hs-identifier hs-var">newLyricPhrase</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679114083"><span class="hs-identifier hs-var">innerRephrase</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">phraseText</span><span> </span><a href="#local-6989586621679114082"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-389"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-390"></a><span>        </span><span class="hs-identifier">innerRephrase</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#Verbum"><span class="hs-identifier hs-type">Verbum</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#Verbum"><span class="hs-identifier hs-type">Verbum</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Lectio.html#Verbum"><span class="hs-identifier hs-type">Verbum</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-391"></a><span>        </span><a name="local-6989586621679114083"><a href="#local-6989586621679114083"><span class="hs-identifier">innerRephrase</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679114084"><a href="#local-6989586621679114084"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679114084"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">]</span><span>
</span><a name="line-392"></a><span>        </span><span class="hs-identifier">innerRephrase</span><span> </span><a name="local-6989586621679114085"><a href="#local-6989586621679114085"><span class="hs-identifier">old</span></a></a><span> </span><a name="local-6989586621679114086"><a href="#local-6989586621679114086"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-393"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679114087"><a href="#local-6989586621679114087"><span class="hs-identifier">next</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679114085"><span class="hs-identifier hs-var">old</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679114086"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-394"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">sylCount</span><span> </span><a href="#local-6989586621679114087"><span class="hs-identifier hs-var">next</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679114081"><span class="hs-identifier hs-var">max</span></a><span>
</span><a name="line-395"></a><span>                </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679114083"><span class="hs-identifier hs-var">innerRephrase</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679114085"><span class="hs-identifier hs-var">old</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679114087"><span class="hs-identifier hs-var">next</span></a><span>
</span><a name="line-396"></a><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679114086"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a href="#local-6989586621679114083"><span class="hs-identifier hs-var">innerRephrase</span></a><span> </span><a href="#local-6989586621679114085"><span class="hs-identifier hs-var">old</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-397"></a><span>
</span><a name="line-398"></a><span class="hs-comment">-- * Read the whole text </span><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span class="hs-comment">-- | Prepare the entire input structure</span><span>
</span><a name="line-401"></a><span class="hs-identifier">prepareInput</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lectio.html#ArkInput"><span class="hs-identifier hs-type">ArkInput</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#LyricSection"><span class="hs-identifier hs-type">LyricSection</span></a><span class="hs-special">]</span><span>
</span><a name="line-402"></a><a name="prepareInput"><a href="Lectio.html#prepareInput"><span class="hs-identifier">prepareInput</span></a></a><span> </span><a name="local-6989586621679114088"><a href="#local-6989586621679114088"><span class="hs-identifier">input</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679114101"><a href="#local-6989586621679114101"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679114089"><span class="hs-identifier hs-var">prepareLyricSection</span></a><span> </span><a href="#local-6989586621679114101"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">arkTextSections</span><span> </span><a href="#local-6989586621679114088"><span class="hs-identifier hs-var">input</span></a><span>
</span><a name="line-403"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-404"></a><span>        </span><span class="hs-comment">-- | Prepare the text of a whole input section</span><span>
</span><a name="line-405"></a><span>        </span><span class="hs-identifier">prepareLyricSection</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lectio.html#ArkTextSection"><span class="hs-identifier hs-type">ArkTextSection</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#LyricSection"><span class="hs-identifier hs-type">LyricSection</span></a><span>
</span><a name="line-406"></a><span>        </span><a name="local-6989586621679114089"><a href="#local-6989586621679114089"><span class="hs-identifier">prepareLyricSection</span></a></a><span> </span><a name="local-6989586621679114092"><a href="#local-6989586621679114092"><span class="hs-identifier">sec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#LyricSection"><span class="hs-identifier hs-var">LyricSection</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-407"></a><span>            </span><span class="hs-identifier">sectionConfig</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679114094"><span class="hs-identifier hs-var">config</span></a><span class="hs-special">,</span><span>
</span><a name="line-408"></a><span>            </span><span class="hs-identifier">sentences</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679114090"><span class="hs-identifier hs-var">prepareText</span></a><span> </span><a href="#local-6989586621679114095"><span class="hs-identifier hs-var">meter</span></a><span> </span><a href="#local-6989586621679114093"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-409"></a><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-410"></a><span>            </span><a name="local-6989586621679114093"><a href="#local-6989586621679114093"><span class="hs-identifier">text</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkText</span><span> </span><a href="#local-6989586621679114092"><span class="hs-identifier hs-var">sec</span></a><span>
</span><a name="line-411"></a><span>            </span><a name="local-6989586621679114094"><a href="#local-6989586621679114094"><span class="hs-identifier">config</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkConfig</span><span> </span><a href="#local-6989586621679114092"><span class="hs-identifier hs-var">sec</span></a><span>
</span><a name="line-412"></a><span>            </span><a name="local-6989586621679114095"><a href="#local-6989586621679114095"><span class="hs-identifier">meter</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arkTextMeter</span><span> </span><a href="#local-6989586621679114094"><span class="hs-identifier hs-var">config</span></a><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span>        </span><span class="hs-comment">-- | For each string in a list of list of strings: Prepare the string</span><span>
</span><a name="line-416"></a><span>        </span><span class="hs-comment">-- by converting to a 'LyricSentence' with 'ArkConfig' settings:</span><span>
</span><a name="line-417"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-418"></a><span>        </span><span class="hs-comment">-- Read and parse the string into a 'LyricSentence' of 'LyricPhrase'</span><span>
</span><a name="line-419"></a><span>        </span><span class="hs-comment">-- elements, each made up of 'Verbum' elements: First 'parse' the</span><span>
</span><a name="line-420"></a><span>        </span><span class="hs-comment">-- text, then 'rephrase' it for 'maxSyllables'.</span><span>
</span><a name="line-421"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-422"></a><span>        </span><span class="hs-comment">-- | Each @\&lt;lg\&gt;@ element becomes a 'LyricSentence' and @\&lt;l\&gt;@ element</span><span>
</span><a name="line-423"></a><span>        </span><span class="hs-comment">-- becomes a 'LyricPhrase'.</span><span>
</span><a name="line-424"></a><span>        </span><span class="hs-identifier">prepareText</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Aedifico.html#TextMeter"><span class="hs-identifier hs-type">TextMeter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Lectio.html#LyricSentence"><span class="hs-identifier hs-type">LyricSentence</span></a><span class="hs-special">]</span><span>
</span><a name="line-425"></a><span>        </span><a name="local-6989586621679114090"><a href="#local-6989586621679114090"><span class="hs-identifier">prepareText</span></a></a><span> </span><a name="local-6989586621679114096"><a href="#local-6989586621679114096"><span class="hs-identifier">meter</span></a></a><span> </span><a name="local-6989586621679114097"><a href="#local-6989586621679114097"><span class="hs-identifier">text</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-426"></a><span>            </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679114098"><a href="#local-6989586621679114098"><span class="hs-identifier">lg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#newLyricSentence"><span class="hs-identifier hs-var">newLyricSentence</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-427"></a><span>                </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679114099"><a href="#local-6989586621679114099"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#rephrase"><span class="hs-identifier hs-var">rephrase</span></a><span> </span><span class="hs-special">(</span><a href="Aedifico.html#maxSyllables"><span class="hs-identifier hs-var">maxSyllables</span></a><span> </span><a href="#local-6989586621679114096"><span class="hs-identifier hs-var">meter</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679114091"><span class="hs-identifier hs-var">parse</span></a><span> </span><a href="#local-6989586621679114099"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679114098"><span class="hs-identifier hs-var">lg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679114097"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-428"></a><span>
</span><a name="line-429"></a><span>        </span><span class="hs-comment">-- | Read a string and analyze it into a list of 'Verbum' objects containing</span><span>
</span><a name="line-430"></a><span>        </span><span class="hs-comment">-- needed information for text setting (syllable count, penult length), using</span><span>
</span><a name="line-431"></a><span>        </span><span class="hs-comment">-- 'newLyricPhrase'</span><span>
</span><a name="line-432"></a><span>        </span><span class="hs-identifier">parse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lectio.html#LyricPhrase"><span class="hs-identifier hs-type">LyricPhrase</span></a><span>
</span><a name="line-433"></a><span>        </span><a name="local-6989586621679114091"><a href="#local-6989586621679114091"><span class="hs-identifier">parse</span></a></a><span> </span><a name="local-6989586621679114100"><a href="#local-6989586621679114100"><span class="hs-identifier">text</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lectio.html#newLyricPhrase"><span class="hs-identifier hs-var">newLyricPhrase</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Lectio.html#newVerbum"><span class="hs-identifier hs-var">newVerbum</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">words</span><span> </span><a href="#local-6989586621679114100"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a></pre></body></html>